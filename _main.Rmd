---
title: "西山ほか(2019)『計量経済学』有斐閣の練習問題解答とRでの再現"
author: "石井 俊輔"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib]
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  This is a minimal example of using the bookdown package to write a book.
  The HTML output format for this example is bookdown::gitbook,
  set in the _output.yml file.
link-citations: yes
github-repo: rstudio/bookdown-demo
---

# はじめに {.unnumbered}

西山ほか(2019)『計量経済学』有斐閣 ([出版社リンク](https://www.yuhikaku.co.jp/books/detail/9784641053854)) の練習問題解答とRでの再現です.
必要なRパッケージをインストール:
```{r collapse=T}
install.packages("tidyverse")
install.packages("openxlsx")
```


## Usage

Each **bookdown** chapter is an .Rmd file, and each .Rmd file can contain one (and only one) chapter. A chapter *must* start with a first-level heading: `# A good chapter`, and can contain one (and only one) first-level heading.

Use second-level and higher headings within chapters like: `## A short section` or `### An even shorter section`.

The `index.Rmd` file is required, and is also your first book chapter. It will be the homepage when you render the book.

## Render book

You can render the HTML version of this example book without changing anything:

1.  Find the **Build** pane in the RStudio IDE, and

2.  Click on **Build Book**, then select your output format, or select "All formats" if you'd like to use multiple formats from the same book source files.

Or build the book from the R console:

```{r, eval=FALSE}
bookdown::render_book()
```

To render this example to PDF as a `bookdown::pdf_book`, you'll need to install XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): <https://yihui.org/tinytex/>.

## Preview book

As you work, you may start a local server to live preview this HTML book. This preview will update as you edit the book when you save individual .Rmd files. You can start the server in a work session by using the RStudio add-in "Preview book", or from the R console:

```{r eval=FALSE}
bookdown::serve_book()
```

```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```

<!--chapter:end:index.Rmd-->

# 第2章 データの整理と確率変数の基礎 {-#ch2}
先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.
```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support02.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support02.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support02.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

必要なライブラリを読み込む.
```{r collapse=T}
library(tidyverse)
```

## 練習問題 2-1 [確認] {-}

## 練習問題 2-2 [確認] {-}

## 練習問題 2-3 [確認] {-}

## 練習問題 2-4 [確認] {-}

## 練習問題 2-5 [確認] {-}

## 練習問題 2-6 [確認] {-}

## 練習問題 2-7 [発展] {-}

## 練習問題 2-8 [発展] {-}

## 練習問題 2-9 [発展] {-}

## 練習問題 2-10 [発展] {-}

## 練習問題 2-11 [確認] {-}

## 練習問題 2-12 [発展] {-}

## 練習問題 2-13 [確認] {-}

## 練習問題 2-14 [確認] {-}

<!--chapter:end:02.Rmd-->

# 第3章 統計理論の基礎 {-#ch3}
第3章では第2章と同じデータを使うため、新たなダウンロードは不要.
なお[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)にある第3章のファイルは, 誤ったデータが格納されている.

必要なライブラリを読み込む.
```{r collapse=T}
library(tidyverse)
```
## 練習問題 3-1 [確認] {-}

## 練習問題 3-2 [確認] {-}

## 練習問題 3-3 [確認] {-}

## 練習問題 3-4 [発展] {-}

<!--chapter:end:03.Rmd-->

# 第4章 線形単回帰モデルの推定と検定 {-#ch4}
先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.
```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support04.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support04.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support04.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

必要なライブラリを読み込む.
```{r collapse=T}
library(tidyverse)
library(openxlsx) # Excelファイルを読み取るためのパッケージ
```
## 練習問題 4-1 [確認] {-}

## 練習問題 4-2 [実証] {-}

## 練習問題 4-3 [確認] {-}

## 練習問題 4-4 [確認] {-}

## 練習問題 4-5 [確認] {-}

## 練習問題 4-6 [確認] {-}

## 練習問題 4-7 [確認] {-}

## 練習問題 4-8 [発展] {-}

## 練習問題 4-9 [発展] {-}

## 練習問題 4-10 [実証] {-}

<!--chapter:end:04.Rmd-->

# 第5章 重回帰モデルの推定と検定 {#ch5 .unnumbered}

先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.

```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support05.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support05.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support05.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

必要なライブラリを読み込む.

```{r collapse=T}
library(tidyverse)
```

## 練習問題 5-1 [確認] {.unnumbered}

## 練習問題 5-2 [確認] {.unnumbered}

## 練習問題 5-3 [確認] {.unnumbered}

## 練習問題 5-4 [確認] {.unnumbered}

## 練習問題 5-5 [確認] {.unnumbered}

## 練習問題 5-6 [確認] {.unnumbered}

## 練習問題 5-7 [確認] {.unnumbered}

## 練習問題 5-8 [確認] {.unnumbered}

## 練習問題 5-9 [確認] {.unnumbered}

## 練習問題 5-10 [発展] {.unnumbered}

## 練習問題 5-11 [発展] {.unnumbered}

## 練習問題 5-12 [発展] {.unnumbered}

## 練習問題 5-13 [\*発展] {.unnumbered}

## 練習問題 5-14 [実証] {.unnumbered}

## 練習問題 5-15 [実証] {.unnumbered}

<!--chapter:end:05.Rmd-->

# 第6章 パネルデータ分析 {-#ch6}
先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.
```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support06.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support06.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support06.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

## 練習問題 6-1 [確認] {-}

## 練習問題 6-2 [確認] {-}

## 練習問題 6-3 [確認] {-}

## 練習問題 6-4 [確認] {-}

## 練習問題 6-5 [確認] {-}

## 練習問題 6-6 [確認] {-}

## 練習問題 6-7 [確認] {-}

## 練習問題 6-8 [発展] {-}

## 練習問題 6-9 [発展] {-}

## 練習問題 6-10 [実証] {-}

## 練習問題 6-11 [実証] {-}

<!--chapter:end:06.Rmd-->

# 第7章 操作変数法 {-#ch7}
先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.
```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support07.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support07.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support07.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

## 練習問題 7-1 [確認] {-}

## 練習問題 7-2 [確認] {-}

## 練習問題 7-3 [確認] {-}

## 練習問題 7-4 [確認] {-}

## 練習問題 7-5 [確認] {-}

## 練習問題 7-6 [確認] {-}

## 練習問題 7-7 [確認] {-}

## 練習問題 7-8 [確認] {-}

## 練習問題 7-9 [確認] {-}

## 練習問題 7-10 [確認] {-}

## 練習問題 7-11 [発展] {-}

## 練習問題 7-12 [発展] {-}

## 練習問題 7-13 [実証] {-}

<!--chapter:end:07.Rmd-->

# 第8章 制限従属変数モデル {-#ch8}
先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.
```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support08.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support08.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support08.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

## 練習問題 8-1 [確認] {-}

## 練習問題 8-2 [確認] {-}

## 練習問題 8-3 [発展] {-}

## 練習問題 8-4 [実証] {-}

<!--chapter:end:08.Rmd-->

# 第9章 政策評価モデル {-#ch9}
先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.
```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support09.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support09.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support09.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

## 練習問題 9-1 [確認] {-}

## 練習問題 9-2 [確認] {-}

## 練習問題 9-3 [発展] {-}

## 練習問題 9-4 [発展] {-}

## 練習問題 9-5 [実証] {-}

<!--chapter:end:09.Rmd-->

# 第10章 系列相関と時系列モデル {-#ch10}
先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.
```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support10.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support10.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support10.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

## 練習問題 10-1 [確認] {-}

## 練習問題 10-2 [確認] {-}

## 練習問題 10-3 [確認] {-}

## 練習問題 10-4 [確認] {-}

## 練習問題 10-5 [確認] {-}

## 練習問題 10-6 [確認] {-}

## 練習問題 10-7 [発展] {-}

## 練習問題 10-8 [発展] {-}

## 練習問題 10-9 [実証] {-}

## 練習問題 10-10 [実証] {-}

<!--chapter:end:10.Rmd-->

# 第11章 トレンドと構造変化 {-#ch11}
先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.
```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support11.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support11.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support11.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

## 練習問題 11-1 [確認] {-}

## 練習問題 11-2 [確認] {-}

## 練習問題 11-3 [確認] {-}

## 練習問題 11-4 [確認] {-}

## 練習問題 11-5 [確認] {-}

## 練習問題 11-6 [発展] {-}

## 練習問題 11-7 [発展] {-}

## 練習問題 11-8 [実証] {-}

## 練習問題 11-9 [実証] {-}

<!--chapter:end:11.Rmd-->

# 第12章 VARモデル {#ch12 .unnumbered}

先に[出版社サイト](https://www.yuhikaku.co.jp/books/detail/9784641053854)よりデータをダウンロードする.

```{r collapse=T}
# サポートファイルへのリンク
curl <- "https://www.yuhikaku.co.jp/static_files/05385_support12.zip"
# ダウンロード保存用フォルダが存在しない場合, 作成
if(!dir.exists("downloads")){
    dir.create("downloads")
}
cdestfile <- "downloads/support12.zip"
download.file(curl, cdestfile)
# データ保存用フォルダが存在しない場合, 作成
if(!dir.exists("data")){
    dir.create("data")
}
# WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し
# Windowsの場合は別途コマンドを用いる.
if(.Platform$OS.type == "unix") {
    system(sprintf('unzip -Ocp932 %s -d %s', "downloads/support12.zip", "./data"))
} else {
    print("Windowsで解凍するコマンドを別途追加せよ.")
}
```

## 練習問題 12-1 [確認] {.unnumbered}

## 練習問題 12-2 [確認] {.unnumbered}

## 練習問題 12-3 [確認] {.unnumbered}

## 練習問題 12-4 [発展] {.unnumbered}

## 練習問題 12-5 [実証] {.unnumbered}

## 練習問題 12-6 [実証] {.unnumbered}

<!--chapter:end:12.Rmd-->

