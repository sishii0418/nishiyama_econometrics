<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第5章 重回帰モデルの推定と検定 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現</title>
  <meta name="description" content="第5章 重回帰モデルの推定と検定 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="第5章 重回帰モデルの推定と検定 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="第5章 重回帰モデルの推定と検定 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第5章 重回帰モデルの推定と検定 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現" />
  
  <meta name="twitter:description" content="第5章 重回帰モデルの推定と検定 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現." />
  

<meta name="author" content="石井 俊輔" />


<meta name="date" content="2025-01-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch4.html"/>
<link rel="next" href="ch6.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8R0S76ZD8E"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8R0S76ZD8E');
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
    Macros: {
      P: "{\\text{P}}",
      E: "{\\text{E}}",
      Var: "{\\text{Var}}",
      Cov: "{\\text{Cov}}",
      sumN: ["{\\sum_{#1=0}^N}", 1]
    }
  }
});
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">西山ほか(2019)『計量経済学』有斐閣の練習問題解答とRでの再現</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#方針"><i class="fa fa-check"></i>方針</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#似たようなサイト"><i class="fa fa-check"></i>似たようなサイト</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html"><i class="fa fa-check"></i>第2章 データの整理と確率変数の基礎</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-1-確認"><i class="fa fa-check"></i>練習問題 2-1 [確認]</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-2-確認"><i class="fa fa-check"></i>練習問題 2-2 [確認]</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-3-確認"><i class="fa fa-check"></i>練習問題 2-3 [確認]</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-4-確認"><i class="fa fa-check"></i>練習問題 2-4 [確認]</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-5-確認"><i class="fa fa-check"></i>練習問題 2-5 [確認]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html"><i class="fa fa-check"></i>第3章 統計理論の基礎</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#練習問題-3-2-確認"><i class="fa fa-check"></i>練習問題 3-2 [確認]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html"><i class="fa fa-check"></i>第4章 線形単回帰モデルの推定と検定</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#実証例4.1-労働生産性と実質賃金の関係"><i class="fa fa-check"></i>実証例4.1 労働生産性と実質賃金の関係</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#図4-1-時間当たり実質賃金と労働生産性"><i class="fa fa-check"></i>図4-1 時間当たり実質賃金と労働生産性</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#練習問題-4-2-実証"><i class="fa fa-check"></i>練習問題 4-2 [実証]</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#練習問題-4-10-実証"><i class="fa fa-check"></i>練習問題 4-10 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html"><i class="fa fa-check"></i>第5章 重回帰モデルの推定と検定</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#単回帰-5.1-5.2"><i class="fa fa-check"></i>単回帰 (5.1), (5.2)</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#ex5.1"><i class="fa fa-check"></i>実証例5.1 信頼と規範が経済成長に与える影響の重回帰分析</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.2-fwl定理の確認"><i class="fa fa-check"></i>実証例5.2 FWL定理の確認</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.3-fwl定理の別表現の確認"><i class="fa fa-check"></i>実証例5.3 FWL定理の別表現の確認</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.4-信頼と規範が経済成長に与える影響の重回帰分析の標準誤差"><i class="fa fa-check"></i>実証例5.4 信頼と規範が経済成長に与える影響の重回帰分析の標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#ex5.5"><i class="fa fa-check"></i>実証例5.5 信頼と規範が経済成長に与える影響の多項式モデル</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#図5-1-散布図と推定された回帰曲線"><i class="fa fa-check"></i>図5-1 散布図と推定された回帰曲線</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#例題5.5"><i class="fa fa-check"></i>例題5.5</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.6-都市化の度合いと初期時点gdpの交互作用"><i class="fa fa-check"></i>実証例5.6 都市化の度合いと初期時点GDPの交互作用</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.7-都市化の度合いと初期時点gdpのダミー変数同士の交互作用"><i class="fa fa-check"></i>実証例5.7 都市化の度合いと初期時点GDPのダミー変数同士の交互作用</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.8-非線形モデルにおける結合仮説の検定"><i class="fa fa-check"></i>実証例5.8 非線形モデルにおける結合仮説の検定</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.9-ポンフェローニ検定"><i class="fa fa-check"></i>実証例5.9 ポンフェローニ検定</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#table5-5"><i class="fa fa-check"></i>表5-5 記述統計量</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#table5-6"><i class="fa fa-check"></i>表5-6 推定結果: 被説明変数は経済成長率</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#表5-7-推定結果"><i class="fa fa-check"></i>表5-7 推定結果</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#練習問題-5-14-実証"><i class="fa fa-check"></i>練習問題 5-14 [実証]</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#練習問題-5-15-実証"><i class="fa fa-check"></i>練習問題 5-15 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i>第6章 パネルデータ分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#exp6.1"><i class="fa fa-check"></i>(6.1) 式</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#ex6.1"><i class="fa fa-check"></i>実証例6.1 保育所が母親の就業に与え影響の固定効果推定</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.2-保育所が母親の就業に与える影響の固定効果推定の標準誤差"><i class="fa fa-check"></i>実証例6.2 保育所が母親の就業に与える影響の固定効果推定の標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.3-保育所が母親の就業に与え影響のプールされたols推定の標準誤差"><i class="fa fa-check"></i>実証例6.3 保育所が母親の就業に与え影響のプールされたOLS推定の標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.4-保育所が母親の就業に与える影響の時間効果を入れた分析"><i class="fa fa-check"></i>実証例6.4 保育所が母親の就業に与える影響の時間効果を入れた分析</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.5-保育所が母親の就業に与える影響の都道府県効果と年効果を入れた分析"><i class="fa fa-check"></i>実証例6.5 保育所が母親の就業に与える影響の都道府県効果と年効果を入れた分析</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.6-保育所が母親の就業に与える影響の個別トレンドと年効果を入れた分析"><i class="fa fa-check"></i>実証例6.6 保育所が母親の就業に与える影響の個別トレンドと年効果を入れた分析</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#table6-3"><i class="fa fa-check"></i>表6-3 記述統計量</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#表6-4-年ごとの記述統計量"><i class="fa fa-check"></i>表6-4 年ごとの記述統計量</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#table6-5"><i class="fa fa-check"></i>表6-5 推定結果</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#練習問題-6-10-実証"><i class="fa fa-check"></i>練習問題 6-10 [実証]</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#練習問題-6-11-実証"><i class="fa fa-check"></i>練習問題 6-11 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html"><i class="fa fa-check"></i>第7章 操作変数法</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#ex7.1"><i class="fa fa-check"></i>実証例7.1 単回帰モデルの操作変数推定</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#実証例7.2-操作変数推定量の標準誤差"><i class="fa fa-check"></i>実証例7.2 操作変数推定量の標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#実証例7.3-19世紀プロイセンのデータの外生性を含めた2sls推定による分析"><i class="fa fa-check"></i>実証例7.3 19世紀プロイセンのデータの外生性を含めた2SLS推定による分析</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#実証例7.4-操作変数の強さの判定"><i class="fa fa-check"></i>実証例7.4 操作変数の強さの判定</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#実証例7.5-操作変数の外生性の検定"><i class="fa fa-check"></i>実証例7.5 操作変数の外生性の検定</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#表7-2-記述統計量"><i class="fa fa-check"></i>表7-2 記述統計量</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#table7-3"><i class="fa fa-check"></i>表7-3 推定結果</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#練習問題-7-13-実証"><i class="fa fa-check"></i>練習問題 7-13 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html"><i class="fa fa-check"></i>第8章 制限従属変数モデル</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#実証例8.1-piaacを用いた女性の就業選択の実証例"><i class="fa fa-check"></i>実証例8.1 PIAACを用いた女性の就業選択の実証例</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#table8-1"><i class="fa fa-check"></i>表8-1 女性の就業決定</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#実証例8.2-piaacを用いた仕事満足度の決定要因の分析"><i class="fa fa-check"></i>実証例8.2 PIAACを用いた仕事満足度の決定要因の分析</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#実証例8.3-piaacを用いた就業形態決定要因の分析"><i class="fa fa-check"></i>実証例8.3 PIAACを用いた就業形態決定要因の分析</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#実証例8.4-piaacを用いた女性の労働時間決定の分析"><i class="fa fa-check"></i>実証例8.4 PIAACを用いた女性の労働時間決定の分析</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#ex8.5"><i class="fa fa-check"></i>実証例8.5 PIAACを用いた女性賃金の決定要因の分析</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#練習問題-8-4-実証"><i class="fa fa-check"></i>練習問題 8-4 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch9.html"><a href="ch9.html"><i class="fa fa-check"></i>第9章 政策評価モデル</a>
<ul>
<li class="chapter" data-level="" data-path="ch9.html"><a href="ch9.html#figure9-5"><i class="fa fa-check"></i>図9-5 電子投票制度の導入が有効票率に与えた影響</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html"><i class="fa fa-check"></i>第10章 系列相関と時系列モデル</a>
<ul>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#figure10-1"><i class="fa fa-check"></i>図10-1 名目GDP</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-2-gdpデフレーター"><i class="fa fa-check"></i>図10-2 GDPデフレーター</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-3-名目系列と実質系列"><i class="fa fa-check"></i>図10-3 名目系列と実質系列</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-4-原系列と対数系列"><i class="fa fa-check"></i>図10-4 原系列と対数系列</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-5-gdpギャップ-年次データ"><i class="fa fa-check"></i>図10-5 GDPギャップ (年次データ)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-6-実質gdp成長率"><i class="fa fa-check"></i>図10-6 実質GDP成長率</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-7-実質gdp-公表季調値"><i class="fa fa-check"></i>図10-7 実質GDP (公表季調値)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-8-季調済みgdpデフレーターのインフレ率"><i class="fa fa-check"></i>図10-8 季調済みGDPデフレーターのインフレ率</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-9-消費者物価指数の-対数季節階差-インフレ率"><i class="fa fa-check"></i>図10-9 消費者物価指数の (対数季節階差) インフレ率</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-10-完全失業率-移動平均"><i class="fa fa-check"></i>図10-10 完全失業率 (移動平均)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#figure10-11"><i class="fa fa-check"></i>図10-11 実験系列</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#figure10-12"><i class="fa fa-check"></i>図10-12 GDPギャップ (四半期データ)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#exp10.12"><i class="fa fa-check"></i>(10.12) 式</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#式"><i class="fa fa-check"></i>(10.13) 式</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-14-gdpギャップのコレログラム"><i class="fa fa-check"></i>図10-14 GDPギャップのコレログラム</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#ex10.1"><i class="fa fa-check"></i>実証例10.1 GDPギャップの系列相関</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#実証例10.2-ホワイトノイズの系列相関"><i class="fa fa-check"></i>実証例10.2 ホワイトノイズの系列相関</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-15-実験系列-ホワイトノイズ-のコレログラム"><i class="fa fa-check"></i>図10-15 実験系列 (ホワイトノイズ) のコレログラム</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#実証例10.3-フィリップス曲線の誤差項の系列相関"><i class="fa fa-check"></i>実証例10.3 フィリップス曲線の誤差項の系列相関</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#ex10.4"><i class="fa fa-check"></i>実証例10.4 フィリップス曲線のHAC標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#実証例10.5-gdpギャップのarモデルのラグ選択"><i class="fa fa-check"></i>実証例10.5 GDPギャップのARモデルのラグ選択</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#実証例10.6-ラグ付きインフレ率を含むフィリップス曲線の推定と誤差項の系列相関の検定"><i class="fa fa-check"></i>実証例10.6 ラグ付きインフレ率を含むフィリップス曲線の推定と誤差項の系列相関の検定</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-16-東証株価指数-対数階差収益率"><i class="fa fa-check"></i>図10-16 東証株価指数 (対数階差収益率)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#ex10.7"><i class="fa fa-check"></i>実証例10.7 ARCHモデルとGARCHモデルの推定</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#練習問題-10-10-実証"><i class="fa fa-check"></i>練習問題 10-10 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html"><i class="fa fa-check"></i>第11章 トレンドと構造変化</a></li>
<li class="chapter" data-level="" data-path="ch12.html"><a href="ch12.html"><i class="fa fa-check"></i>第12章 VARモデル</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch5" class="section level1 unnumbered hasAnchor">
<h1>第5章 重回帰モデルの推定と検定<a href="ch5.html#ch5" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>先に<a href="https://www.yuhikaku.co.jp/books/detail/9784641053854">出版社サイト</a>よりデータをダウンロードする.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="ch5.html#cb23-1" tabindex="-1"></a><span class="co"># サポートファイルへのリンク</span></span>
<span id="cb23-2"><a href="ch5.html#cb23-2" tabindex="-1"></a>curl <span class="ot">&lt;-</span> <span class="st">&quot;https://www.yuhikaku.co.jp/static_files/05385_support05.zip&quot;</span></span>
<span id="cb23-3"><a href="ch5.html#cb23-3" tabindex="-1"></a><span class="co"># ダウンロード保存用フォルダが存在しない場合, 作成</span></span>
<span id="cb23-4"><a href="ch5.html#cb23-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;downloads&quot;</span>)){</span>
<span id="cb23-5"><a href="ch5.html#cb23-5" tabindex="-1"></a>    <span class="fu">dir.create</span>(<span class="st">&quot;downloads&quot;</span>)</span>
<span id="cb23-6"><a href="ch5.html#cb23-6" tabindex="-1"></a>}</span>
<span id="cb23-7"><a href="ch5.html#cb23-7" tabindex="-1"></a>cdestfile <span class="ot">&lt;-</span> <span class="st">&quot;downloads/support05.zip&quot;</span></span>
<span id="cb23-8"><a href="ch5.html#cb23-8" tabindex="-1"></a><span class="fu">download.file</span>(curl, cdestfile)</span>
<span id="cb23-9"><a href="ch5.html#cb23-9" tabindex="-1"></a><span class="co"># データ保存用フォルダが存在しない場合, 作成</span></span>
<span id="cb23-10"><a href="ch5.html#cb23-10" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;data&quot;</span>)){</span>
<span id="cb23-11"><a href="ch5.html#cb23-11" tabindex="-1"></a>    <span class="fu">dir.create</span>(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb23-12"><a href="ch5.html#cb23-12" tabindex="-1"></a>}</span>
<span id="cb23-13"><a href="ch5.html#cb23-13" tabindex="-1"></a><span class="co"># WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し</span></span>
<span id="cb23-14"><a href="ch5.html#cb23-14" tabindex="-1"></a><span class="co"># Windowsの場合は別途コマンドを用いる.</span></span>
<span id="cb23-15"><a href="ch5.html#cb23-15" tabindex="-1"></a><span class="cf">if</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">&quot;unix&quot;</span>) {</span>
<span id="cb23-16"><a href="ch5.html#cb23-16" tabindex="-1"></a>    <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&#39;unzip -n -Ocp932 %s -d %s&#39;</span>, <span class="st">&quot;downloads/support05.zip&quot;</span>, <span class="st">&quot;./data&quot;</span>))</span>
<span id="cb23-17"><a href="ch5.html#cb23-17" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb23-18"><a href="ch5.html#cb23-18" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Windowsで解凍するコマンドを別途追加せよ.&quot;</span>)</span>
<span id="cb23-19"><a href="ch5.html#cb23-19" tabindex="-1"></a>}</span></code></pre></div>
<p>必要なライブラリを読み込む.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="ch5.html#cb24-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-2"><a href="ch5.html#cb24-2" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb24-3"><a href="ch5.html#cb24-3" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb24-4"><a href="ch5.html#cb24-4" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb24-5"><a href="ch5.html#cb24-5" tabindex="-1"></a><span class="do">## `modelsummary` 2.0.0 now uses `tinytable` as its default table-drawing</span></span>
<span id="cb24-6"><a href="ch5.html#cb24-6" tabindex="-1"></a><span class="do">##   backend. Learn more at: https://vincentarelbundock.github.io/tinytable/</span></span>
<span id="cb24-7"><a href="ch5.html#cb24-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-8"><a href="ch5.html#cb24-8" tabindex="-1"></a><span class="do">## Revert to `kableExtra` for one session:</span></span>
<span id="cb24-9"><a href="ch5.html#cb24-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-10"><a href="ch5.html#cb24-10" tabindex="-1"></a><span class="do">##   options(modelsummary_factory_default = &#39;kableExtra&#39;)</span></span>
<span id="cb24-11"><a href="ch5.html#cb24-11" tabindex="-1"></a><span class="do">##   options(modelsummary_factory_latex = &#39;kableExtra&#39;)</span></span>
<span id="cb24-12"><a href="ch5.html#cb24-12" tabindex="-1"></a><span class="do">##   options(modelsummary_factory_html = &#39;kableExtra&#39;)</span></span>
<span id="cb24-13"><a href="ch5.html#cb24-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-14"><a href="ch5.html#cb24-14" tabindex="-1"></a><span class="do">## Silence this message forever:</span></span>
<span id="cb24-15"><a href="ch5.html#cb24-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-16"><a href="ch5.html#cb24-16" tabindex="-1"></a><span class="do">##   config_modelsummary(startup_message = FALSE)</span></span>
<span id="cb24-17"><a href="ch5.html#cb24-17" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb24-18"><a href="ch5.html#cb24-18" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb24-19"><a href="ch5.html#cb24-19" tabindex="-1"></a><span class="do">## Loading required package: carData</span></span>
<span id="cb24-20"><a href="ch5.html#cb24-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-21"><a href="ch5.html#cb24-21" tabindex="-1"></a><span class="do">## Attaching package: &#39;car&#39;</span></span>
<span id="cb24-22"><a href="ch5.html#cb24-22" tabindex="-1"></a><span class="do">## The following object is masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb24-23"><a href="ch5.html#cb24-23" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-24"><a href="ch5.html#cb24-24" tabindex="-1"></a><span class="do">##     recode</span></span>
<span id="cb24-25"><a href="ch5.html#cb24-25" tabindex="-1"></a><span class="do">## The following object is masked from &#39;package:purrr&#39;:</span></span>
<span id="cb24-26"><a href="ch5.html#cb24-26" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb24-27"><a href="ch5.html#cb24-27" tabindex="-1"></a><span class="do">##     some</span></span>
<span id="cb24-28"><a href="ch5.html#cb24-28" tabindex="-1"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb24-29"><a href="ch5.html#cb24-29" tabindex="-1"></a><span class="fu">library</span>(haven)</span></code></pre></div>
<div id="単回帰-5.1-5.2" class="section level2 unnumbered hasAnchor">
<h2>単回帰 (5.1), (5.2)<a href="ch5.html#単回帰-5.1-5.2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>先にデータを読み込み, 変数を作成する.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="ch5.html#cb25-1" tabindex="-1"></a>youdou <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/05_第5章/youdou.csv&quot;</span>)</span>
<span id="cb25-2"><a href="ch5.html#cb25-2" tabindex="-1"></a>youdou <span class="ot">&lt;-</span> youdou <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="ch5.html#cb25-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lny80 =</span> <span class="fu">log</span>(y80)) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="ch5.html#cb25-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lny99 =</span> <span class="fu">log</span>(y99)) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="ch5.html#cb25-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lny90 =</span> <span class="fu">log</span>(y90)) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="ch5.html#cb25-6" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">growthrate8099 =</span> (lny99<span class="sc">-</span>lny80)<span class="sc">/</span><span class="dv">19</span><span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="ch5.html#cb25-7" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">growthrate8090 =</span> (lny90<span class="sc">-</span>lny80)<span class="sc">/</span><span class="dv">10</span>)</span></code></pre></div>
<p>不均一分散に頑健な標準誤差を求めるために, <code>estimatr::lm_robust()</code>を使う.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="ch5.html#cb26-1" tabindex="-1"></a>youdou_51 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> trust80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb26-2"><a href="ch5.html#cb26-2" tabindex="-1"></a><span class="fu">summary</span>(youdou_51)</span>
<span id="cb26-3"><a href="ch5.html#cb26-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-4"><a href="ch5.html#cb26-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb26-5"><a href="ch5.html#cb26-5" tabindex="-1"></a><span class="do">## lm_robust(formula = growthrate8099 ~ trust80, data = youdou, </span></span>
<span id="cb26-6"><a href="ch5.html#cb26-6" tabindex="-1"></a><span class="do">##     se_type = &quot;stata&quot;)</span></span>
<span id="cb26-7"><a href="ch5.html#cb26-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-8"><a href="ch5.html#cb26-8" tabindex="-1"></a><span class="do">## Standard error type:  HC1 </span></span>
<span id="cb26-9"><a href="ch5.html#cb26-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-10"><a href="ch5.html#cb26-10" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb26-11"><a href="ch5.html#cb26-11" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF</span></span>
<span id="cb26-12"><a href="ch5.html#cb26-12" tabindex="-1"></a><span class="do">## (Intercept)   3.1394    0.06044  51.943 8.188e-42  3.01763   3.2611 45</span></span>
<span id="cb26-13"><a href="ch5.html#cb26-13" tabindex="-1"></a><span class="do">## trust80       0.2247    0.06640   3.384 1.491e-03  0.09094   0.3584 45</span></span>
<span id="cb26-14"><a href="ch5.html#cb26-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-15"><a href="ch5.html#cb26-15" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.179 , Adjusted R-squared:  0.1608 </span></span>
<span id="cb26-16"><a href="ch5.html#cb26-16" tabindex="-1"></a><span class="do">## F-statistic: 11.45 on 1 and 45 DF,  p-value: 0.001491</span></span>
<span id="cb26-17"><a href="ch5.html#cb26-17" tabindex="-1"></a>youdou_52 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> norm80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb26-18"><a href="ch5.html#cb26-18" tabindex="-1"></a><span class="fu">summary</span>(youdou_52)</span>
<span id="cb26-19"><a href="ch5.html#cb26-19" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-20"><a href="ch5.html#cb26-20" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb26-21"><a href="ch5.html#cb26-21" tabindex="-1"></a><span class="do">## lm_robust(formula = growthrate8099 ~ norm80, data = youdou, se_type = &quot;stata&quot;)</span></span>
<span id="cb26-22"><a href="ch5.html#cb26-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-23"><a href="ch5.html#cb26-23" tabindex="-1"></a><span class="do">## Standard error type:  HC1 </span></span>
<span id="cb26-24"><a href="ch5.html#cb26-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-25"><a href="ch5.html#cb26-25" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb26-26"><a href="ch5.html#cb26-26" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF</span></span>
<span id="cb26-27"><a href="ch5.html#cb26-27" tabindex="-1"></a><span class="do">## (Intercept)   3.0905    0.04826  64.033 7.544e-46   2.9933   3.1878 45</span></span>
<span id="cb26-28"><a href="ch5.html#cb26-28" tabindex="-1"></a><span class="do">## norm80        0.5597    0.07058   7.931 4.348e-10   0.4176   0.7019 45</span></span>
<span id="cb26-29"><a href="ch5.html#cb26-29" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-30"><a href="ch5.html#cb26-30" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.4563 ,    Adjusted R-squared:  0.4442 </span></span>
<span id="cb26-31"><a href="ch5.html#cb26-31" tabindex="-1"></a><span class="do">## F-statistic:  62.9 on 1 and 45 DF,  p-value: 4.348e-10</span></span></code></pre></div>
</div>
<div id="ex5.1" class="section level2 unnumbered hasAnchor">
<h2>実証例5.1 信頼と規範が経済成長に与える影響の重回帰分析<a href="ch5.html#ex5.1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="ch5.html#cb27-1" tabindex="-1"></a>youdou_55 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> trust80 <span class="sc">+</span> education80 <span class="sc">+</span> lny80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb27-2"><a href="ch5.html#cb27-2" tabindex="-1"></a><span class="fu">summary</span>(youdou_55)</span>
<span id="cb27-3"><a href="ch5.html#cb27-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-4"><a href="ch5.html#cb27-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb27-5"><a href="ch5.html#cb27-5" tabindex="-1"></a><span class="do">## lm_robust(formula = growthrate8099 ~ trust80 + education80 + </span></span>
<span id="cb27-6"><a href="ch5.html#cb27-6" tabindex="-1"></a><span class="do">##     lny80, data = youdou, se_type = &quot;stata&quot;)</span></span>
<span id="cb27-7"><a href="ch5.html#cb27-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-8"><a href="ch5.html#cb27-8" tabindex="-1"></a><span class="do">## Standard error type:  HC1 </span></span>
<span id="cb27-9"><a href="ch5.html#cb27-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-10"><a href="ch5.html#cb27-10" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb27-11"><a href="ch5.html#cb27-11" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF</span></span>
<span id="cb27-12"><a href="ch5.html#cb27-12" tabindex="-1"></a><span class="do">## (Intercept)  6.04885    0.42643 14.1849 8.041e-18    5.189   6.9088 43</span></span>
<span id="cb27-13"><a href="ch5.html#cb27-13" tabindex="-1"></a><span class="do">## trust80      0.02058    0.07564  0.2721 7.868e-01   -0.132   0.1731 43</span></span>
<span id="cb27-14"><a href="ch5.html#cb27-14" tabindex="-1"></a><span class="do">## education80  2.61208    2.70857  0.9644 3.403e-01   -2.850   8.0744 43</span></span>
<span id="cb27-15"><a href="ch5.html#cb27-15" tabindex="-1"></a><span class="do">## lny80       -2.38309    0.49147 -4.8489 1.658e-05   -3.374  -1.3920 43</span></span>
<span id="cb27-16"><a href="ch5.html#cb27-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-17"><a href="ch5.html#cb27-17" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.5619 ,    Adjusted R-squared:  0.5313 </span></span>
<span id="cb27-18"><a href="ch5.html#cb27-18" tabindex="-1"></a><span class="do">## F-statistic: 20.21 on 3 and 43 DF,  p-value: 2.531e-08</span></span>
<span id="cb27-19"><a href="ch5.html#cb27-19" tabindex="-1"></a>youdou_55_2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> norm80 <span class="sc">+</span> education80 <span class="sc">+</span> lny80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb27-20"><a href="ch5.html#cb27-20" tabindex="-1"></a><span class="fu">summary</span>(youdou_55_2)</span>
<span id="cb27-21"><a href="ch5.html#cb27-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-22"><a href="ch5.html#cb27-22" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb27-23"><a href="ch5.html#cb27-23" tabindex="-1"></a><span class="do">## lm_robust(formula = growthrate8099 ~ norm80 + education80 + lny80, </span></span>
<span id="cb27-24"><a href="ch5.html#cb27-24" tabindex="-1"></a><span class="do">##     data = youdou, se_type = &quot;stata&quot;)</span></span>
<span id="cb27-25"><a href="ch5.html#cb27-25" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-26"><a href="ch5.html#cb27-26" tabindex="-1"></a><span class="do">## Standard error type:  HC1 </span></span>
<span id="cb27-27"><a href="ch5.html#cb27-27" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-28"><a href="ch5.html#cb27-28" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb27-29"><a href="ch5.html#cb27-29" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF</span></span>
<span id="cb27-30"><a href="ch5.html#cb27-30" tabindex="-1"></a><span class="do">## (Intercept)   5.2909     0.6682   7.918 6.204e-10  3.94324   6.6385 43</span></span>
<span id="cb27-31"><a href="ch5.html#cb27-31" tabindex="-1"></a><span class="do">## norm80        0.3383     0.1370   2.469 1.758e-02  0.06202   0.6145 43</span></span>
<span id="cb27-32"><a href="ch5.html#cb27-32" tabindex="-1"></a><span class="do">## education80   4.3872     1.9611   2.237 3.051e-02  0.43233   8.3421 43</span></span>
<span id="cb27-33"><a href="ch5.html#cb27-33" tabindex="-1"></a><span class="do">## lny80        -1.9911     0.5746  -3.465 1.213e-03 -3.14987  -0.8324 43</span></span>
<span id="cb27-34"><a href="ch5.html#cb27-34" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-35"><a href="ch5.html#cb27-35" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6391 ,    Adjusted R-squared:  0.614 </span></span>
<span id="cb27-36"><a href="ch5.html#cb27-36" tabindex="-1"></a><span class="do">## F-statistic: 41.04 on 3 and 43 DF,  p-value: 1.11e-12</span></span></code></pre></div>
</div>
<div id="実証例5.2-fwl定理の確認" class="section level2 unnumbered hasAnchor">
<h2>実証例5.2 FWL定理の確認<a href="ch5.html#実証例5.2-fwl定理の確認" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>定数項なしの回帰を実行するには, <code>formula</code>に<code>+0</code>か<code>-1</code>を追加する(<a href="https://indenkun.hatenablog.com/entry/2020/02/29/013000">参考</a>). なお, <code>estimatr::lm_robust()</code>には<code>lm</code>のように<code>residuals</code>がないため, 必要ならば手動で追加する(<a href="https://stackoverflow.com/questions/74577781/extract-residuals-from-heteroskedasticity-robust-standard-model-lm-robust">参考</a>). ただしこの例では標準偏差は必要でないため, <code>lm</code>を用いた.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="ch5.html#cb28-1" tabindex="-1"></a>fwl_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(trust80 <span class="sc">~</span> education80 <span class="sc">+</span> lny80, <span class="at">data =</span> youdou)</span>
<span id="cb28-2"><a href="ch5.html#cb28-2" tabindex="-1"></a><span class="fu">summary</span>(fwl_1)</span>
<span id="cb28-3"><a href="ch5.html#cb28-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-4"><a href="ch5.html#cb28-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb28-5"><a href="ch5.html#cb28-5" tabindex="-1"></a><span class="do">## lm(formula = trust80 ~ education80 + lny80, data = youdou)</span></span>
<span id="cb28-6"><a href="ch5.html#cb28-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-7"><a href="ch5.html#cb28-7" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb28-8"><a href="ch5.html#cb28-8" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb28-9"><a href="ch5.html#cb28-9" tabindex="-1"></a><span class="do">## -1.18774 -0.48567 -0.02193  0.56490  1.41091 </span></span>
<span id="cb28-10"><a href="ch5.html#cb28-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-11"><a href="ch5.html#cb28-11" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb28-12"><a href="ch5.html#cb28-12" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb28-13"><a href="ch5.html#cb28-13" tabindex="-1"></a><span class="do">## (Intercept)   2.6740     0.9493   2.817  0.00723 **</span></span>
<span id="cb28-14"><a href="ch5.html#cb28-14" tabindex="-1"></a><span class="do">## education80 -11.2886     4.5080  -2.504  0.01606 * </span></span>
<span id="cb28-15"><a href="ch5.html#cb28-15" tabindex="-1"></a><span class="do">## lny80        -1.0254     0.9692  -1.058  0.29584   </span></span>
<span id="cb28-16"><a href="ch5.html#cb28-16" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb28-17"><a href="ch5.html#cb28-17" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-18"><a href="ch5.html#cb28-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-19"><a href="ch5.html#cb28-19" tabindex="-1"></a><span class="do">## Residual standard error: 0.6555 on 44 degrees of freedom</span></span>
<span id="cb28-20"><a href="ch5.html#cb28-20" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.4246, Adjusted R-squared:  0.3985 </span></span>
<span id="cb28-21"><a href="ch5.html#cb28-21" tabindex="-1"></a><span class="do">## F-statistic: 16.24 on 2 and 44 DF,  p-value: 5.233e-06</span></span>
<span id="cb28-22"><a href="ch5.html#cb28-22" tabindex="-1"></a>fwl_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growthrate8099 <span class="sc">~</span> education80 <span class="sc">+</span> lny80, <span class="at">data =</span> youdou)</span>
<span id="cb28-23"><a href="ch5.html#cb28-23" tabindex="-1"></a><span class="fu">summary</span>(fwl_2)</span>
<span id="cb28-24"><a href="ch5.html#cb28-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-25"><a href="ch5.html#cb28-25" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb28-26"><a href="ch5.html#cb28-26" tabindex="-1"></a><span class="do">## lm(formula = growthrate8099 ~ education80 + lny80, data = youdou)</span></span>
<span id="cb28-27"><a href="ch5.html#cb28-27" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-28"><a href="ch5.html#cb28-28" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb28-29"><a href="ch5.html#cb28-29" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb28-30"><a href="ch5.html#cb28-30" tabindex="-1"></a><span class="do">## -0.46861 -0.23426  0.00308  0.13266  1.01937 </span></span>
<span id="cb28-31"><a href="ch5.html#cb28-31" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-32"><a href="ch5.html#cb28-32" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb28-33"><a href="ch5.html#cb28-33" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb28-34"><a href="ch5.html#cb28-34" tabindex="-1"></a><span class="do">## (Intercept)   6.1039     0.4403  13.863  &lt; 2e-16 ***</span></span>
<span id="cb28-35"><a href="ch5.html#cb28-35" tabindex="-1"></a><span class="do">## education80   2.3797     2.0909   1.138    0.261    </span></span>
<span id="cb28-36"><a href="ch5.html#cb28-36" tabindex="-1"></a><span class="do">## lny80        -2.4042     0.4495  -5.348 3.03e-06 ***</span></span>
<span id="cb28-37"><a href="ch5.html#cb28-37" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb28-38"><a href="ch5.html#cb28-38" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-39"><a href="ch5.html#cb28-39" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-40"><a href="ch5.html#cb28-40" tabindex="-1"></a><span class="do">## Residual standard error: 0.304 on 44 degrees of freedom</span></span>
<span id="cb28-41"><a href="ch5.html#cb28-41" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.561,  Adjusted R-squared:  0.5411 </span></span>
<span id="cb28-42"><a href="ch5.html#cb28-42" tabindex="-1"></a><span class="do">## F-statistic: 28.12 on 2 and 44 DF,  p-value: 1.36e-08</span></span>
<span id="cb28-43"><a href="ch5.html#cb28-43" tabindex="-1"></a><span class="fu">lm</span>(fwl_2<span class="sc">$</span>residuals <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> fwl_1<span class="sc">$</span>residuals) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb28-44"><a href="ch5.html#cb28-44" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-45"><a href="ch5.html#cb28-45" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb28-46"><a href="ch5.html#cb28-46" tabindex="-1"></a><span class="do">## lm(formula = fwl_2$residuals ~ 0 + fwl_1$residuals)</span></span>
<span id="cb28-47"><a href="ch5.html#cb28-47" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-48"><a href="ch5.html#cb28-48" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb28-49"><a href="ch5.html#cb28-49" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb28-50"><a href="ch5.html#cb28-50" tabindex="-1"></a><span class="do">## -0.45839 -0.21925 -0.00947  0.13042  1.03231 </span></span>
<span id="cb28-51"><a href="ch5.html#cb28-51" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-52"><a href="ch5.html#cb28-52" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb28-53"><a href="ch5.html#cb28-53" tabindex="-1"></a><span class="do">##                 Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb28-54"><a href="ch5.html#cb28-54" tabindex="-1"></a><span class="do">## fwl_1$residuals  0.02058    0.06832   0.301    0.765</span></span>
<span id="cb28-55"><a href="ch5.html#cb28-55" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-56"><a href="ch5.html#cb28-56" tabindex="-1"></a><span class="do">## Residual standard error: 0.2971 on 46 degrees of freedom</span></span>
<span id="cb28-57"><a href="ch5.html#cb28-57" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.00197,    Adjusted R-squared:  -0.01973 </span></span>
<span id="cb28-58"><a href="ch5.html#cb28-58" tabindex="-1"></a><span class="do">## F-statistic: 0.09078 on 1 and 46 DF,  p-value: 0.7645</span></span></code></pre></div>
</div>
<div id="実証例5.3-fwl定理の別表現の確認" class="section level2 unnumbered hasAnchor">
<h2>実証例5.3 FWL定理の別表現の確認<a href="ch5.html#実証例5.3-fwl定理の別表現の確認" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="ch5.html#cb29-1" tabindex="-1"></a><span class="fu">lm</span>(growthrate8099 <span class="sc">~</span> fwl_1<span class="sc">$</span>residuals<span class="dv">-1</span>, <span class="at">data =</span> youdou) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb29-2"><a href="ch5.html#cb29-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-3"><a href="ch5.html#cb29-3" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb29-4"><a href="ch5.html#cb29-4" tabindex="-1"></a><span class="do">## lm(formula = growthrate8099 ~ fwl_1$residuals - 1, data = youdou)</span></span>
<span id="cb29-5"><a href="ch5.html#cb29-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-6"><a href="ch5.html#cb29-6" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb29-7"><a href="ch5.html#cb29-7" tabindex="-1"></a><span class="do">##    Min     1Q Median     3Q    Max </span></span>
<span id="cb29-8"><a href="ch5.html#cb29-8" tabindex="-1"></a><span class="do">##  2.189  2.816  3.086  3.546  3.915 </span></span>
<span id="cb29-9"><a href="ch5.html#cb29-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-10"><a href="ch5.html#cb29-10" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb29-11"><a href="ch5.html#cb29-11" tabindex="-1"></a><span class="do">##                 Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb29-12"><a href="ch5.html#cb29-12" tabindex="-1"></a><span class="do">## fwl_1$residuals  0.02058    0.73877   0.028    0.978</span></span>
<span id="cb29-13"><a href="ch5.html#cb29-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-14"><a href="ch5.html#cb29-14" tabindex="-1"></a><span class="do">## Residual standard error: 3.212 on 46 degrees of freedom</span></span>
<span id="cb29-15"><a href="ch5.html#cb29-15" tabindex="-1"></a><span class="do">## Multiple R-squared:  1.688e-05,  Adjusted R-squared:  -0.02172 </span></span>
<span id="cb29-16"><a href="ch5.html#cb29-16" tabindex="-1"></a><span class="do">## F-statistic: 0.0007764 on 1 and 46 DF,  p-value: 0.9779</span></span></code></pre></div>
</div>
<div id="実証例5.4-信頼と規範が経済成長に与える影響の重回帰分析の標準誤差" class="section level2 unnumbered hasAnchor">
<h2>実証例5.4 信頼と規範が経済成長に与える影響の重回帰分析の標準誤差<a href="ch5.html#実証例5.4-信頼と規範が経済成長に与える影響の重回帰分析の標準誤差" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="ch5.html#ex5.1">実証例5.1</a>を参照せよ.</p>
</div>
<div id="ex5.5" class="section level2 unnumbered hasAnchor">
<h2>実証例5.5 信頼と規範が経済成長に与える影響の多項式モデル<a href="ch5.html#ex5.5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="ch5.html#cb30-1" tabindex="-1"></a>youdou_515 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> y80 <span class="sc">+</span> <span class="fu">I</span>(y80<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb30-2"><a href="ch5.html#cb30-2" tabindex="-1"></a><span class="fu">summary</span>(youdou_515)</span>
<span id="cb30-3"><a href="ch5.html#cb30-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-4"><a href="ch5.html#cb30-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb30-5"><a href="ch5.html#cb30-5" tabindex="-1"></a><span class="do">## lm_robust(formula = growthrate8099 ~ y80 + I(y80^2), data = youdou, </span></span>
<span id="cb30-6"><a href="ch5.html#cb30-6" tabindex="-1"></a><span class="do">##     se_type = &quot;stata&quot;)</span></span>
<span id="cb30-7"><a href="ch5.html#cb30-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-8"><a href="ch5.html#cb30-8" tabindex="-1"></a><span class="do">## Standard error type:  HC1 </span></span>
<span id="cb30-9"><a href="ch5.html#cb30-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-10"><a href="ch5.html#cb30-10" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb30-11"><a href="ch5.html#cb30-11" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF</span></span>
<span id="cb30-12"><a href="ch5.html#cb30-12" tabindex="-1"></a><span class="do">## (Intercept)  6.51866    1.38538   4.705 2.535e-05  3.72662   9.3107 44</span></span>
<span id="cb30-13"><a href="ch5.html#cb30-13" tabindex="-1"></a><span class="do">## y80         -1.22615    0.70791  -1.732 9.027e-02 -2.65285   0.2005 44</span></span>
<span id="cb30-14"><a href="ch5.html#cb30-14" tabindex="-1"></a><span class="do">## I(y80^2)     0.08935    0.08861   1.008 3.188e-01 -0.08923   0.2679 44</span></span>
<span id="cb30-15"><a href="ch5.html#cb30-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-16"><a href="ch5.html#cb30-16" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.5503 ,    Adjusted R-squared:  0.5299 </span></span>
<span id="cb30-17"><a href="ch5.html#cb30-17" tabindex="-1"></a><span class="do">## F-statistic: 27.39 on 2 and 44 DF,  p-value: 1.879e-08</span></span></code></pre></div>
</div>
<div id="図5-1-散布図と推定された回帰曲線" class="section level2 unnumbered hasAnchor">
<h2>図5-1 散布図と推定された回帰曲線<a href="ch5.html#図5-1-散布図と推定された回帰曲線" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="ch5.html#cb31-1" tabindex="-1"></a>youdou <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="ch5.html#cb31-2" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y80, <span class="at">y =</span> growthrate8099)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="ch5.html#cb31-3" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="ch5.html#cb31-4" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;初期時点GDP&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="ch5.html#cb31-5" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;経済成長率&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="ch5.html#cb31-6" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="例題5.5" class="section level2 unnumbered hasAnchor">
<h2>例題5.5<a href="ch5.html#例題5.5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="ch5.html#cb32-1" tabindex="-1"></a><span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> lny80 <span class="sc">*</span> education80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb32-2"><a href="ch5.html#cb32-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-3"><a href="ch5.html#cb32-3" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb32-4"><a href="ch5.html#cb32-4" tabindex="-1"></a><span class="do">## lm_robust(formula = growthrate8099 ~ lny80 * education80, data = youdou, </span></span>
<span id="cb32-5"><a href="ch5.html#cb32-5" tabindex="-1"></a><span class="do">##     se_type = &quot;stata&quot;)</span></span>
<span id="cb32-6"><a href="ch5.html#cb32-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-7"><a href="ch5.html#cb32-7" tabindex="-1"></a><span class="do">## Standard error type:  HC1 </span></span>
<span id="cb32-8"><a href="ch5.html#cb32-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-9"><a href="ch5.html#cb32-9" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb32-10"><a href="ch5.html#cb32-10" tabindex="-1"></a><span class="do">##                   Estimate Std. Error  t value  Pr(&gt;|t|) CI Lower CI Upper DF</span></span>
<span id="cb32-11"><a href="ch5.html#cb32-11" tabindex="-1"></a><span class="do">## (Intercept)         6.0868     1.1220  5.42485 2.492e-06    3.824   8.3496 43</span></span>
<span id="cb32-12"><a href="ch5.html#cb32-12" tabindex="-1"></a><span class="do">## lny80              -2.3937     0.8477 -2.82364 7.167e-03   -4.103  -0.6841 43</span></span>
<span id="cb32-13"><a href="ch5.html#cb32-13" tabindex="-1"></a><span class="do">## education80         2.5735    11.0413  0.23308 8.168e-01  -19.693  24.8405 43</span></span>
<span id="cb32-14"><a href="ch5.html#cb32-14" tabindex="-1"></a><span class="do">## lny80:education80  -0.1211     7.1314 -0.01698 9.865e-01  -14.503  14.2608 43</span></span>
<span id="cb32-15"><a href="ch5.html#cb32-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-16"><a href="ch5.html#cb32-16" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.561 , Adjusted R-squared:  0.5304 </span></span>
<span id="cb32-17"><a href="ch5.html#cb32-17" tabindex="-1"></a><span class="do">## F-statistic: 18.45 on 3 and 43 DF,  p-value: 7.651e-08</span></span></code></pre></div>
</div>
<div id="実証例5.6-都市化の度合いと初期時点gdpの交互作用" class="section level2 unnumbered hasAnchor">
<h2>実証例5.6 都市化の度合いと初期時点GDPの交互作用<a href="ch5.html#実証例5.6-都市化の度合いと初期時点gdpの交互作用" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>先にダミー変数<code>urban</code>を作成してから回帰分析を実行する(下では<code>urban</code>の型は<code>int</code>ではなく<code>bool</code>になるが構わない). <code>urban</code>の値により標本を分ける場合は, <code>lm()</code>の<code>data</code>で<code>filter()</code>を使えばよい.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="ch5.html#cb33-1" tabindex="-1"></a>youdou <span class="ot">&lt;-</span> youdou <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="ch5.html#cb33-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">urban =</span> did <span class="sc">&gt;</span> <span class="fl">0.4</span>)</span>
<span id="cb33-3"><a href="ch5.html#cb33-3" tabindex="-1"></a><span class="fu">lm</span>(growthrate8099 <span class="sc">~</span> urban <span class="sc">*</span> lny80, <span class="at">data =</span> youdou) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb33-4"><a href="ch5.html#cb33-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-5"><a href="ch5.html#cb33-5" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb33-6"><a href="ch5.html#cb33-6" tabindex="-1"></a><span class="do">## lm(formula = growthrate8099 ~ urban * lny80, data = youdou)</span></span>
<span id="cb33-7"><a href="ch5.html#cb33-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-8"><a href="ch5.html#cb33-8" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb33-9"><a href="ch5.html#cb33-9" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb33-10"><a href="ch5.html#cb33-10" tabindex="-1"></a><span class="do">## -0.51040 -0.21003 -0.02406  0.16516  0.90189 </span></span>
<span id="cb33-11"><a href="ch5.html#cb33-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-12"><a href="ch5.html#cb33-12" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb33-13"><a href="ch5.html#cb33-13" tabindex="-1"></a><span class="do">##                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-14"><a href="ch5.html#cb33-14" tabindex="-1"></a><span class="do">## (Intercept)      5.74905    0.57763   9.953 9.96e-13 ***</span></span>
<span id="cb33-15"><a href="ch5.html#cb33-15" tabindex="-1"></a><span class="do">## urbanTRUE       -0.17551    0.82444  -0.213 0.832421    </span></span>
<span id="cb33-16"><a href="ch5.html#cb33-16" tabindex="-1"></a><span class="do">## lny80           -1.91120    0.45104  -4.237 0.000117 ***</span></span>
<span id="cb33-17"><a href="ch5.html#cb33-17" tabindex="-1"></a><span class="do">## urbanTRUE:lny80  0.06441    0.61108   0.105 0.916546    </span></span>
<span id="cb33-18"><a href="ch5.html#cb33-18" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb33-19"><a href="ch5.html#cb33-19" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-20"><a href="ch5.html#cb33-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-21"><a href="ch5.html#cb33-21" tabindex="-1"></a><span class="do">## Residual standard error: 0.3092 on 43 degrees of freedom</span></span>
<span id="cb33-22"><a href="ch5.html#cb33-22" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.5564, Adjusted R-squared:  0.5254 </span></span>
<span id="cb33-23"><a href="ch5.html#cb33-23" tabindex="-1"></a><span class="do">## F-statistic: 17.98 on 3 and 43 DF,  p-value: 1.041e-07</span></span>
<span id="cb33-24"><a href="ch5.html#cb33-24" tabindex="-1"></a><span class="fu">lm</span>(growthrate8099 <span class="sc">~</span> lny80, <span class="at">data =</span> (youdou <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>urban))) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb33-25"><a href="ch5.html#cb33-25" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-26"><a href="ch5.html#cb33-26" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb33-27"><a href="ch5.html#cb33-27" tabindex="-1"></a><span class="do">## lm(formula = growthrate8099 ~ lny80, data = (youdou %&gt;% filter(!urban)))</span></span>
<span id="cb33-28"><a href="ch5.html#cb33-28" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-29"><a href="ch5.html#cb33-29" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb33-30"><a href="ch5.html#cb33-30" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb33-31"><a href="ch5.html#cb33-31" tabindex="-1"></a><span class="do">## -0.51040 -0.22240 -0.02406  0.12827  0.90189 </span></span>
<span id="cb33-32"><a href="ch5.html#cb33-32" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-33"><a href="ch5.html#cb33-33" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb33-34"><a href="ch5.html#cb33-34" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-35"><a href="ch5.html#cb33-35" tabindex="-1"></a><span class="do">## (Intercept)   5.7491     0.6512   8.829 7.59e-09 ***</span></span>
<span id="cb33-36"><a href="ch5.html#cb33-36" tabindex="-1"></a><span class="do">## lny80        -1.9112     0.5085  -3.759  0.00102 ** </span></span>
<span id="cb33-37"><a href="ch5.html#cb33-37" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb33-38"><a href="ch5.html#cb33-38" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-39"><a href="ch5.html#cb33-39" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-40"><a href="ch5.html#cb33-40" tabindex="-1"></a><span class="do">## Residual standard error: 0.3486 on 23 degrees of freedom</span></span>
<span id="cb33-41"><a href="ch5.html#cb33-41" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.3805, Adjusted R-squared:  0.3536 </span></span>
<span id="cb33-42"><a href="ch5.html#cb33-42" tabindex="-1"></a><span class="do">## F-statistic: 14.13 on 1 and 23 DF,  p-value: 0.001022</span></span>
<span id="cb33-43"><a href="ch5.html#cb33-43" tabindex="-1"></a><span class="fu">lm</span>(growthrate8099 <span class="sc">~</span> lny80, <span class="at">data =</span> (youdou <span class="sc">%&gt;%</span> <span class="fu">filter</span>(urban))) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb33-44"><a href="ch5.html#cb33-44" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-45"><a href="ch5.html#cb33-45" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb33-46"><a href="ch5.html#cb33-46" tabindex="-1"></a><span class="do">## lm(formula = growthrate8099 ~ lny80, data = (youdou %&gt;% filter(urban)))</span></span>
<span id="cb33-47"><a href="ch5.html#cb33-47" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-48"><a href="ch5.html#cb33-48" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb33-49"><a href="ch5.html#cb33-49" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb33-50"><a href="ch5.html#cb33-50" tabindex="-1"></a><span class="do">## -0.35740 -0.19171 -0.05236  0.17634  0.49475 </span></span>
<span id="cb33-51"><a href="ch5.html#cb33-51" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-52"><a href="ch5.html#cb33-52" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb33-53"><a href="ch5.html#cb33-53" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb33-54"><a href="ch5.html#cb33-54" tabindex="-1"></a><span class="do">## (Intercept)   5.5735     0.4881  11.419 3.25e-10 ***</span></span>
<span id="cb33-55"><a href="ch5.html#cb33-55" tabindex="-1"></a><span class="do">## lny80        -1.8468     0.3421  -5.399 2.77e-05 ***</span></span>
<span id="cb33-56"><a href="ch5.html#cb33-56" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb33-57"><a href="ch5.html#cb33-57" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb33-58"><a href="ch5.html#cb33-58" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-59"><a href="ch5.html#cb33-59" tabindex="-1"></a><span class="do">## Residual standard error: 0.2565 on 20 degrees of freedom</span></span>
<span id="cb33-60"><a href="ch5.html#cb33-60" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.593,  Adjusted R-squared:  0.5727 </span></span>
<span id="cb33-61"><a href="ch5.html#cb33-61" tabindex="-1"></a><span class="do">## F-statistic: 29.14 on 1 and 20 DF,  p-value: 2.769e-05</span></span></code></pre></div>
</div>
<div id="実証例5.7-都市化の度合いと初期時点gdpのダミー変数同士の交互作用" class="section level2 unnumbered hasAnchor">
<h2>実証例5.7 都市化の度合いと初期時点GDPのダミー変数同士の交互作用<a href="ch5.html#実証例5.7-都市化の度合いと初期時点gdpのダミー変数同士の交互作用" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>やはり, 先にダミー変数<code>lny80d</code>を作成する.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="ch5.html#cb34-1" tabindex="-1"></a>youdou <span class="ot">&lt;-</span> youdou <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="ch5.html#cb34-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lny80d =</span> lny80 <span class="sc">&gt;</span> <span class="fl">1.4</span>)</span>
<span id="cb34-3"><a href="ch5.html#cb34-3" tabindex="-1"></a><span class="fu">lm</span>(growthrate8099 <span class="sc">~</span> urban <span class="sc">*</span> lny80d, <span class="at">data =</span> youdou) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb34-4"><a href="ch5.html#cb34-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-5"><a href="ch5.html#cb34-5" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb34-6"><a href="ch5.html#cb34-6" tabindex="-1"></a><span class="do">## lm(formula = growthrate8099 ~ urban * lny80d, data = youdou)</span></span>
<span id="cb34-7"><a href="ch5.html#cb34-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-8"><a href="ch5.html#cb34-8" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb34-9"><a href="ch5.html#cb34-9" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb34-10"><a href="ch5.html#cb34-10" tabindex="-1"></a><span class="do">## -0.50919 -0.25376 -0.01148  0.24475  0.85353 </span></span>
<span id="cb34-11"><a href="ch5.html#cb34-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-12"><a href="ch5.html#cb34-12" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb34-13"><a href="ch5.html#cb34-13" tabindex="-1"></a><span class="do">##                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb34-14"><a href="ch5.html#cb34-14" tabindex="-1"></a><span class="do">## (Intercept)           3.45474    0.07544  45.793  &lt; 2e-16 ***</span></span>
<span id="cb34-15"><a href="ch5.html#cb34-15" tabindex="-1"></a><span class="do">## urbanTRUE            -0.23329    0.12459  -1.872 0.067953 .  </span></span>
<span id="cb34-16"><a href="ch5.html#cb34-16" tabindex="-1"></a><span class="do">## lny80dTRUE           -0.58003    0.15400  -3.767 0.000498 ***</span></span>
<span id="cb34-17"><a href="ch5.html#cb34-17" tabindex="-1"></a><span class="do">## urbanTRUE:lny80dTRUE  0.04725    0.20827   0.227 0.821596    </span></span>
<span id="cb34-18"><a href="ch5.html#cb34-18" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb34-19"><a href="ch5.html#cb34-19" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb34-20"><a href="ch5.html#cb34-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb34-21"><a href="ch5.html#cb34-21" tabindex="-1"></a><span class="do">## Residual standard error: 0.3288 on 43 degrees of freedom</span></span>
<span id="cb34-22"><a href="ch5.html#cb34-22" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.4982, Adjusted R-squared:  0.4631 </span></span>
<span id="cb34-23"><a href="ch5.html#cb34-23" tabindex="-1"></a><span class="do">## F-statistic: 14.23 on 3 and 43 DF,  p-value: 1.401e-06</span></span></code></pre></div>
</div>
<div id="実証例5.8-非線形モデルにおける結合仮説の検定" class="section level2 unnumbered hasAnchor">
<h2>実証例5.8 非線形モデルにおける結合仮説の検定<a href="ch5.html#実証例5.8-非線形モデルにおける結合仮説の検定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="ch5.html#ex5.5">実証例5.5</a>を参照せよ.</p>
</div>
<div id="実証例5.9-ポンフェローニ検定" class="section level2 unnumbered hasAnchor">
<h2>実証例5.9 ポンフェローニ検定<a href="ch5.html#実証例5.9-ポンフェローニ検定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>式は<a href="ch5.html#ex5.1">実証例5.1</a>を参照せよ. 規範と教育水準の係数が両方とも0であるという帰無仮説を検定する. F検定統計値は<code>car::linearHypothesis()</code>を使うことで求められる.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="ch5.html#cb35-1" tabindex="-1"></a><span class="fu">linearHypothesis</span>(youdou_55_2, <span class="fu">c</span>(<span class="st">&quot;norm80&quot;</span>,<span class="st">&quot;education80&quot;</span>), <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb35-2"><a href="ch5.html#cb35-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb35-3"><a href="ch5.html#cb35-3" tabindex="-1"></a><span class="do">## Linear hypothesis test:</span></span>
<span id="cb35-4"><a href="ch5.html#cb35-4" tabindex="-1"></a><span class="do">## norm80 = 0</span></span>
<span id="cb35-5"><a href="ch5.html#cb35-5" tabindex="-1"></a><span class="do">## education80 = 0</span></span>
<span id="cb35-6"><a href="ch5.html#cb35-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb35-7"><a href="ch5.html#cb35-7" tabindex="-1"></a><span class="do">## Model 1: restricted model</span></span>
<span id="cb35-8"><a href="ch5.html#cb35-8" tabindex="-1"></a><span class="do">## Model 2: growthrate8099 ~ norm80 + education80 + lny80</span></span>
<span id="cb35-9"><a href="ch5.html#cb35-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb35-10"><a href="ch5.html#cb35-10" tabindex="-1"></a><span class="do">##   Res.Df Df      F   Pr(&gt;F)   </span></span>
<span id="cb35-11"><a href="ch5.html#cb35-11" tabindex="-1"></a><span class="do">## 1     45                      </span></span>
<span id="cb35-12"><a href="ch5.html#cb35-12" tabindex="-1"></a><span class="do">## 2     43  2 5.4375 0.007848 **</span></span>
<span id="cb35-13"><a href="ch5.html#cb35-13" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb35-14"><a href="ch5.html#cb35-14" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="table5-5" class="section level2 unnumbered hasAnchor">
<h2>表5-5 記述統計量<a href="ch5.html#table5-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>modelsummary::datasummary()</code>を使うことで簡単に記述統計表が作成できる. ここでは統計量と変数名の表示を日本語に直すため, 一旦dataframeで書き出し, 再度<code>gt</code>で修正した表を表示している.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="ch5.html#cb36-1" tabindex="-1"></a><span class="co"># 変数を選択</span></span>
<span id="cb36-2"><a href="ch5.html#cb36-2" tabindex="-1"></a>vars <span class="ot">&lt;-</span> youdou <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="ch5.html#cb36-3" tabindex="-1"></a>    <span class="fu">select</span>(growthrate8099, trust80, norm80, education80, lny80)</span>
<span id="cb36-4"><a href="ch5.html#cb36-4" tabindex="-1"></a>table55 <span class="ot">&lt;-</span> <span class="fu">datasummary</span>(<span class="fu">All</span>(vars) <span class="sc">~</span> N <span class="sc">+</span> Mean <span class="sc">+</span> SD <span class="sc">+</span> Min <span class="sc">+</span> Max,</span>
<span id="cb36-5"><a href="ch5.html#cb36-5" tabindex="-1"></a>            <span class="at">data =</span> youdou,</span>
<span id="cb36-6"><a href="ch5.html#cb36-6" tabindex="-1"></a>            <span class="at">output =</span> <span class="st">&quot;data.frame&quot;</span>,</span>
<span id="cb36-7"><a href="ch5.html#cb36-7" tabindex="-1"></a>            <span class="at">fmt =</span> <span class="dv">3</span>)</span>
<span id="cb36-8"><a href="ch5.html#cb36-8" tabindex="-1"></a><span class="co"># 列名</span></span>
<span id="cb36-9"><a href="ch5.html#cb36-9" tabindex="-1"></a><span class="fu">colnames</span>(table55) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;変数&quot;</span>, <span class="st">&quot;サンプルサイズ&quot;</span>, <span class="st">&quot;平均&quot;</span>, <span class="st">&quot;標準偏差&quot;</span>, <span class="st">&quot;最小値&quot;</span>, <span class="st">&quot;最大値&quot;</span>)</span>
<span id="cb36-10"><a href="ch5.html#cb36-10" tabindex="-1"></a><span class="co"># 変数名</span></span>
<span id="cb36-11"><a href="ch5.html#cb36-11" tabindex="-1"></a>table55[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;経済成長率&quot;</span>, <span class="st">&quot;信頼&quot;</span>, <span class="st">&quot;規範&quot;</span>, <span class="st">&quot;教育水準&quot;</span>, <span class="st">&quot;初期時点対数GDP&quot;</span>)</span>
<span id="cb36-12"><a href="ch5.html#cb36-12" tabindex="-1"></a><span class="co"># 表を出力</span></span>
<span id="cb36-13"><a href="ch5.html#cb36-13" tabindex="-1"></a><span class="fu">gt</span>(table55)</span></code></pre></div>
<div id="dsglcvmvpv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dsglcvmvpv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dsglcvmvpv thead, #dsglcvmvpv tbody, #dsglcvmvpv tfoot, #dsglcvmvpv tr, #dsglcvmvpv td, #dsglcvmvpv th {
  border-style: none;
}

#dsglcvmvpv p {
  margin: 0;
  padding: 0;
}

#dsglcvmvpv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dsglcvmvpv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dsglcvmvpv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dsglcvmvpv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dsglcvmvpv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dsglcvmvpv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dsglcvmvpv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dsglcvmvpv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dsglcvmvpv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dsglcvmvpv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dsglcvmvpv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dsglcvmvpv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dsglcvmvpv .gt_spanner_row {
  border-bottom-style: hidden;
}

#dsglcvmvpv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dsglcvmvpv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dsglcvmvpv .gt_from_md > :first-child {
  margin-top: 0;
}

#dsglcvmvpv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dsglcvmvpv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dsglcvmvpv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dsglcvmvpv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dsglcvmvpv .gt_row_group_first td {
  border-top-width: 2px;
}

#dsglcvmvpv .gt_row_group_first th {
  border-top-width: 2px;
}

#dsglcvmvpv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dsglcvmvpv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dsglcvmvpv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dsglcvmvpv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dsglcvmvpv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dsglcvmvpv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dsglcvmvpv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dsglcvmvpv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dsglcvmvpv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dsglcvmvpv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dsglcvmvpv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dsglcvmvpv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dsglcvmvpv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dsglcvmvpv .gt_left {
  text-align: left;
}

#dsglcvmvpv .gt_center {
  text-align: center;
}

#dsglcvmvpv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dsglcvmvpv .gt_font_normal {
  font-weight: normal;
}

#dsglcvmvpv .gt_font_bold {
  font-weight: bold;
}

#dsglcvmvpv .gt_font_italic {
  font-style: italic;
}

#dsglcvmvpv .gt_super {
  font-size: 65%;
}

#dsglcvmvpv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dsglcvmvpv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dsglcvmvpv .gt_indent_1 {
  text-indent: 5px;
}

#dsglcvmvpv .gt_indent_2 {
  text-indent: 10px;
}

#dsglcvmvpv .gt_indent_3 {
  text-indent: 15px;
}

#dsglcvmvpv .gt_indent_4 {
  text-indent: 20px;
}

#dsglcvmvpv .gt_indent_5 {
  text-indent: 25px;
}

#dsglcvmvpv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dsglcvmvpv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a変数">変数</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="aサンプルサイズ">サンプルサイズ</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a平均">平均</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a標準偏差">標準偏差</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a最小値">最小値</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a最大値">最大値</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="変数" class="gt_row gt_left">経済成長率</td>
<td headers="サンプルサイズ" class="gt_row gt_right">47</td>
<td headers="平均" class="gt_row gt_right">3.147</td>
<td headers="標準偏差" class="gt_row gt_right">0.449</td>
<td headers="最小値" class="gt_row gt_right">2.185</td>
<td headers="最大値" class="gt_row gt_right">3.920</td></tr>
    <tr><td headers="変数" class="gt_row gt_left">信頼</td>
<td headers="サンプルサイズ" class="gt_row gt_right">47</td>
<td headers="平均" class="gt_row gt_right">0.033</td>
<td headers="標準偏差" class="gt_row gt_right">0.845</td>
<td headers="最小値" class="gt_row gt_right">-1.668</td>
<td headers="最大値" class="gt_row gt_right">1.918</td></tr>
    <tr><td headers="変数" class="gt_row gt_left">規範</td>
<td headers="サンプルサイズ" class="gt_row gt_right">47</td>
<td headers="平均" class="gt_row gt_right">0.101</td>
<td headers="標準偏差" class="gt_row gt_right">0.542</td>
<td headers="最小値" class="gt_row gt_right">-1.248</td>
<td headers="最大値" class="gt_row gt_right">1.297</td></tr>
    <tr><td headers="変数" class="gt_row gt_left">教育水準</td>
<td headers="サンプルサイズ" class="gt_row gt_right">47</td>
<td headers="平均" class="gt_row gt_right">0.112</td>
<td headers="標準偏差" class="gt_row gt_right">0.036</td>
<td headers="最小値" class="gt_row gt_right">0.069</td>
<td headers="最大値" class="gt_row gt_right">0.238</td></tr>
    <tr><td headers="変数" class="gt_row gt_left">初期時点対数GDP</td>
<td headers="サンプルサイズ" class="gt_row gt_right">47</td>
<td headers="平均" class="gt_row gt_right">1.341</td>
<td headers="標準偏差" class="gt_row gt_right">0.167</td>
<td headers="最小値" class="gt_row gt_right">1.037</td>
<td headers="最大値" class="gt_row gt_right">1.703</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="table5-6" class="section level2 unnumbered hasAnchor">
<h2>表5-6 推定結果: 被説明変数は経済成長率<a href="ch5.html#table5-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>回帰結果の表は<code>modelsummary</code>を使う (<code>stargazer</code>でも可能だが更新が止まっており, <code>estimatr</code>の結果を表示できないなどデメリットがある). <code>modelsummary::msummary()</code>の<code>goef_omit</code>で表示しない統計量を指定できるが, これは正規表現を使っているため, 自由度修正済み決定係数<span class="math inline">\(\bar{R}^2\)</span>を表示し, 通常の決定係数<span class="math inline">\(R^2\)</span>を表示させないためには<code>R2$</code>とすればよい. F検定統計量の値を表示するにあたっては, <a href="https://stackoverflow.com/questions/69582118/extracting-information-from-r-objects-and-importing-it-to-a-modelsummary-table">このサイト</a>を参考にした.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="ch5.html#cb37-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb37-2"><a href="ch5.html#cb37-2" tabindex="-1"></a>    <span class="st">&quot;(1)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> trust80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb37-3"><a href="ch5.html#cb37-3" tabindex="-1"></a>    <span class="st">&quot;(2)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> norm80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb37-4"><a href="ch5.html#cb37-4" tabindex="-1"></a>    <span class="st">&quot;(3)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> trust80 <span class="sc">+</span> norm80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb37-5"><a href="ch5.html#cb37-5" tabindex="-1"></a>    <span class="st">&quot;(4)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> trust80 <span class="sc">+</span> lny80 <span class="sc">+</span> education80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb37-6"><a href="ch5.html#cb37-6" tabindex="-1"></a>    <span class="st">&quot;(5)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> norm80 <span class="sc">+</span> lny80 <span class="sc">+</span> education80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb37-7"><a href="ch5.html#cb37-7" tabindex="-1"></a>    <span class="st">&quot;(6)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> trust80 <span class="sc">+</span> norm80 <span class="sc">+</span> lny80 <span class="sc">+</span> education80, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>))</span>
<span id="cb37-8"><a href="ch5.html#cb37-8" tabindex="-1"></a></span>
<span id="cb37-9"><a href="ch5.html#cb37-9" tabindex="-1"></a><span class="co"># F検定統計量の値を表示するモデルを指定</span></span>
<span id="cb37-10"><a href="ch5.html#cb37-10" tabindex="-1"></a><span class="fu">attr</span>(models[<span class="dv">3</span>]<span class="sc">$</span><span class="st">`</span><span class="at">(3)</span><span class="st">`</span>, <span class="st">&quot;FTEST&quot;</span>) <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb37-11"><a href="ch5.html#cb37-11" tabindex="-1"></a><span class="fu">attr</span>(models[<span class="dv">6</span>]<span class="sc">$</span><span class="st">`</span><span class="at">(6)</span><span class="st">`</span>, <span class="st">&quot;FTEST&quot;</span>) <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb37-12"><a href="ch5.html#cb37-12" tabindex="-1"></a></span>
<span id="cb37-13"><a href="ch5.html#cb37-13" tabindex="-1"></a>glance_custom.lm_robust <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb37-14"><a href="ch5.html#cb37-14" tabindex="-1"></a>    <span class="co"># 上で指定した, F検定統計量の値を表示したいモデルでなければパス</span></span>
<span id="cb37-15"><a href="ch5.html#cb37-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">isTRUE</span>(<span class="fu">attr</span>(x, <span class="st">&quot;FTEST&quot;</span>))) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb37-16"><a href="ch5.html#cb37-16" tabindex="-1"></a></span>
<span id="cb37-17"><a href="ch5.html#cb37-17" tabindex="-1"></a>    <span class="co"># F検定を実行</span></span>
<span id="cb37-18"><a href="ch5.html#cb37-18" tabindex="-1"></a>    ftest <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(x, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;trust80&quot;</span>, <span class="st">&quot;norm80&quot;</span>))</span>
<span id="cb37-19"><a href="ch5.html#cb37-19" tabindex="-1"></a></span>
<span id="cb37-20"><a href="ch5.html#cb37-20" tabindex="-1"></a>    <span class="co"># F検定統計量の値とp値をまとめたtibbleを作成</span></span>
<span id="cb37-21"><a href="ch5.html#cb37-21" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-22"><a href="ch5.html#cb37-22" tabindex="-1"></a>        <span class="st">&quot;F検定統計量の値 $H_0: </span><span class="sc">\\</span><span class="st">beta_{信頼}=0, </span><span class="sc">\\</span><span class="st">beta_{規範}=0$&quot;</span> <span class="ot">=</span> ftest[[<span class="st">&quot;F&quot;</span>]][<span class="dv">2</span>],</span>
<span id="cb37-23"><a href="ch5.html#cb37-23" tabindex="-1"></a>        <span class="st">&quot;     &quot;</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">&quot;(%.3f)&quot;</span>, ftest[[<span class="st">&quot;Pr(&gt;F)&quot;</span>]][<span class="dv">2</span>]))</span>
<span id="cb37-24"><a href="ch5.html#cb37-24" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb37-25"><a href="ch5.html#cb37-25" tabindex="-1"></a>}</span>
<span id="cb37-26"><a href="ch5.html#cb37-26" tabindex="-1"></a></span>
<span id="cb37-27"><a href="ch5.html#cb37-27" tabindex="-1"></a>gm <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb37-28"><a href="ch5.html#cb37-28" tabindex="-1"></a>    <span class="sc">~</span>raw,        <span class="sc">~</span>clean,          <span class="sc">~</span>fmt,</span>
<span id="cb37-29"><a href="ch5.html#cb37-29" tabindex="-1"></a>    <span class="st">&quot;F検定統計量の値 $H_0: </span><span class="sc">\\</span><span class="st">beta_{信頼}=0, </span><span class="sc">\\</span><span class="st">beta_{規範}=0$&quot;</span>, <span class="st">&quot;F検定統計量の値 $H_0: </span><span class="sc">\\</span><span class="st">beta_{信頼}=0, </span><span class="sc">\\</span><span class="st">beta_{規範}=0$&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb37-30"><a href="ch5.html#cb37-30" tabindex="-1"></a>    <span class="st">&quot;     &quot;</span>, <span class="st">&quot;     &quot;</span>, <span class="dv">3</span>,</span>
<span id="cb37-31"><a href="ch5.html#cb37-31" tabindex="-1"></a>    <span class="st">&quot;adj.r.squared&quot;</span>, <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">bar{R}^2$&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb37-32"><a href="ch5.html#cb37-32" tabindex="-1"></a>    <span class="st">&quot;nobs&quot;</span>, <span class="st">&quot;サンプルサイズ&quot;</span>, <span class="dv">0</span>)</span>
<span id="cb37-33"><a href="ch5.html#cb37-33" tabindex="-1"></a></span>
<span id="cb37-34"><a href="ch5.html#cb37-34" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;trust80&quot;</span> <span class="ot">=</span> <span class="st">&quot;信頼&quot;</span>, <span class="st">&quot;norm80&quot;</span> <span class="ot">=</span> <span class="st">&quot;規範&quot;</span>, <span class="st">&quot;lny80&quot;</span> <span class="ot">=</span> <span class="st">&quot;初期時点対数GDP&quot;</span>, <span class="st">&quot;education80&quot;</span> <span class="ot">=</span> <span class="st">&quot;教育水準&quot;</span>, <span class="st">&quot;(Intercept)&quot;</span> <span class="ot">=</span> <span class="st">&quot;定数項&quot;</span>)</span>
<span id="cb37-35"><a href="ch5.html#cb37-35" tabindex="-1"></a></span>
<span id="cb37-36"><a href="ch5.html#cb37-36" tabindex="-1"></a><span class="fu">msummary</span>(models,</span>
<span id="cb37-37"><a href="ch5.html#cb37-37" tabindex="-1"></a>         <span class="at">stars =</span> <span class="fu">c</span>(<span class="st">&quot;*&quot;</span> <span class="ot">=</span> <span class="fl">0.05</span>, <span class="st">&quot;**&quot;</span> <span class="ot">=</span> <span class="fl">0.01</span>, <span class="st">&quot;***&quot;</span> <span class="ot">=</span> <span class="fl">0.001</span>),</span>
<span id="cb37-38"><a href="ch5.html#cb37-38" tabindex="-1"></a>         <span class="at">gof_omit=</span><span class="st">&#39;R2$|RMSE|AIC|BIC|Log.Lik.&#39;</span>,</span>
<span id="cb37-39"><a href="ch5.html#cb37-39" tabindex="-1"></a>         <span class="at">gof_map =</span> gm,</span>
<span id="cb37-40"><a href="ch5.html#cb37-40" tabindex="-1"></a>         <span class="at">coef_map =</span> cm,</span>
<span id="cb37-41"><a href="ch5.html#cb37-41" tabindex="-1"></a>         <span class="at">output =</span> <span class="st">&quot;kableExtra&quot;</span>,</span>
<span id="cb37-42"><a href="ch5.html#cb37-42" tabindex="-1"></a>         <span class="at">estimate =</span> <span class="st">&quot;{estimate}{stars}&quot;</span>,</span>
<span id="cb37-43"><a href="ch5.html#cb37-43" tabindex="-1"></a>         <span class="at">notes =</span> <span class="st">&quot;* p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-44"><a href="ch5.html#cb37-44" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">14</span>), <span class="at">extra_css =</span> <span class="st">&quot;border-bottom: 1.5px solid&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-45"><a href="ch5.html#cb37-45" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="dv">10</span>, <span class="at">extra_css =</span> <span class="st">&quot;;border-bottom: 1.5px solid&quot;</span>) <span class="co"># 32行目の下 (estimateとstatisticsの境) のみコロンが必要</span></span></code></pre></div>
<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table">
<thead>
<tr>
<th style="text-align:left;border-bottom: 1.5px solid">
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;(1)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(2)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(3)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(4)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(5)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(6)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
信頼
</td>
<td style="text-align:center;">
0.225**
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.036
</td>
<td style="text-align:center;">
0.021
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
−0.012
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.066)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.082)
</td>
<td style="text-align:center;">
(0.076)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.081)
</td>
</tr>
<tr>
<td style="text-align:left;">
規範
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.560***
</td>
<td style="text-align:center;">
0.529***
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.338*
</td>
<td style="text-align:center;">
0.342*
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.071)
</td>
<td style="text-align:center;">
(0.102)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.137)
</td>
<td style="text-align:center;">
(0.148)
</td>
</tr>
<tr>
<td style="text-align:left;">
初期時点対数GDP
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
−2.383***
</td>
<td style="text-align:center;">
−1.991**
</td>
<td style="text-align:center;">
−1.999***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.491)
</td>
<td style="text-align:center;">
(0.575)
</td>
<td style="text-align:center;">
(0.556)
</td>
</tr>
<tr>
<td style="text-align:left;">
教育水準
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
2.612
</td>
<td style="text-align:center;">
4.387*
</td>
<td style="text-align:center;">
4.270
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(2.709)
</td>
<td style="text-align:center;">
(1.961)
</td>
<td style="text-align:center;">
(2.237)
</td>
</tr>
<tr>
<td style="text-align:left;">
定数項
</td>
<td style="text-align:center;">
3.139***
</td>
<td style="text-align:center;">
3.091***
</td>
<td style="text-align:center;">
3.092***
</td>
<td style="text-align:center;">
6.049***
</td>
<td style="text-align:center;">
5.291***
</td>
<td style="text-align:center;">
5.315***
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.060)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.048)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.048)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.426)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.668)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.603)
</td>
</tr>
<tr>
<td style="text-align:left;">
F検定統計量の値 <span class="math inline">\(H_0: \beta_{信頼}=0, \beta_{規範}=0\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
29.874
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
3.460
</td>
</tr>
<tr>
<td style="text-align:left;border-bottom: 1.5px solid">
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
(0.000)
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
(0.041)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\bar{R}^2\)</span>
</td>
<td style="text-align:center;">
0.161
</td>
<td style="text-align:center;">
0.444
</td>
<td style="text-align:center;">
0.435
</td>
<td style="text-align:center;">
0.531
</td>
<td style="text-align:center;">
0.614
</td>
<td style="text-align:center;">
0.605
</td>
</tr>
<tr>
<td style="text-align:left;border-bottom: 1.5px solid">
サンプルサイズ
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
47
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
47
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
47
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
47
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
47
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
47
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001
</td>
</tr>
</tfoot>
</table>
<p>F検定統計量の星の表示は, 手動で追加する必要があると思われるので, 一旦省略とする.</p>
</div>
<div id="表5-7-推定結果" class="section level2 unnumbered hasAnchor">
<h2>表5-7 推定結果<a href="ch5.html#表5-7-推定結果" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>サポートサイトにはデータはないが, Rでは<code>wooldridge</code>パッケージにまとめられているデータ<code>attend</code>を用いることができる.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="ch5.html#cb38-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;attend&#39;</span>)</span>
<span id="cb38-2"><a href="ch5.html#cb38-2" tabindex="-1"></a>models_57 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-3"><a href="ch5.html#cb38-3" tabindex="-1"></a>    <span class="st">&quot;(1)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(stndfnl <span class="sc">~</span> atndrte <span class="sc">+</span> frosh <span class="sc">+</span> soph, <span class="at">data =</span> attend, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb38-4"><a href="ch5.html#cb38-4" tabindex="-1"></a>    <span class="st">&quot;(2)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(stndfnl <span class="sc">~</span> atndrte <span class="sc">+</span> priGPA <span class="sc">+</span> ACT <span class="sc">+</span> frosh <span class="sc">+</span> soph, <span class="at">data =</span> attend, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb38-5"><a href="ch5.html#cb38-5" tabindex="-1"></a>    <span class="st">&quot;(3)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(stndfnl <span class="sc">~</span> atndrte <span class="sc">*</span> priGPA <span class="sc">+</span> ACT <span class="sc">+</span> frosh <span class="sc">+</span> soph, <span class="at">data =</span> attend, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb38-6"><a href="ch5.html#cb38-6" tabindex="-1"></a>    <span class="st">&quot;(4)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(stndfnl <span class="sc">~</span> atndrte <span class="sc">+</span> priGPA <span class="sc">+</span> <span class="fu">I</span>(priGPA<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> ACT <span class="sc">+</span> <span class="fu">I</span>(ACT<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> frosh <span class="sc">+</span> soph, <span class="at">data =</span> attend, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>),</span>
<span id="cb38-7"><a href="ch5.html#cb38-7" tabindex="-1"></a>    <span class="st">&quot;(5)&quot;</span> <span class="ot">=</span> <span class="fu">lm_robust</span>(stndfnl <span class="sc">~</span> atndrte <span class="sc">*</span> priGPA <span class="sc">+</span> atndrte <span class="sc">*</span> <span class="fu">I</span>(priGPA<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> ACT <span class="sc">+</span> <span class="fu">I</span>(ACT<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> frosh <span class="sc">+</span> soph, <span class="at">data =</span> attend, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>))</span>
<span id="cb38-8"><a href="ch5.html#cb38-8" tabindex="-1"></a></span>
<span id="cb38-9"><a href="ch5.html#cb38-9" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;atndrte&quot;</span> <span class="ot">=</span> <span class="st">&quot;出席割合&quot;</span>,</span>
<span id="cb38-10"><a href="ch5.html#cb38-10" tabindex="-1"></a>        <span class="st">&quot;priGPA&quot;</span> <span class="ot">=</span> <span class="st">&quot;前学期までのGPA&quot;</span>,</span>
<span id="cb38-11"><a href="ch5.html#cb38-11" tabindex="-1"></a>        <span class="st">&quot;I(priGPA^2)&quot;</span> <span class="ot">=</span> <span class="st">&quot;前学期までのGPA$^2$&quot;</span>,</span>
<span id="cb38-12"><a href="ch5.html#cb38-12" tabindex="-1"></a>        <span class="st">&quot;atndrte:priGPA&quot;</span> <span class="ot">=</span> <span class="st">&quot;出席割合 $</span><span class="sc">\\</span><span class="st">times$ 前学期までのGPA&quot;</span>,</span>
<span id="cb38-13"><a href="ch5.html#cb38-13" tabindex="-1"></a>        <span class="st">&quot;atndrte:I(priGPA^2)&quot;</span> <span class="ot">=</span> <span class="st">&quot;出席割合 $</span><span class="sc">\\</span><span class="st">times$ 前学期までのGPA$^2$&quot;</span>,</span>
<span id="cb38-14"><a href="ch5.html#cb38-14" tabindex="-1"></a>        <span class="st">&quot;ACT&quot;</span> <span class="ot">=</span> <span class="st">&quot;ACT&quot;</span>,</span>
<span id="cb38-15"><a href="ch5.html#cb38-15" tabindex="-1"></a>        <span class="st">&quot;I(ACT^2)&quot;</span> <span class="ot">=</span> <span class="st">&quot;ACT$^2$&quot;</span>,</span>
<span id="cb38-16"><a href="ch5.html#cb38-16" tabindex="-1"></a>        <span class="st">&quot;frosh&quot;</span> <span class="ot">=</span> <span class="st">&quot;1年生&quot;</span>,</span>
<span id="cb38-17"><a href="ch5.html#cb38-17" tabindex="-1"></a>        <span class="st">&quot;soph&quot;</span> <span class="ot">=</span> <span class="st">&quot;2年生&quot;</span>,</span>
<span id="cb38-18"><a href="ch5.html#cb38-18" tabindex="-1"></a>        <span class="st">&quot;(Intercept)&quot;</span> <span class="ot">=</span> <span class="st">&quot;定数項&quot;</span>)</span>
<span id="cb38-19"><a href="ch5.html#cb38-19" tabindex="-1"></a></span>
<span id="cb38-20"><a href="ch5.html#cb38-20" tabindex="-1"></a>gm <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb38-21"><a href="ch5.html#cb38-21" tabindex="-1"></a>    <span class="sc">~</span>raw,            <span class="sc">~</span>clean,           <span class="sc">~</span>fmt,</span>
<span id="cb38-22"><a href="ch5.html#cb38-22" tabindex="-1"></a>    <span class="st">&quot;adj.r.squared&quot;</span>, <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">bar{R}^2$&quot;</span>,   <span class="dv">2</span>,</span>
<span id="cb38-23"><a href="ch5.html#cb38-23" tabindex="-1"></a>    <span class="st">&quot;nobs&quot;</span>,          <span class="st">&quot;サンプルサイズ&quot;</span>, <span class="dv">0</span>)</span>
<span id="cb38-24"><a href="ch5.html#cb38-24" tabindex="-1"></a></span>
<span id="cb38-25"><a href="ch5.html#cb38-25" tabindex="-1"></a><span class="co"># 丸め関数を定義</span></span>
<span id="cb38-26"><a href="ch5.html#cb38-26" tabindex="-1"></a>custom_format <span class="ot">&lt;-</span> <span class="cf">function</span>(values) {</span>
<span id="cb38-27"><a href="ch5.html#cb38-27" tabindex="-1"></a>    formatted_values <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(values <span class="sc">&lt;</span> <span class="dv">1</span>,</span>
<span id="cb38-28"><a href="ch5.html#cb38-28" tabindex="-1"></a>                                <span class="fu">signif</span>(values, <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb38-29"><a href="ch5.html#cb38-29" tabindex="-1"></a>                                <span class="fu">round</span>(values, <span class="at">digits=</span><span class="dv">2</span>))</span>
<span id="cb38-30"><a href="ch5.html#cb38-30" tabindex="-1"></a>    <span class="fu">return</span>(formatted_values)</span>
<span id="cb38-31"><a href="ch5.html#cb38-31" tabindex="-1"></a>}</span>
<span id="cb38-32"><a href="ch5.html#cb38-32" tabindex="-1"></a></span>
<span id="cb38-33"><a href="ch5.html#cb38-33" tabindex="-1"></a><span class="co"># なぜか定数項だけ丸めがおかしい?</span></span>
<span id="cb38-34"><a href="ch5.html#cb38-34" tabindex="-1"></a><span class="fu">msummary</span>(models_57,</span>
<span id="cb38-35"><a href="ch5.html#cb38-35" tabindex="-1"></a>         <span class="at">stars =</span> <span class="fu">c</span>(<span class="st">&quot;*&quot;</span> <span class="ot">=</span> <span class="fl">0.05</span>, <span class="st">&quot;**&quot;</span> <span class="ot">=</span> <span class="fl">0.01</span>, <span class="st">&quot;***&quot;</span> <span class="ot">=</span> <span class="fl">0.001</span>),</span>
<span id="cb38-36"><a href="ch5.html#cb38-36" tabindex="-1"></a>         <span class="at">gof_omit=</span><span class="st">&#39;R2$|RMSE|AIC|BIC|Log.Lik.&#39;</span>,</span>
<span id="cb38-37"><a href="ch5.html#cb38-37" tabindex="-1"></a>         <span class="at">coef_map =</span> cm,</span>
<span id="cb38-38"><a href="ch5.html#cb38-38" tabindex="-1"></a>         <span class="at">gof_map =</span> gm,</span>
<span id="cb38-39"><a href="ch5.html#cb38-39" tabindex="-1"></a>         <span class="at">estimate =</span> <span class="st">&quot;{estimate}{stars}&quot;</span>,</span>
<span id="cb38-40"><a href="ch5.html#cb38-40" tabindex="-1"></a>         <span class="at">output =</span> <span class="st">&quot;kableExtra&quot;</span>,</span>
<span id="cb38-41"><a href="ch5.html#cb38-41" tabindex="-1"></a>         <span class="at">notes =</span> <span class="st">&quot;* p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&quot;</span>,</span>
<span id="cb38-42"><a href="ch5.html#cb38-42" tabindex="-1"></a>         <span class="at">fmt =</span> custom_format) <span class="sc">%&gt;%</span></span>
<span id="cb38-43"><a href="ch5.html#cb38-43" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">22</span>), <span class="at">extra_css =</span> <span class="st">&quot;border-bottom: 1.5px solid&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-44"><a href="ch5.html#cb38-44" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="dv">20</span>, <span class="at">extra_css =</span> <span class="st">&quot;;border-bottom: 1.5px solid&quot;</span>) <span class="co"># 20行目の下 (estimateとstatisticsの境) のみコロンが必要</span></span></code></pre></div>
<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table">
<thead>
<tr>
<th style="text-align:left;border-bottom: 1.5px solid">
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;(1)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(2)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(3)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(4)
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
&amp;nbsp;&amp;nbsp;(5)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
出席割合
</td>
<td style="text-align:center;">
0.0082***
</td>
<td style="text-align:center;">
0.0052*
</td>
<td style="text-align:center;">
−0.022*
</td>
<td style="text-align:center;">
0.0062**
</td>
<td style="text-align:center;">
0.065*
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.0021)
</td>
<td style="text-align:center;">
(0.0024)
</td>
<td style="text-align:center;">
(0.0088)
</td>
<td style="text-align:center;">
(0.0023)
</td>
<td style="text-align:center;">
(0.032)
</td>
</tr>
<tr>
<td style="text-align:left;">
前学期までのGPA
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.43***
</td>
<td style="text-align:center;">
−0.56
</td>
<td style="text-align:center;">
−1.5**
</td>
<td style="text-align:center;">
3.63
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.086)
</td>
<td style="text-align:center;">
(0.32)
</td>
<td style="text-align:center;">
(0.49)
</td>
<td style="text-align:center;">
(2.21)
</td>
</tr>
<tr>
<td style="text-align:left;">
前学期までのGPA<span class="math inline">\(^2\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.37***
</td>
<td style="text-align:center;">
−0.82
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.09)
</td>
<td style="text-align:center;">
(0.45)
</td>
</tr>
<tr>
<td style="text-align:left;">
出席割合 <span class="math inline">\(\times\)</span> 前学期までのGPA
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.012**
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
−0.057*
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.0037)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.026)
</td>
</tr>
<tr>
<td style="text-align:left;">
出席割合 <span class="math inline">\(\times\)</span> 前学期までのGPA<span class="math inline">\(^2\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.013*
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.0052)
</td>
</tr>
<tr>
<td style="text-align:left;">
ACT
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.084***
</td>
<td style="text-align:center;">
0.082***
</td>
<td style="text-align:center;">
−0.11
</td>
<td style="text-align:center;">
−0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.011)
</td>
<td style="text-align:center;">
(0.011)
</td>
<td style="text-align:center;">
(0.1)
</td>
<td style="text-align:center;">
(0.1)
</td>
</tr>
<tr>
<td style="text-align:left;">
ACT<span class="math inline">\(^2\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.0042
</td>
<td style="text-align:center;">
0.0042
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.0023)
</td>
<td style="text-align:center;">
(0.0022)
</td>
</tr>
<tr>
<td style="text-align:left;">
1年生
</td>
<td style="text-align:center;">
−0.29*
</td>
<td style="text-align:center;">
−0.049
</td>
<td style="text-align:center;">
−0.063
</td>
<td style="text-align:center;">
−0.11
</td>
<td style="text-align:center;">
−0.1
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.11)
</td>
<td style="text-align:center;">
(0.11)
</td>
<td style="text-align:center;">
(0.1)
</td>
<td style="text-align:center;">
(0.1)
</td>
<td style="text-align:center;">
(0.1)
</td>
</tr>
<tr>
<td style="text-align:left;">
2年生
</td>
<td style="text-align:center;">
−0.12
</td>
<td style="text-align:center;">
−0.16
</td>
<td style="text-align:center;">
−0.17
</td>
<td style="text-align:center;">
−0.18*
</td>
<td style="text-align:center;">
−0.19*
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.1)
</td>
<td style="text-align:center;">
(0.089)
</td>
<td style="text-align:center;">
(0.088)
</td>
<td style="text-align:center;">
(0.087)
</td>
<td style="text-align:center;">
(0.086)
</td>
</tr>
<tr>
<td style="text-align:left;">
定数項
</td>
<td style="text-align:center;">
−0.5**
</td>
<td style="text-align:center;">
−3.3***
</td>
<td style="text-align:center;">
−1
</td>
<td style="text-align:center;">
1.38
</td>
<td style="text-align:center;">
−3.9
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.18)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.3)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.76)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(1.24)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(2.95)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\bar{R}^2\)</span>
</td>
<td style="text-align:center;">
0.02
</td>
<td style="text-align:center;">
0.20
</td>
<td style="text-align:center;">
0.21
</td>
<td style="text-align:center;">
0.22
</td>
<td style="text-align:center;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;border-bottom: 1.5px solid">
サンプルサイズ
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
680
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
680
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
680
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
680
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
680
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001
</td>
</tr>
</tfoot>
</table>
<p>F検定統計量の表への記載は省略とし, 下に検定結果を示す.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ch5.html#cb39-1" tabindex="-1"></a><span class="fu">linearHypothesis</span>(models_57[<span class="dv">3</span>]<span class="sc">$</span><span class="st">`</span><span class="at">(3)</span><span class="st">`</span>, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;atndrte&quot;</span>, <span class="st">&quot;atndrte:priGPA&quot;</span>))</span>
<span id="cb39-2"><a href="ch5.html#cb39-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-3"><a href="ch5.html#cb39-3" tabindex="-1"></a><span class="do">## Linear hypothesis test:</span></span>
<span id="cb39-4"><a href="ch5.html#cb39-4" tabindex="-1"></a><span class="do">## atndrte = 0</span></span>
<span id="cb39-5"><a href="ch5.html#cb39-5" tabindex="-1"></a><span class="do">## atndrte:priGPA = 0</span></span>
<span id="cb39-6"><a href="ch5.html#cb39-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-7"><a href="ch5.html#cb39-7" tabindex="-1"></a><span class="do">## Model 1: restricted model</span></span>
<span id="cb39-8"><a href="ch5.html#cb39-8" tabindex="-1"></a><span class="do">## Model 2: stndfnl ~ atndrte * priGPA + ACT + frosh + soph</span></span>
<span id="cb39-9"><a href="ch5.html#cb39-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-10"><a href="ch5.html#cb39-10" tabindex="-1"></a><span class="do">##   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb39-11"><a href="ch5.html#cb39-11" tabindex="-1"></a><span class="do">## 1    675                        </span></span>
<span id="cb39-12"><a href="ch5.html#cb39-12" tabindex="-1"></a><span class="do">## 2    673  2 7.8085 0.0004442 ***</span></span>
<span id="cb39-13"><a href="ch5.html#cb39-13" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb39-14"><a href="ch5.html#cb39-14" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb39-15"><a href="ch5.html#cb39-15" tabindex="-1"></a><span class="fu">linearHypothesis</span>(models_57[<span class="dv">4</span>]<span class="sc">$</span><span class="st">`</span><span class="at">(4)</span><span class="st">`</span>, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;I(priGPA^2)&quot;</span>, <span class="st">&quot;I(ACT^2)&quot;</span>))</span>
<span id="cb39-16"><a href="ch5.html#cb39-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-17"><a href="ch5.html#cb39-17" tabindex="-1"></a><span class="do">## Linear hypothesis test:</span></span>
<span id="cb39-18"><a href="ch5.html#cb39-18" tabindex="-1"></a><span class="do">## I(priGPA^2) = 0</span></span>
<span id="cb39-19"><a href="ch5.html#cb39-19" tabindex="-1"></a><span class="do">## I(ACT^2) = 0</span></span>
<span id="cb39-20"><a href="ch5.html#cb39-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-21"><a href="ch5.html#cb39-21" tabindex="-1"></a><span class="do">## Model 1: restricted model</span></span>
<span id="cb39-22"><a href="ch5.html#cb39-22" tabindex="-1"></a><span class="do">## Model 2: stndfnl ~ atndrte + priGPA + I(priGPA^2) + ACT + I(ACT^2) + frosh + </span></span>
<span id="cb39-23"><a href="ch5.html#cb39-23" tabindex="-1"></a><span class="do">##     soph</span></span>
<span id="cb39-24"><a href="ch5.html#cb39-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-25"><a href="ch5.html#cb39-25" tabindex="-1"></a><span class="do">##   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb39-26"><a href="ch5.html#cb39-26" tabindex="-1"></a><span class="do">## 1    674                        </span></span>
<span id="cb39-27"><a href="ch5.html#cb39-27" tabindex="-1"></a><span class="do">## 2    672  2 11.772 9.438e-06 ***</span></span>
<span id="cb39-28"><a href="ch5.html#cb39-28" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb39-29"><a href="ch5.html#cb39-29" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb39-30"><a href="ch5.html#cb39-30" tabindex="-1"></a><span class="fu">linearHypothesis</span>(models_57[<span class="dv">5</span>]<span class="sc">$</span><span class="st">`</span><span class="at">(5)</span><span class="st">`</span>, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;atndrte&quot;</span>, <span class="st">&quot;atndrte:priGPA&quot;</span>, <span class="st">&quot;atndrte:I(priGPA^2)&quot;</span>))</span>
<span id="cb39-31"><a href="ch5.html#cb39-31" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-32"><a href="ch5.html#cb39-32" tabindex="-1"></a><span class="do">## Linear hypothesis test:</span></span>
<span id="cb39-33"><a href="ch5.html#cb39-33" tabindex="-1"></a><span class="do">## atndrte = 0</span></span>
<span id="cb39-34"><a href="ch5.html#cb39-34" tabindex="-1"></a><span class="do">## atndrte:priGPA = 0</span></span>
<span id="cb39-35"><a href="ch5.html#cb39-35" tabindex="-1"></a><span class="do">## atndrte:I(priGPA^2) = 0</span></span>
<span id="cb39-36"><a href="ch5.html#cb39-36" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-37"><a href="ch5.html#cb39-37" tabindex="-1"></a><span class="do">## Model 1: restricted model</span></span>
<span id="cb39-38"><a href="ch5.html#cb39-38" tabindex="-1"></a><span class="do">## Model 2: stndfnl ~ atndrte * priGPA + atndrte * I(priGPA^2) + ACT + I(ACT^2) + </span></span>
<span id="cb39-39"><a href="ch5.html#cb39-39" tabindex="-1"></a><span class="do">##     frosh + soph</span></span>
<span id="cb39-40"><a href="ch5.html#cb39-40" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-41"><a href="ch5.html#cb39-41" tabindex="-1"></a><span class="do">##   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb39-42"><a href="ch5.html#cb39-42" tabindex="-1"></a><span class="do">## 1    673                        </span></span>
<span id="cb39-43"><a href="ch5.html#cb39-43" tabindex="-1"></a><span class="do">## 2    670  3 6.2543 0.0003437 ***</span></span>
<span id="cb39-44"><a href="ch5.html#cb39-44" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb39-45"><a href="ch5.html#cb39-45" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb39-46"><a href="ch5.html#cb39-46" tabindex="-1"></a><span class="fu">linearHypothesis</span>(models_57[<span class="dv">5</span>]<span class="sc">$</span><span class="st">`</span><span class="at">(5)</span><span class="st">`</span>, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;I(priGPA^2)&quot;</span>, <span class="st">&quot;atndrte:I(priGPA^2)&quot;</span>, <span class="st">&quot;I(ACT^2)&quot;</span>))</span>
<span id="cb39-47"><a href="ch5.html#cb39-47" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-48"><a href="ch5.html#cb39-48" tabindex="-1"></a><span class="do">## Linear hypothesis test:</span></span>
<span id="cb39-49"><a href="ch5.html#cb39-49" tabindex="-1"></a><span class="do">## I(priGPA^2) = 0</span></span>
<span id="cb39-50"><a href="ch5.html#cb39-50" tabindex="-1"></a><span class="do">## atndrte:I(priGPA^2) = 0</span></span>
<span id="cb39-51"><a href="ch5.html#cb39-51" tabindex="-1"></a><span class="do">## I(ACT^2) = 0</span></span>
<span id="cb39-52"><a href="ch5.html#cb39-52" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-53"><a href="ch5.html#cb39-53" tabindex="-1"></a><span class="do">## Model 1: restricted model</span></span>
<span id="cb39-54"><a href="ch5.html#cb39-54" tabindex="-1"></a><span class="do">## Model 2: stndfnl ~ atndrte * priGPA + atndrte * I(priGPA^2) + ACT + I(ACT^2) + </span></span>
<span id="cb39-55"><a href="ch5.html#cb39-55" tabindex="-1"></a><span class="do">##     frosh + soph</span></span>
<span id="cb39-56"><a href="ch5.html#cb39-56" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-57"><a href="ch5.html#cb39-57" tabindex="-1"></a><span class="do">##   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb39-58"><a href="ch5.html#cb39-58" tabindex="-1"></a><span class="do">## 1    673                        </span></span>
<span id="cb39-59"><a href="ch5.html#cb39-59" tabindex="-1"></a><span class="do">## 2    670  3 7.5692 5.521e-05 ***</span></span>
<span id="cb39-60"><a href="ch5.html#cb39-60" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb39-61"><a href="ch5.html#cb39-61" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb39-62"><a href="ch5.html#cb39-62" tabindex="-1"></a><span class="fu">linearHypothesis</span>(models_57[<span class="dv">5</span>]<span class="sc">$</span><span class="st">`</span><span class="at">(5)</span><span class="st">`</span>, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;atndrte:priGPA&quot;</span>, <span class="st">&quot;atndrte:I(priGPA^2)&quot;</span>))</span>
<span id="cb39-63"><a href="ch5.html#cb39-63" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-64"><a href="ch5.html#cb39-64" tabindex="-1"></a><span class="do">## Linear hypothesis test:</span></span>
<span id="cb39-65"><a href="ch5.html#cb39-65" tabindex="-1"></a><span class="do">## atndrte:priGPA = 0</span></span>
<span id="cb39-66"><a href="ch5.html#cb39-66" tabindex="-1"></a><span class="do">## atndrte:I(priGPA^2) = 0</span></span>
<span id="cb39-67"><a href="ch5.html#cb39-67" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-68"><a href="ch5.html#cb39-68" tabindex="-1"></a><span class="do">## Model 1: restricted model</span></span>
<span id="cb39-69"><a href="ch5.html#cb39-69" tabindex="-1"></a><span class="do">## Model 2: stndfnl ~ atndrte * priGPA + atndrte * I(priGPA^2) + ACT + I(ACT^2) + </span></span>
<span id="cb39-70"><a href="ch5.html#cb39-70" tabindex="-1"></a><span class="do">##     frosh + soph</span></span>
<span id="cb39-71"><a href="ch5.html#cb39-71" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-72"><a href="ch5.html#cb39-72" tabindex="-1"></a><span class="do">##   Res.Df Df      F   Pr(&gt;F)   </span></span>
<span id="cb39-73"><a href="ch5.html#cb39-73" tabindex="-1"></a><span class="do">## 1    672                      </span></span>
<span id="cb39-74"><a href="ch5.html#cb39-74" tabindex="-1"></a><span class="do">## 2    670  2 5.1942 0.005774 **</span></span>
<span id="cb39-75"><a href="ch5.html#cb39-75" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb39-76"><a href="ch5.html#cb39-76" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<!-- ## 練習問題 5-1 [確認] {.unnumbered}

## 練習問題 5-2 [確認] {.unnumbered}

## 練習問題 5-3 [確認] {.unnumbered}

## 練習問題 5-4 [確認] {.unnumbered}

## 練習問題 5-5 [確認] {.unnumbered}

## 練習問題 5-6 [確認] {.unnumbered}

## 練習問題 5-7 [確認] {.unnumbered}

## 練習問題 5-8 [確認] {.unnumbered}

## 練習問題 5-9 [確認] {.unnumbered}

## 練習問題 5-10 [発展] {.unnumbered}

## 練習問題 5-11 [発展] {.unnumbered}

## 練習問題 5-12 [発展] {.unnumbered}

## 練習問題 5-13 [\*発展] {.unnumbered} -->
</div>
<div id="練習問題-5-14-実証" class="section level2 unnumbered hasAnchor">
<h2>練習問題 5-14 [実証]<a href="ch5.html#練習問題-5-14-実証" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: lower-alpha">
<li><p>表5-6を参照せよ.</p></li>
<li><p>自由度修正済み決定係数<span class="math inline">\(\bar{R}^2\)</span>は以下のように定義される (p.158).</p></li>
</ol>
<p><span class="math display">\[\bar{R}^2 = 1 - \frac{N-1}{N-k-1}\frac{\sum_{i=1}^N\hat{u}_i^2}{\sum_{i=1}^N(Y_i-\bar{Y}^2)}\]</span>.</p>
<p>これを決定係数<span class="math inline">\(R^2\)</span>の定義と比べると, 自由度修正済み決定係数は変数の数<span class="math inline">\(k\)</span>が増えるたびに値が小さくなることがわかる. 決定係数<span class="math inline">\(R^2\)</span>ではこのようなことは起きず, 変数の数を増やすと<span class="math inline">\(R^2\)</span>の値は必ず変わらないか大きくなり, 小さくなることはない.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>問題文の指示の通り回帰分析を実行する. 1つめの方法では標準偏差の値は一致しないが, 2つ目の方法では一致することが確認できる.</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="ch5.html#cb40-1" tabindex="-1"></a>practice514c_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(trust80 <span class="sc">~</span> norm80, <span class="at">data =</span> youdou)</span>
<span id="cb40-2"><a href="ch5.html#cb40-2" tabindex="-1"></a>practice514c_2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(growthrate8099 <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> practice514c_1<span class="sc">$</span>residuals, <span class="at">data =</span> youdou, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb40-3"><a href="ch5.html#cb40-3" tabindex="-1"></a><span class="fu">summary</span>(practice514c_2)<span class="sc">$</span>coefficients</span>
<span id="cb40-4"><a href="ch5.html#cb40-4" tabindex="-1"></a><span class="do">##                           Estimate Std. Error    t value  Pr(&gt;|t|)  CI Lower</span></span>
<span id="cb40-5"><a href="ch5.html#cb40-5" tabindex="-1"></a><span class="do">## practice514c_1$residuals 0.0358709  0.7030377 0.05102272 0.9595283 -1.379271</span></span>
<span id="cb40-6"><a href="ch5.html#cb40-6" tabindex="-1"></a><span class="do">##                          CI Upper DF</span></span>
<span id="cb40-7"><a href="ch5.html#cb40-7" tabindex="-1"></a><span class="do">## practice514c_1$residuals 1.451012 46</span></span>
<span id="cb40-8"><a href="ch5.html#cb40-8" tabindex="-1"></a></span>
<span id="cb40-9"><a href="ch5.html#cb40-9" tabindex="-1"></a>practice514c_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growthrate8099 <span class="sc">~</span> norm80, <span class="at">data =</span> youdou)</span>
<span id="cb40-10"><a href="ch5.html#cb40-10" tabindex="-1"></a>practice514c_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(trust80 <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> norm80, <span class="at">data =</span> youdou)</span>
<span id="cb40-11"><a href="ch5.html#cb40-11" tabindex="-1"></a>practice514c_5 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(practice514c_3<span class="sc">$</span>residuals <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> practice514c_4<span class="sc">$</span>residuals, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb40-12"><a href="ch5.html#cb40-12" tabindex="-1"></a><span class="fu">summary</span>(practice514c_5)<span class="sc">$</span>coefficients</span>
<span id="cb40-13"><a href="ch5.html#cb40-13" tabindex="-1"></a><span class="do">##                            Estimate Std. Error   t value  Pr(&gt;|t|)   CI Lower</span></span>
<span id="cb40-14"><a href="ch5.html#cb40-14" tabindex="-1"></a><span class="do">## practice514c_4$residuals 0.03566014 0.08075573 0.4415803 0.6608618 -0.1268927</span></span>
<span id="cb40-15"><a href="ch5.html#cb40-15" tabindex="-1"></a><span class="do">##                          CI Upper DF</span></span>
<span id="cb40-16"><a href="ch5.html#cb40-16" tabindex="-1"></a><span class="do">## practice514c_4$residuals 0.198213 46</span></span></code></pre></div>
</div>
<div id="練習問題-5-15-実証" class="section level2 unnumbered hasAnchor">
<h2>練習問題 5-15 [実証]<a href="ch5.html#練習問題-5-15-実証" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>データはStataで用いられる<code>.dta</code>形式になっているが, これをRで読み込むには<code>haven::read_dta()</code>を使う.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="ch5.html#cb41-1" tabindex="-1"></a>timss <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;data/05_第5章/timss.dta&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="ch5.html#cb42-1" tabindex="-1"></a>practice5_15_a <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(mathscore <span class="sc">~</span> agese_q2 <span class="sc">+</span> agese_q3 <span class="sc">+</span> agese_q4, <span class="at">data =</span> timss, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb42-2"><a href="ch5.html#cb42-2" tabindex="-1"></a>practice5_15_c <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(mathscore <span class="sc">~</span> gender<span class="sc">*</span>agese_q2 <span class="sc">+</span> gender<span class="sc">*</span>agese_q3 <span class="sc">+</span> gender<span class="sc">*</span>agese_q4, <span class="at">data =</span> timss, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb42-3"><a href="ch5.html#cb42-3" tabindex="-1"></a>practice5_15_d <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(mathscore <span class="sc">~</span> agese_q2 <span class="sc">+</span> agese_q3 <span class="sc">+</span> agese_q4 <span class="sc">+</span> comu_1 <span class="sc">+</span> comu_2 <span class="sc">+</span> comu_3 <span class="sc">+</span> comu_4 <span class="sc">+</span> comu_5 <span class="sc">+</span> computer <span class="sc">+</span> numpeople <span class="sc">+</span> mothereduc_1 <span class="sc">+</span> mothereduc_2 <span class="sc">+</span> mothereduc_3 <span class="sc">+</span> mothereduc_4 <span class="sc">+</span> mothereduc_5 <span class="sc">+</span> fathereduc_1 <span class="sc">+</span> fathereduc_2 <span class="sc">+</span> fathereduc_3 <span class="sc">+</span> fathereduc_4 <span class="sc">+</span> fathereduc_5, <span class="at">data =</span> timss, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb42-4"><a href="ch5.html#cb42-4" tabindex="-1"></a>practice5_15_ea <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(sciencescore <span class="sc">~</span> agese_q2 <span class="sc">+</span> agese_q3 <span class="sc">+</span> agese_q4, <span class="at">data =</span> timss, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb42-5"><a href="ch5.html#cb42-5" tabindex="-1"></a>practice5_15_ec <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(sciencescore <span class="sc">~</span> gender<span class="sc">*</span>agese_q2 <span class="sc">+</span> gender<span class="sc">*</span>agese_q3 <span class="sc">+</span> gender<span class="sc">*</span>agese_q4, <span class="at">data =</span> timss, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span>
<span id="cb42-6"><a href="ch5.html#cb42-6" tabindex="-1"></a>practice5_15_ed <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(sciencescore <span class="sc">~</span> agese_q2 <span class="sc">+</span> agese_q3 <span class="sc">+</span> agese_q4 <span class="sc">+</span> comu_1 <span class="sc">+</span> comu_2 <span class="sc">+</span> comu_3 <span class="sc">+</span> comu_4 <span class="sc">+</span> comu_5 <span class="sc">+</span> computer <span class="sc">+</span> numpeople <span class="sc">+</span> mothereduc_1 <span class="sc">+</span> mothereduc_2 <span class="sc">+</span> mothereduc_3 <span class="sc">+</span> mothereduc_4 <span class="sc">+</span> mothereduc_5 <span class="sc">+</span> fathereduc_1 <span class="sc">+</span> fathereduc_2 <span class="sc">+</span> fathereduc_3 <span class="sc">+</span> fathereduc_4 <span class="sc">+</span> fathereduc_5, <span class="at">data =</span> timss, <span class="at">se_type =</span> <span class="st">&quot;stata&quot;</span>)</span></code></pre></div>
<p>結果を<code>modelsummary</code>で表にまとめる. (d)で用いるダミー変数は<code>coef_map</code>で指定して表示を省略している.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ch5.html#cb43-1" tabindex="-1"></a>models_5_15 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb43-2"><a href="ch5.html#cb43-2" tabindex="-1"></a>models_5_15[[<span class="st">&#39;a&#39;</span>]] <span class="ot">&lt;-</span> practice5_15_a</span>
<span id="cb43-3"><a href="ch5.html#cb43-3" tabindex="-1"></a>models_5_15[[<span class="st">&#39;c&#39;</span>]] <span class="ot">&lt;-</span> practice5_15_c</span>
<span id="cb43-4"><a href="ch5.html#cb43-4" tabindex="-1"></a>models_5_15[[<span class="st">&#39;d&#39;</span>]] <span class="ot">&lt;-</span> practice5_15_d</span>
<span id="cb43-5"><a href="ch5.html#cb43-5" tabindex="-1"></a>models_5_15[[<span class="st">&#39;ea&#39;</span>]] <span class="ot">&lt;-</span> practice5_15_ea</span>
<span id="cb43-6"><a href="ch5.html#cb43-6" tabindex="-1"></a>models_5_15[[<span class="st">&#39;ec&#39;</span>]] <span class="ot">&lt;-</span> practice5_15_ec</span>
<span id="cb43-7"><a href="ch5.html#cb43-7" tabindex="-1"></a>models_5_15[[<span class="st">&#39;ed&#39;</span>]] <span class="ot">&lt;-</span> practice5_15_ed</span>
<span id="cb43-8"><a href="ch5.html#cb43-8" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;agese_q2&quot;</span>,</span>
<span id="cb43-9"><a href="ch5.html#cb43-9" tabindex="-1"></a>        <span class="st">&quot;agese_q3&quot;</span>,</span>
<span id="cb43-10"><a href="ch5.html#cb43-10" tabindex="-1"></a>        <span class="st">&quot;agese_q4&quot;</span>,</span>
<span id="cb43-11"><a href="ch5.html#cb43-11" tabindex="-1"></a>        <span class="st">&quot;gender&quot;</span>,</span>
<span id="cb43-12"><a href="ch5.html#cb43-12" tabindex="-1"></a>        <span class="st">&quot;gender:agese_q2&quot;</span>,</span>
<span id="cb43-13"><a href="ch5.html#cb43-13" tabindex="-1"></a>        <span class="st">&quot;gender:agese_q3&quot;</span>,</span>
<span id="cb43-14"><a href="ch5.html#cb43-14" tabindex="-1"></a>        <span class="st">&quot;gender:agese_q4&quot;</span>,</span>
<span id="cb43-15"><a href="ch5.html#cb43-15" tabindex="-1"></a>        <span class="st">&quot;(Intercept)&quot;</span>)</span>
<span id="cb43-16"><a href="ch5.html#cb43-16" tabindex="-1"></a>gm <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb43-17"><a href="ch5.html#cb43-17" tabindex="-1"></a>    <span class="sc">~</span>raw,            <span class="sc">~</span>clean,           <span class="sc">~</span>fmt,</span>
<span id="cb43-18"><a href="ch5.html#cb43-18" tabindex="-1"></a>    <span class="st">&quot;adj.r.squared&quot;</span>, <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">bar{R}^2$&quot;</span>,   <span class="dv">2</span>,</span>
<span id="cb43-19"><a href="ch5.html#cb43-19" tabindex="-1"></a>    <span class="st">&quot;nobs&quot;</span>,          <span class="st">&quot;サンプルサイズ&quot;</span>, <span class="dv">0</span>)</span>
<span id="cb43-20"><a href="ch5.html#cb43-20" tabindex="-1"></a><span class="fu">msummary</span>(models_5_15,</span>
<span id="cb43-21"><a href="ch5.html#cb43-21" tabindex="-1"></a>         <span class="at">coef_map =</span> cm,</span>
<span id="cb43-22"><a href="ch5.html#cb43-22" tabindex="-1"></a>         <span class="at">gof_map =</span> gm,</span>
<span id="cb43-23"><a href="ch5.html#cb43-23" tabindex="-1"></a>         <span class="at">stars =</span> <span class="fu">c</span>(<span class="st">&quot;*&quot;</span> <span class="ot">=</span> <span class="fl">0.05</span>, <span class="st">&quot;**&quot;</span> <span class="ot">=</span> <span class="fl">0.01</span>, <span class="st">&quot;***&quot;</span> <span class="ot">=</span> <span class="fl">0.001</span>),</span>
<span id="cb43-24"><a href="ch5.html#cb43-24" tabindex="-1"></a>         <span class="at">estimate =</span> <span class="st">&quot;{estimate}{stars}&quot;</span>,</span>
<span id="cb43-25"><a href="ch5.html#cb43-25" tabindex="-1"></a>         <span class="at">output =</span> <span class="st">&quot;kableExtra&quot;</span>,</span>
<span id="cb43-26"><a href="ch5.html#cb43-26" tabindex="-1"></a>         <span class="at">notes =</span> <span class="st">&quot;* p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-27"><a href="ch5.html#cb43-27" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">18</span>), <span class="at">extra_css =</span> <span class="st">&quot;border-bottom: 1.5px solid&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-28"><a href="ch5.html#cb43-28" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="dv">16</span>, <span class="at">extra_css =</span> <span class="st">&quot;;border-bottom: 1.5px solid&quot;</span>) <span class="co"># 16行目の下 (estimateとstatisticsの境) のみコロンが必要</span></span></code></pre></div>
<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table">
<thead>
<tr>
<th style="text-align:left;border-bottom: 1.5px solid">
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
a
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
c
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
d
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
ea
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
ec
</th>
<th style="text-align:center;border-bottom: 1.5px solid">
ed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
agese_q2
</td>
<td style="text-align:center;">
0.174
</td>
<td style="text-align:center;">
−0.500
</td>
<td style="text-align:center;">
0.218
</td>
<td style="text-align:center;">
0.261
</td>
<td style="text-align:center;">
0.006
</td>
<td style="text-align:center;">
0.317
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.412)
</td>
<td style="text-align:center;">
(1.282)
</td>
<td style="text-align:center;">
(0.394)
</td>
<td style="text-align:center;">
(0.420)
</td>
<td style="text-align:center;">
(1.302)
</td>
<td style="text-align:center;">
(0.406)
</td>
</tr>
<tr>
<td style="text-align:left;">
agese_q3
</td>
<td style="text-align:center;">
−0.346
</td>
<td style="text-align:center;">
−1.516
</td>
<td style="text-align:center;">
−0.460
</td>
<td style="text-align:center;">
−0.543
</td>
<td style="text-align:center;">
−1.274
</td>
<td style="text-align:center;">
−0.614
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.415)
</td>
<td style="text-align:center;">
(1.291)
</td>
<td style="text-align:center;">
(0.395)
</td>
<td style="text-align:center;">
(0.419)
</td>
<td style="text-align:center;">
(1.274)
</td>
<td style="text-align:center;">
(0.406)
</td>
</tr>
<tr>
<td style="text-align:left;">
agese_q4
</td>
<td style="text-align:center;">
−1.558***
</td>
<td style="text-align:center;">
−2.935*
</td>
<td style="text-align:center;">
−1.336***
</td>
<td style="text-align:center;">
−1.717***
</td>
<td style="text-align:center;">
−1.963
</td>
<td style="text-align:center;">
−1.522***
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.419)
</td>
<td style="text-align:center;">
(1.289)
</td>
<td style="text-align:center;">
(0.403)
</td>
<td style="text-align:center;">
(0.428)
</td>
<td style="text-align:center;">
(1.312)
</td>
<td style="text-align:center;">
(0.413)
</td>
</tr>
<tr>
<td style="text-align:left;">
gender
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
−0.137
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
1.031
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.586)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.611)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
gender:agese_q2
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.445
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.147
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.824)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.840)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
gender:agese_q3
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.783
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.487
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.830)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.839)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
gender:agese_q4
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.920
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.160
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.839)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.856)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
150.363***
</td>
<td style="text-align:center;">
150.568***
</td>
<td style="text-align:center;">
146.798***
</td>
<td style="text-align:center;">
150.453***
</td>
<td style="text-align:center;">
148.915***
</td>
<td style="text-align:center;">
150.811***
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.293)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.908)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(2.392)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.305)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(0.923)
</td>
<td style="text-align:center;box-shadow: 0px 1.5px;border-bottom: 1.5px solid">
(1.884)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\bar{R}^2\)</span>
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.09
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.01
</td>
<td style="text-align:center;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;border-bottom: 1.5px solid">
サンプルサイズ
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
4536
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
4536
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
4536
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
4536
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
4536
</td>
<td style="text-align:center;border-bottom: 1.5px solid">
4536
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> * p &amp;lt; 0.05, ** p &amp;lt; 0.01, *** p &amp;lt; 0.001
</td>
</tr>
</tfoot>
</table>
<ol style="list-style-type: lower-alpha">
<li><p>上の表のa式を見ると, <code>agese_q4</code>の係数は有意に負であることがわかる. つまり, この結果では早生まれの人の成績は4月から6月に生まれた人に比べて低いといえる.</p></li>
<li><p>生まれた四半期のダミー変数を4つすべて含むと, ダミー変数の罠に陥る. 4月から6月に生まれた人を表すダミー変数を使用する場合, 定数項なしの回帰を行うことでダミー変数の罠を避けられる. 4月から6月に生まれた人, 早生まれの人を表すダミー変数の係数をそれぞれ<span class="math inline">\(\beta_{Q1}, \beta_{Q4}\)</span>とおくと, 帰無仮説は<span class="math inline">\(H_0: \beta_{Q4} &lt; \beta_{Q1}\)</span>とすればよい.</p></li>
<li><p>上の表のc式を見ると, <code>gender</code>とそれを含む交差項の係数はみな有意とは言えない. つまり, 早生まれの人の成績差に性別は関係がみられなかったとわかる.</p></li>
<li><p>上の表のd式を見ると, やはり<code>agese_q4</code>の係数は有意に負であることがわかる (表ではダミー変数の結果は省略している).</p></li>
<li><p>対応するモデルを上の表のea, ec, ed式に示す. ea, ed式においては<code>agese_q4</code>の係数はやはり有意に負であり,その大きさは数学に比べてわずかに大きい.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
