<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第11章 トレンドと構造変化 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現</title>
  <meta name="description" content="第11章 トレンドと構造変化 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="第11章 トレンドと構造変化 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="第11章 トレンドと構造変化 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第11章 トレンドと構造変化 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現" />
  
  <meta name="twitter:description" content="第11章 トレンドと構造変化 | 西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現." />
  

<meta name="author" content="石井 俊輔" />


<meta name="date" content="2025-02-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch10.html"/>
<link rel="next" href="ch12.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8R0S76ZD8E"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8R0S76ZD8E');
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
    Macros: {
      P: "{\\text{P}}",
      E: "{\\text{E}}",
      Var: "{\\text{Var}}",
      Cov: "{\\text{Cov}}",
      sumN: ["{\\sum_{#1=0}^N}", 1]
    }
  }
});
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">西山ほか(2019)『計量経済学』有斐閣の練習問題解答とRでの再現</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#方針"><i class="fa fa-check"></i>方針</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#似たようなサイト"><i class="fa fa-check"></i>似たようなサイト</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html"><i class="fa fa-check"></i>第2章 データの整理と確率変数の基礎</a>
<ul>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-1-確認"><i class="fa fa-check"></i>練習問題 2-1 [確認]</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-2-確認"><i class="fa fa-check"></i>練習問題 2-2 [確認]</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-3-確認"><i class="fa fa-check"></i>練習問題 2-3 [確認]</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-4-確認"><i class="fa fa-check"></i>練習問題 2-4 [確認]</a></li>
<li class="chapter" data-level="" data-path="ch2.html"><a href="ch2.html#練習問題-2-5-確認"><i class="fa fa-check"></i>練習問題 2-5 [確認]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html"><i class="fa fa-check"></i>第3章 統計理論の基礎</a>
<ul>
<li class="chapter" data-level="" data-path="ch3.html"><a href="ch3.html#練習問題-3-2-確認"><i class="fa fa-check"></i>練習問題 3-2 [確認]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html"><i class="fa fa-check"></i>第4章 線形単回帰モデルの推定と検定</a>
<ul>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#実証例4.1-労働生産性と実質賃金の関係"><i class="fa fa-check"></i>実証例4.1 労働生産性と実質賃金の関係</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#図4-1-時間当たり実質賃金と労働生産性"><i class="fa fa-check"></i>図4-1 時間当たり実質賃金と労働生産性</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#練習問題-4-2-実証"><i class="fa fa-check"></i>練習問題 4-2 [実証]</a></li>
<li class="chapter" data-level="" data-path="ch4.html"><a href="ch4.html#練習問題-4-10-実証"><i class="fa fa-check"></i>練習問題 4-10 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html"><i class="fa fa-check"></i>第5章 重回帰モデルの推定と検定</a>
<ul>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#単回帰-5.1-5.2"><i class="fa fa-check"></i>単回帰 (5.1), (5.2)</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#ex5.1"><i class="fa fa-check"></i>実証例5.1 信頼と規範が経済成長に与える影響の重回帰分析</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.2-fwl定理の確認"><i class="fa fa-check"></i>実証例5.2 FWL定理の確認</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.3-fwl定理の別表現の確認"><i class="fa fa-check"></i>実証例5.3 FWL定理の別表現の確認</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.4-信頼と規範が経済成長に与える影響の重回帰分析の標準誤差"><i class="fa fa-check"></i>実証例5.4 信頼と規範が経済成長に与える影響の重回帰分析の標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#ex5.5"><i class="fa fa-check"></i>実証例5.5 信頼と規範が経済成長に与える影響の多項式モデル</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#図5-1-散布図と推定された回帰曲線"><i class="fa fa-check"></i>図5-1 散布図と推定された回帰曲線</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#例題5.5"><i class="fa fa-check"></i>例題5.5</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.6-都市化の度合いと初期時点gdpの交互作用"><i class="fa fa-check"></i>実証例5.6 都市化の度合いと初期時点GDPの交互作用</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.7-都市化の度合いと初期時点gdpのダミー変数同士の交互作用"><i class="fa fa-check"></i>実証例5.7 都市化の度合いと初期時点GDPのダミー変数同士の交互作用</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.8-非線形モデルにおける結合仮説の検定"><i class="fa fa-check"></i>実証例5.8 非線形モデルにおける結合仮説の検定</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#実証例5.9-ポンフェローニ検定"><i class="fa fa-check"></i>実証例5.9 ポンフェローニ検定</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#table5-5"><i class="fa fa-check"></i>表5-5 記述統計量</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#table5-6"><i class="fa fa-check"></i>表5-6 推定結果: 被説明変数は経済成長率</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#表5-7-推定結果"><i class="fa fa-check"></i>表5-7 推定結果</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#練習問題-5-14-実証"><i class="fa fa-check"></i>練習問題 5-14 [実証]</a></li>
<li class="chapter" data-level="" data-path="ch5.html"><a href="ch5.html#練習問題-5-15-実証"><i class="fa fa-check"></i>練習問題 5-15 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i>第6章 パネルデータ分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#exp6.1"><i class="fa fa-check"></i>(6.1) 式</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#ex6.1"><i class="fa fa-check"></i>実証例6.1 保育所が母親の就業に与え影響の固定効果推定</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.2-保育所が母親の就業に与える影響の固定効果推定の標準誤差"><i class="fa fa-check"></i>実証例6.2 保育所が母親の就業に与える影響の固定効果推定の標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.3-保育所が母親の就業に与え影響のプールされたols推定の標準誤差"><i class="fa fa-check"></i>実証例6.3 保育所が母親の就業に与え影響のプールされたOLS推定の標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.4-保育所が母親の就業に与える影響の時間効果を入れた分析"><i class="fa fa-check"></i>実証例6.4 保育所が母親の就業に与える影響の時間効果を入れた分析</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.5-保育所が母親の就業に与える影響の都道府県効果と年効果を入れた分析"><i class="fa fa-check"></i>実証例6.5 保育所が母親の就業に与える影響の都道府県効果と年効果を入れた分析</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#実証例6.6-保育所が母親の就業に与える影響の個別トレンドと年効果を入れた分析"><i class="fa fa-check"></i>実証例6.6 保育所が母親の就業に与える影響の個別トレンドと年効果を入れた分析</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#table6-3"><i class="fa fa-check"></i>表6-3 記述統計量</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#表6-4-年ごとの記述統計量"><i class="fa fa-check"></i>表6-4 年ごとの記述統計量</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#table6-5"><i class="fa fa-check"></i>表6-5 推定結果</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#練習問題-6-10-実証"><i class="fa fa-check"></i>練習問題 6-10 [実証]</a></li>
<li class="chapter" data-level="" data-path="ch6.html"><a href="ch6.html#練習問題-6-11-実証"><i class="fa fa-check"></i>練習問題 6-11 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html"><i class="fa fa-check"></i>第7章 操作変数法</a>
<ul>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#ex7.1"><i class="fa fa-check"></i>実証例7.1 単回帰モデルの操作変数推定</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#実証例7.2-操作変数推定量の標準誤差"><i class="fa fa-check"></i>実証例7.2 操作変数推定量の標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#実証例7.3-19世紀プロイセンのデータの外生性を含めた2sls推定による分析"><i class="fa fa-check"></i>実証例7.3 19世紀プロイセンのデータの外生性を含めた2SLS推定による分析</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#実証例7.4-操作変数の強さの判定"><i class="fa fa-check"></i>実証例7.4 操作変数の強さの判定</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#実証例7.5-操作変数の外生性の検定"><i class="fa fa-check"></i>実証例7.5 操作変数の外生性の検定</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#表7-2-記述統計量"><i class="fa fa-check"></i>表7-2 記述統計量</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#table7-3"><i class="fa fa-check"></i>表7-3 推定結果</a></li>
<li class="chapter" data-level="" data-path="ch7.html"><a href="ch7.html#練習問題-7-13-実証"><i class="fa fa-check"></i>練習問題 7-13 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html"><i class="fa fa-check"></i>第8章 制限従属変数モデル</a>
<ul>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#実証例8.1-piaacを用いた女性の就業選択の実証例"><i class="fa fa-check"></i>実証例8.1 PIAACを用いた女性の就業選択の実証例</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#table8-1"><i class="fa fa-check"></i>表8-1 女性の就業決定</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#実証例8.2-piaacを用いた仕事満足度の決定要因の分析"><i class="fa fa-check"></i>実証例8.2 PIAACを用いた仕事満足度の決定要因の分析</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#実証例8.3-piaacを用いた就業形態決定要因の分析"><i class="fa fa-check"></i>実証例8.3 PIAACを用いた就業形態決定要因の分析</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#実証例8.4-piaacを用いた女性の労働時間決定の分析"><i class="fa fa-check"></i>実証例8.4 PIAACを用いた女性の労働時間決定の分析</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#ex8.5"><i class="fa fa-check"></i>実証例8.5 PIAACを用いた女性賃金の決定要因の分析</a></li>
<li class="chapter" data-level="" data-path="ch8.html"><a href="ch8.html#練習問題-8-4-実証"><i class="fa fa-check"></i>練習問題 8-4 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch9.html"><a href="ch9.html"><i class="fa fa-check"></i>第9章 政策評価モデル</a>
<ul>
<li class="chapter" data-level="" data-path="ch9.html"><a href="ch9.html#figure9-5"><i class="fa fa-check"></i>図9-5 電子投票制度の導入が有効票率に与えた影響</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html"><i class="fa fa-check"></i>第10章 系列相関と時系列モデル</a>
<ul>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#figure10-1"><i class="fa fa-check"></i>図10-1 名目GDP</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-2-gdpデフレーター"><i class="fa fa-check"></i>図10-2 GDPデフレーター</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#figure10-3"><i class="fa fa-check"></i>図10-3 名目系列と実質系列</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-4-原系列と対数系列"><i class="fa fa-check"></i>図10-4 原系列と対数系列</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-5-gdpギャップ-年次データ"><i class="fa fa-check"></i>図10-5 GDPギャップ (年次データ)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-6-実質gdp成長率"><i class="fa fa-check"></i>図10-6 実質GDP成長率</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-7-実質gdp-公表季調値"><i class="fa fa-check"></i>図10-7 実質GDP (公表季調値)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-8-季調済みgdpデフレーターのインフレ率"><i class="fa fa-check"></i>図10-8 季調済みGDPデフレーターのインフレ率</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#figure10-9"><i class="fa fa-check"></i>図10-9 消費者物価指数の (対数季節階差) インフレ率</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-10-完全失業率-移動平均"><i class="fa fa-check"></i>図10-10 完全失業率 (移動平均)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#figure10-11"><i class="fa fa-check"></i>図10-11 実験系列</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#figure10-12"><i class="fa fa-check"></i>図10-12 GDPギャップ (四半期データ)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#exp10.12"><i class="fa fa-check"></i>(10.12) 式</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#式"><i class="fa fa-check"></i>(10.13) 式</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-14-gdpギャップのコレログラム"><i class="fa fa-check"></i>図10-14 GDPギャップのコレログラム</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#ex10.1"><i class="fa fa-check"></i>実証例10.1 GDPギャップの系列相関</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#実証例10.2-ホワイトノイズの系列相関"><i class="fa fa-check"></i>実証例10.2 ホワイトノイズの系列相関</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-15-実験系列-ホワイトノイズ-のコレログラム"><i class="fa fa-check"></i>図10-15 実験系列 (ホワイトノイズ) のコレログラム</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#実証例10.3-フィリップス曲線の誤差項の系列相関"><i class="fa fa-check"></i>実証例10.3 フィリップス曲線の誤差項の系列相関</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#ex10.4"><i class="fa fa-check"></i>実証例10.4 フィリップス曲線のHAC標準誤差</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#実証例10.5-gdpギャップのarモデルのラグ選択"><i class="fa fa-check"></i>実証例10.5 GDPギャップのARモデルのラグ選択</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#ex10.6"><i class="fa fa-check"></i>実証例10.6 ラグ付きインフレ率を含むフィリップス曲線の推定と誤差項の系列相関の検定</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#図10-16-東証株価指数-対数階差収益率"><i class="fa fa-check"></i>図10-16 東証株価指数 (対数階差収益率)</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#ex10.7"><i class="fa fa-check"></i>実証例10.7 ARCHモデルとGARCHモデルの推定</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#exp10.69"><i class="fa fa-check"></i>(10.69) 式</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#exp10.70"><i class="fa fa-check"></i>(10.70) 式</a></li>
<li class="chapter" data-level="" data-path="ch10.html"><a href="ch10.html#練習問題-10-10-実証"><i class="fa fa-check"></i>練習問題 10-10 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html"><i class="fa fa-check"></i>第11章 トレンドと構造変化</a>
<ul>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#exp11.3"><i class="fa fa-check"></i>(11.3) 式</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#図11-1-対数実質gdpと線形トレンド"><i class="fa fa-check"></i>図11-1 対数実質GDPと線形トレンド</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#図11-2-対数実質gdpの長期系列"><i class="fa fa-check"></i>図11-2 対数実質GDPの長期系列</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#図11-3-hpフィルターのトレンド成分"><i class="fa fa-check"></i>図11-3 HPフィルターのトレンド成分</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#図11-4-gdpギャップ推定値の比較"><i class="fa fa-check"></i>図11-4 GDPギャップ推定値の比較</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#実証例11.1-gdpの線形トレンドモデル推定"><i class="fa fa-check"></i>実証例11.1 GDPの線形トレンド・モデル推定</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#実証例11.2-為替レートの単位根検定"><i class="fa fa-check"></i>実証例11.2 為替レートの単位根検定</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#図11-6-円ドルレート"><i class="fa fa-check"></i>図11-6 円ドルレート</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#実証例11.3-インフレ率の単位根検定"><i class="fa fa-check"></i>実証例11.3 インフレ率の単位根検定</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#実証例11.3-インフレ率の単位根検定-1"><i class="fa fa-check"></i>実証例11.3 インフレ率の単位根検定</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#実証例11.4-ランダムウォーク型のトレンドインフレ率の推定"><i class="fa fa-check"></i>実証例11.4 ランダムウォーク型のトレンド・インフレ率の推定</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#図11-8-bn分解とランダムウォーク型トレンドインフレ率"><i class="fa fa-check"></i>図11-8 BN分解とランダムウォーク型トレンド・インフレ率</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#実証例11.5-水準シフト型のトレンドインフレ率推定と構造変化検定"><i class="fa fa-check"></i>実証例11.5 水準シフト型のトレンド・インフレ率推定と構造変化検定</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#図11-9-トレンドインフレ率水準の構造変化-ワルド統計量"><i class="fa fa-check"></i>図11-9 トレンド・インフレ率水準の構造変化 (ワルド統計量)</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#図11-10-水準シフト型トレンドインフレ率"><i class="fa fa-check"></i>図11-10 水準シフト型トレンド・インフレ率</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#練習問題-11-8-実証"><i class="fa fa-check"></i>練習問題 11-8 [実証]</a></li>
<li class="chapter" data-level="" data-path="ch11.html"><a href="ch11.html#練習問題-11-9-実証"><i class="fa fa-check"></i>練習問題 11-9 [実証]</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch12.html"><a href="ch12.html"><i class="fa fa-check"></i>第12章 VARモデル</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">西山ほか (2019)『計量経済学』有斐閣の練習問題解答とRでの再現</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch11" class="section level1 unnumbered hasAnchor">
<h1>第11章 トレンドと構造変化<a href="ch11.html#ch11" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>先に<a href="https://www.yuhikaku.co.jp/books/detail/9784641053854">出版社サイト</a>よりデータをダウンロードする.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="ch11.html#cb137-1" tabindex="-1"></a><span class="co"># サポートファイルへのリンク</span></span>
<span id="cb137-2"><a href="ch11.html#cb137-2" tabindex="-1"></a>curl <span class="ot">&lt;-</span> <span class="st">&quot;https://www.yuhikaku.co.jp/static_files/05385_support11.zip&quot;</span></span>
<span id="cb137-3"><a href="ch11.html#cb137-3" tabindex="-1"></a><span class="co"># ダウンロード保存用フォルダが存在しない場合, 作成</span></span>
<span id="cb137-4"><a href="ch11.html#cb137-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;downloads&quot;</span>)){</span>
<span id="cb137-5"><a href="ch11.html#cb137-5" tabindex="-1"></a>    <span class="fu">dir.create</span>(<span class="st">&quot;downloads&quot;</span>)</span>
<span id="cb137-6"><a href="ch11.html#cb137-6" tabindex="-1"></a>}</span>
<span id="cb137-7"><a href="ch11.html#cb137-7" tabindex="-1"></a>cdestfile <span class="ot">&lt;-</span> <span class="st">&quot;downloads/support11.zip&quot;</span></span>
<span id="cb137-8"><a href="ch11.html#cb137-8" tabindex="-1"></a><span class="fu">download.file</span>(curl, cdestfile)</span>
<span id="cb137-9"><a href="ch11.html#cb137-9" tabindex="-1"></a><span class="co"># データ保存用フォルダが存在しない場合, 作成</span></span>
<span id="cb137-10"><a href="ch11.html#cb137-10" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;data&quot;</span>)){</span>
<span id="cb137-11"><a href="ch11.html#cb137-11" tabindex="-1"></a>    <span class="fu">dir.create</span>(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb137-12"><a href="ch11.html#cb137-12" tabindex="-1"></a>}</span>
<span id="cb137-13"><a href="ch11.html#cb137-13" tabindex="-1"></a><span class="co"># WSL上のRで解凍すると文字化けするので、Linuxのコマンドを外部呼び出し</span></span>
<span id="cb137-14"><a href="ch11.html#cb137-14" tabindex="-1"></a><span class="co"># Windowsの場合は別途コマンドを用いる.</span></span>
<span id="cb137-15"><a href="ch11.html#cb137-15" tabindex="-1"></a><span class="cf">if</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">&quot;unix&quot;</span>) {</span>
<span id="cb137-16"><a href="ch11.html#cb137-16" tabindex="-1"></a>    <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&#39;unzip -n -Ocp932 %s -d %s&#39;</span>, <span class="st">&quot;downloads/support11.zip&quot;</span>, <span class="st">&quot;./data&quot;</span>))</span>
<span id="cb137-17"><a href="ch11.html#cb137-17" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb137-18"><a href="ch11.html#cb137-18" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Windowsで解凍するコマンドを別途追加せよ.&quot;</span>)</span>
<span id="cb137-19"><a href="ch11.html#cb137-19" tabindex="-1"></a>}</span></code></pre></div>
<p>必要なライブラリを読み込む.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="ch11.html#cb138-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb138-2"><a href="ch11.html#cb138-2" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb138-3"><a href="ch11.html#cb138-3" tabindex="-1"></a><span class="fu">library</span>(estatapi)</span>
<span id="cb138-4"><a href="ch11.html#cb138-4" tabindex="-1"></a><span class="fu">library</span>(hpfilter)</span>
<span id="cb138-5"><a href="ch11.html#cb138-5" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb138-6"><a href="ch11.html#cb138-6" tabindex="-1"></a><span class="fu">library</span>(tsm)</span>
<span id="cb138-7"><a href="ch11.html#cb138-7" tabindex="-1"></a><span class="fu">library</span>(fredr)</span>
<span id="cb138-8"><a href="ch11.html#cb138-8" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span></code></pre></div>
<div id="exp11.3" class="section level2 unnumbered hasAnchor">
<h2>(11.3) 式<a href="ch11.html#exp11.3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>データは前章<a href="ch10.html#figure10-3">図10-3</a>図10-3で用いたものを使う.
本文中にある通りデータの期間を1991年から1997年に絞り込み, さらにトレンド用の変数を作成する.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="ch11.html#cb139-1" tabindex="-1"></a>Fig_1_nominalGDP_annual <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;./data/10_第10章/Fig_1_nominalGDP_annual.xlsx&quot;</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...1`</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="ch11.html#cb141-1" tabindex="-1"></a>data_exp11<span class="fl">.3</span> <span class="ot">&lt;-</span> Fig_1_nominalGDP_annual <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="ch11.html#cb141-2" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="dv">1991</span> <span class="sc">&lt;=</span> ...<span class="dv">1</span> <span class="sc">&amp;</span> ...<span class="dv">1</span> <span class="sc">&lt;=</span> <span class="dv">2017</span>)</span>
<span id="cb141-3"><a href="ch11.html#cb141-3" tabindex="-1"></a>data_exp11<span class="fl">.3</span> <span class="ot">&lt;-</span> data_exp11<span class="fl">.3</span> <span class="sc">%&gt;%</span></span>
<span id="cb141-4"><a href="ch11.html#cb141-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trend =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data_exp11<span class="fl">.3</span>)[<span class="dv">1</span>])</span>
<span id="cb141-5"><a href="ch11.html#cb141-5" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">log</span>(実質暦年) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">~</span> trend, <span class="at">data =</span> data_exp11<span class="fl">.3</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(実質暦年) * 100 ~ trend, data = data_exp11.3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.4861 -0.9720 -0.3222  1.3159  3.8803 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.295e+03  7.527e-01 1720.39  &lt; 2e-16 ***
## trend       8.491e-01  4.698e-02   18.07 7.26e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.901 on 25 degrees of freedom
## Multiple R-squared:  0.9289, Adjusted R-squared:  0.9261 
## F-statistic: 326.7 on 1 and 25 DF,  p-value: 7.259e-16</code></pre>
</div>
<div id="図11-1-対数実質gdpと線形トレンド" class="section level2 unnumbered hasAnchor">
<h2>図11-1 対数実質GDPと線形トレンド<a href="ch11.html#図11-1-対数実質gdpと線形トレンド" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="ch11.html#exp11.3">(11.3) 式</a>に続いてggplotでグラフを描画する.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="ch11.html#cb143-1" tabindex="-1"></a>data_exp11<span class="fl">.3</span> <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="ch11.html#cb143-2" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ...<span class="dv">1</span>, <span class="at">y =</span> <span class="fu">log</span>(実質暦年) <span class="sc">*</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb143-3"><a href="ch11.html#cb143-3" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;線形トレンド (OLS推定値)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb143-4"><a href="ch11.html#cb143-4" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;対数実質GDP&quot;</span>)) <span class="sc">+</span></span>
<span id="cb143-5"><a href="ch11.html#cb143-5" tabindex="-1"></a>    <span class="fu">scale_color_hue</span>(<span class="at">name =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb143-6"><a href="ch11.html#cb143-6" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;年&quot;</span>, <span class="at">y =</span> <span class="st">&quot;対数実質GDP x 100&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-7"><a href="ch11.html#cb143-7" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span> <span class="co"># 凡例を左上に表示</span></span>
<span id="cb143-8"><a href="ch11.html#cb143-8" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>())</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
</div>
<div id="図11-2-対数実質gdpの長期系列" class="section level2 unnumbered hasAnchor">
<h2>図11-2 対数実質GDPの長期系列<a href="ch11.html#図11-2-対数実質gdpの長期系列" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>内閣府のサイトには, GDPデータ自体は1955年から掲載されているが, 現在に至るまで幾度か基準が変更されたため異なる体型基準年間でデータが直接接続しない旨注意が記載されている(<a href="https://www.esri.cao.go.jp/jp/sna/otoiawase/faq/qa2.html" class="uri">https://www.esri.cao.go.jp/jp/sna/otoiawase/faq/qa2.html</a>).</p>
<p>まずは1990基準により計算された, 1955～1998年の実質国民総支出データをダウンロードする.
この基準では, 1979年までの数値を用いる.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="ch11.html#cb145-1" tabindex="-1"></a>curl <span class="ot">&lt;-</span> <span class="st">&quot;https://www.esri.cao.go.jp/jp/sna/data/data_list/kakuhou/files/h10/tables/55fcm1r.xls&quot;</span></span>
<span id="cb145-2"><a href="ch11.html#cb145-2" tabindex="-1"></a>cdestfile <span class="ot">&lt;-</span> <span class="st">&quot;downloads/55fcm1r.xls&quot;</span></span>
<span id="cb145-3"><a href="ch11.html#cb145-3" tabindex="-1"></a><span class="fu">download.file</span>(curl, cdestfile)</span></code></pre></div>
<p>1980年以降のデータは, <a href="#figure10-7">図10-7</a>と同じ手順でe-Statからダウンロードする.
それぞれ2000基準のデータを1980～1993年, それ以降は2015基準のを用いる.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="ch11.html#cb146-1" tabindex="-1"></a>appId <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">&quot;e-stat_appId.txt&quot;</span>, <span class="at">what =</span> <span class="st">&quot;character&quot;</span>)</span>
<span id="cb146-2"><a href="ch11.html#cb146-2" tabindex="-1"></a>fig11_2_data_h12 <span class="ot">&lt;-</span> <span class="fu">estat_getStatsData</span>(<span class="at">appId =</span> appId, <span class="at">statsDataId =</span> <span class="st">&quot;0003398787&quot;</span>)</span>
<span id="cb146-3"><a href="ch11.html#cb146-3" tabindex="-1"></a>fig11_2_data_h12 <span class="ot">&lt;-</span> fig11_2_data_h12 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">国内総生産(支出側)項目(平成12年基準)</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&quot;５．国内総生産（支出側）&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb146-4"><a href="ch11.html#cb146-4" tabindex="-1"></a>                            表章項目 <span class="sc">==</span> <span class="st">&quot;金額&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb146-5"><a href="ch11.html#cb146-5" tabindex="-1"></a>                            time_code <span class="sc">&lt;=</span> <span class="st">&quot;1993000000&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb146-6"><a href="ch11.html#cb146-6" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">select</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb146-7"><a href="ch11.html#cb146-7" tabindex="-1"></a>                        <span class="fu">rename</span>(<span class="st">&quot;実質国内総支出&quot;</span> <span class="ot">=</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb146-8"><a href="ch11.html#cb146-8" tabindex="-1"></a>                        <span class="fu">mutate</span>(年 <span class="ot">=</span> <span class="dv">1980</span><span class="sc">:</span><span class="dv">1993</span>)</span>
<span id="cb146-9"><a href="ch11.html#cb146-9" tabindex="-1"></a>fig11_2_data_2015 <span class="ot">&lt;-</span> <span class="fu">estat_getStatsData</span>(<span class="at">appId =</span> appId, <span class="at">statsDataId =</span> <span class="st">&quot;0003109751&quot;</span>)</span>
<span id="cb146-10"><a href="ch11.html#cb146-10" tabindex="-1"></a>fig11_2_data_2015 <span class="ot">&lt;-</span> fig11_2_data_2015 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(国内総生産_実質暦年 <span class="sc">==</span> <span class="st">&quot;国内総生産(支出側)&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb146-11"><a href="ch11.html#cb146-11" tabindex="-1"></a>                            表章項目 <span class="sc">==</span> <span class="st">&quot;金額&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb146-12"><a href="ch11.html#cb146-12" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">select</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb146-13"><a href="ch11.html#cb146-13" tabindex="-1"></a>                        <span class="fu">rename</span>(<span class="st">&quot;実質国内総支出&quot;</span> <span class="ot">=</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb146-14"><a href="ch11.html#cb146-14" tabindex="-1"></a>                        <span class="fu">mutate</span>(年 <span class="ot">=</span> <span class="dv">1994</span><span class="sc">:</span><span class="dv">2023</span>)</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="ch11.html#cb147-1" tabindex="-1"></a>fig11_2_data_55fcm1r <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;downloads/55fcm1r.xls&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;実数&quot;</span>)</span>
<span id="cb147-2"><a href="ch11.html#cb147-2" tabindex="-1"></a>fig11_2_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(実質国内総支出 <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">t</span>(fig11_2_data_55fcm1r[<span class="dv">35</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">26</span>]))) <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="ch11.html#cb147-3" tabindex="-1"></a>    <span class="fu">remove_rownames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-4"><a href="ch11.html#cb147-4" tabindex="-1"></a>    <span class="fu">mutate</span>(年 <span class="ot">=</span> <span class="dv">1955</span><span class="sc">:</span><span class="dv">1979</span>)</span>
<span id="cb147-5"><a href="ch11.html#cb147-5" tabindex="-1"></a></span>
<span id="cb147-6"><a href="ch11.html#cb147-6" tabindex="-1"></a>fig11_2_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(fig11_2_data, fig11_2_data_h12) <span class="sc">%&gt;%</span></span>
<span id="cb147-7"><a href="ch11.html#cb147-7" tabindex="-1"></a>                    <span class="fu">bind_rows</span>(fig11_2_data_2015)</span>
<span id="cb147-8"><a href="ch11.html#cb147-8" tabindex="-1"></a></span>
<span id="cb147-9"><a href="ch11.html#cb147-9" tabindex="-1"></a>fig11_2_data <span class="sc">%&gt;%</span></span>
<span id="cb147-10"><a href="ch11.html#cb147-10" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 年, <span class="at">y =</span> <span class="fu">log</span>(実質国内総支出) <span class="sc">*</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb147-11"><a href="ch11.html#cb147-11" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
</div>
<div id="図11-3-hpフィルターのトレンド成分" class="section level2 unnumbered hasAnchor">
<h2>図11-3 HPフィルターのトレンド成分<a href="ch11.html#図11-3-hpフィルターのトレンド成分" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>HPフィルターはRでは<code>hpfilter</code>というパッケージで実装されている.
データフレーム形式の時系列データ<code>y</code>のトレンド成分を求めるには, <code>hpfilter::hp1(y, lambda = lambda)</code>とすればよい.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="ch11.html#cb148-1" tabindex="-1"></a>fig11_3_data_trend <span class="ot">&lt;-</span> fig11_2_data <span class="sc">%&gt;%</span></span>
<span id="cb148-2"><a href="ch11.html#cb148-2" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(実質国内総支出) <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="ch11.html#cb148-3" tabindex="-1"></a>    <span class="fu">hp1</span>(<span class="at">lambda =</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-4"><a href="ch11.html#cb148-4" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">&quot;トレンド成分&quot;</span> <span class="ot">=</span> 実質国内総支出)</span>
<span id="cb148-5"><a href="ch11.html#cb148-5" tabindex="-1"></a>fig11_3_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(fig11_2_data, fig11_3_data_trend)</span>
<span id="cb148-6"><a href="ch11.html#cb148-6" tabindex="-1"></a>fig11_3_data <span class="sc">%&gt;%</span></span>
<span id="cb148-7"><a href="ch11.html#cb148-7" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;実質国内総支出&quot;</span>, <span class="st">&quot;トレンド成分&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-8"><a href="ch11.html#cb148-8" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 年, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb148-9"><a href="ch11.html#cb148-9" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb148-10"><a href="ch11.html#cb148-10" tabindex="-1"></a>    <span class="fu">scale_color_hue</span>(<span class="at">name =</span> <span class="fu">element_blank</span>(), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;トレンド成分&quot;</span>, <span class="st">&quot;GDP&quot;</span>)) <span class="sc">+</span></span>
<span id="cb148-11"><a href="ch11.html#cb148-11" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb148-12"><a href="ch11.html#cb148-12" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
</div>
<div id="図11-4-gdpギャップ推定値の比較" class="section level2 unnumbered hasAnchor">
<h2>図11-4 GDPギャップ推定値の比較<a href="ch11.html#図11-4-gdpギャップ推定値の比較" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>内閣府によるデータは<a href="ch10.html#figure10-12">図10-12</a>で用いたものを使う.
ただし観測頻度を四半期ごとから年次にするため, 一度<code>ts</code>形式にしたうえで<code>aggregate()</code>を用いて変換する.</p>
<p>線形トレンド回帰は, 本文中にある通り1990年より前か否かを示すダミー変数を作って推定した.</p>
<p>またHPフィルターは, ここでは<code>lambda = 6.25</code>とした.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="ch11.html#cb149-1" tabindex="-1"></a>Fig_12_GDPgap_quarterly <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;./data/10_第10章/Fig_12_GDPgap_quarterly.xlsx&quot;</span>)</span>
<span id="cb149-2"><a href="ch11.html#cb149-2" tabindex="-1"></a>fig11_4_data <span class="ot">&lt;-</span> Fig_12_GDPgap_quarterly <span class="sc">%&gt;%</span></span>
<span id="cb149-3"><a href="ch11.html#cb149-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(内閣府) <span class="sc">%&gt;%</span></span>
<span id="cb149-4"><a href="ch11.html#cb149-4" tabindex="-1"></a>    <span class="fu">ts</span>(<span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb149-5"><a href="ch11.html#cb149-5" tabindex="-1"></a>    <span class="fu">aggregate</span>(<span class="at">nfrequency =</span> <span class="dv">1</span>, <span class="at">FUN =</span> mean) <span class="sc">%&gt;%</span></span>
<span id="cb149-6"><a href="ch11.html#cb149-6" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb149-7"><a href="ch11.html#cb149-7" tabindex="-1"></a>    <span class="fu">cbind</span>(年 <span class="ot">=</span> <span class="dv">1980</span><span class="sc">:</span><span class="dv">2017</span>)</span>
<span id="cb149-8"><a href="ch11.html#cb149-8" tabindex="-1"></a></span>
<span id="cb149-9"><a href="ch11.html#cb149-9" tabindex="-1"></a>fig11_4_data <span class="ot">&lt;-</span> fig11_2_data <span class="sc">%&gt;%</span></span>
<span id="cb149-10"><a href="ch11.html#cb149-10" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="dv">1980</span> <span class="sc">&lt;=</span> 年 <span class="sc">&amp;</span> 年 <span class="sc">&lt;=</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span></span>
<span id="cb149-11"><a href="ch11.html#cb149-11" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(実質国内総支出) <span class="sc">%&gt;%</span></span>
<span id="cb149-12"><a href="ch11.html#cb149-12" tabindex="-1"></a>    <span class="fu">cbind</span>(fig11_4_data) <span class="sc">%&gt;%</span></span>
<span id="cb149-13"><a href="ch11.html#cb149-13" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trend =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(fig11_4_data)[<span class="dv">1</span>],</span>
<span id="cb149-14"><a href="ch11.html#cb149-14" tabindex="-1"></a>           <span class="at">pre1990 =</span> 年 <span class="sc">&lt;</span> <span class="dv">1990</span>)</span>
<span id="cb149-15"><a href="ch11.html#cb149-15" tabindex="-1"></a>fig11_4_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(実質国内総支出) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">~</span> trend <span class="sc">*</span> pre1990, <span class="at">data =</span> fig11_4_data)</span>
<span id="cb149-16"><a href="ch11.html#cb149-16" tabindex="-1"></a>fig11_4_hp_trend <span class="ot">&lt;-</span> <span class="fu">hp1</span>(fig11_4_data <span class="sc">%&gt;%</span></span>
<span id="cb149-17"><a href="ch11.html#cb149-17" tabindex="-1"></a>                            dplyr<span class="sc">::</span><span class="fu">select</span>(実質国内総支出) <span class="sc">%&gt;%</span></span>
<span id="cb149-18"><a href="ch11.html#cb149-18" tabindex="-1"></a>                            <span class="fu">mutate</span>(実質国内総支出 <span class="ot">=</span> <span class="fu">log</span>(実質国内総支出) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb149-19"><a href="ch11.html#cb149-19" tabindex="-1"></a>                            , <span class="at">lambda =</span> <span class="fl">6.25</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb149-20"><a href="ch11.html#cb149-20" tabindex="-1"></a>fig11_4_data <span class="ot">&lt;-</span> fig11_4_data <span class="sc">%&gt;%</span></span>
<span id="cb149-21"><a href="ch11.html#cb149-21" tabindex="-1"></a>    <span class="fu">mutate</span>(線形トレンド回帰 <span class="ot">=</span> fig11_4_lm<span class="sc">$</span>residuals,</span>
<span id="cb149-22"><a href="ch11.html#cb149-22" tabindex="-1"></a>           HPフィルター <span class="ot">=</span> <span class="fu">log</span>(実質国内総支出) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">-</span> fig11_4_hp_trend)</span>
<span id="cb149-23"><a href="ch11.html#cb149-23" tabindex="-1"></a></span>
<span id="cb149-24"><a href="ch11.html#cb149-24" tabindex="-1"></a>fig11_4_data <span class="sc">%&gt;%</span></span>
<span id="cb149-25"><a href="ch11.html#cb149-25" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;内閣府&quot;</span>, <span class="st">&quot;線形トレンド回帰&quot;</span>, <span class="st">&quot;HPフィルター&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb149-26"><a href="ch11.html#cb149-26" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 年, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb149-27"><a href="ch11.html#cb149-27" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb149-28"><a href="ch11.html#cb149-28" tabindex="-1"></a>    <span class="fu">scale_color_hue</span>(<span class="at">name =</span> <span class="fu">element_blank</span>(), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;HPフィルター&quot;</span>, <span class="st">&quot;内閣府&quot;</span>, <span class="st">&quot;線形トレンド回帰&quot;</span>)) <span class="sc">+</span></span>
<span id="cb149-29"><a href="ch11.html#cb149-29" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb149-30"><a href="ch11.html#cb149-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
</div>
<div id="実証例11.1-gdpの線形トレンドモデル推定" class="section level2 unnumbered hasAnchor">
<h2>実証例11.1 GDPの線形トレンド・モデル推定<a href="ch11.html#実証例11.1-gdpの線形トレンドモデル推定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="ch11.html#cb150-1" tabindex="-1"></a>ex11<span class="fl">.1</span>_data <span class="ot">&lt;-</span> fig11_2_data <span class="sc">%&gt;%</span></span>
<span id="cb150-2"><a href="ch11.html#cb150-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">GDP =</span> <span class="fu">log</span>(実質国内総支出) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-3"><a href="ch11.html#cb150-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">GDP_lag =</span> <span class="fu">lag</span>(GDP))</span>
<span id="cb150-4"><a href="ch11.html#cb150-4" tabindex="-1"></a>ex11<span class="fl">.1</span>_data_1 <span class="ot">&lt;-</span> ex11<span class="fl">.1</span>_data <span class="sc">%&gt;%</span></span>
<span id="cb150-5"><a href="ch11.html#cb150-5" tabindex="-1"></a>    <span class="fu">filter</span>(年 <span class="sc">&lt;=</span> <span class="dv">1973</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-6"><a href="ch11.html#cb150-6" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trend =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="dv">1973</span> <span class="sc">-</span> <span class="dv">1955</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb150-7"><a href="ch11.html#cb150-7" tabindex="-1"></a><span class="fu">lm</span>(GDP <span class="sc">~</span> trend, <span class="at">data =</span> ex11<span class="fl">.1</span>_data_1) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = GDP ~ trend, data = ex11.1_data_1)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -3.639 -1.671 -0.331  1.407  4.397 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1063.5336     1.1535   922.0   &lt;2e-16 ***
## trend          9.1663     0.1012    90.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.415 on 17 degrees of freedom
## Multiple R-squared:  0.9979, Adjusted R-squared:  0.9978 
## F-statistic:  8209 on 1 and 17 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="ch11.html#cb152-1" tabindex="-1"></a>ex11<span class="fl">.1</span>_data_2 <span class="ot">&lt;-</span> ex11<span class="fl">.1</span>_data <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="ch11.html#cb152-2" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="dv">1974</span> <span class="sc">&lt;=</span> 年 <span class="sc">&amp;</span> 年 <span class="sc">&lt;=</span> <span class="dv">1990</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="ch11.html#cb152-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trend =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="dv">1990</span> <span class="sc">-</span> <span class="dv">1974</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb152-4"><a href="ch11.html#cb152-4" tabindex="-1"></a><span class="fu">lm</span>(GDP <span class="sc">~</span> trend, <span class="at">data =</span> ex11<span class="fl">.1</span>_data_2) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = GDP ~ trend, data = ex11.1_data_2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -2.737 -1.660  0.077  1.319  3.499 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.228e+03  9.487e-01  1294.5   &lt;2e-16 ***
## trend       4.092e+00  9.258e-02    44.2   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.87 on 15 degrees of freedom
## Multiple R-squared:  0.9924, Adjusted R-squared:  0.9919 
## F-statistic:  1954 on 1 and 15 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="ch11.html#cb154-1" tabindex="-1"></a>ex11<span class="fl">.1</span>_data_3 <span class="ot">&lt;-</span> ex11<span class="fl">.1</span>_data <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="ch11.html#cb154-2" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="dv">1991</span> <span class="sc">&lt;=</span> 年 <span class="sc">&amp;</span> 年 <span class="sc">&lt;=</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="ch11.html#cb154-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trend =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="dv">2017</span> <span class="sc">-</span> <span class="dv">1991</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb154-4"><a href="ch11.html#cb154-4" tabindex="-1"></a><span class="fu">lm</span>(GDP <span class="sc">~</span> trend, <span class="at">data =</span> ex11<span class="fl">.1</span>_data_3) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = GDP ~ trend, data = ex11.1_data_3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6946 -1.2527 -0.0614  1.4012  3.7776 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1301.9385     0.7946  1638.5  &lt; 2e-16 ***
## trend          0.6894     0.0496    13.9  2.9e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.007 on 25 degrees of freedom
## Multiple R-squared:  0.8854, Adjusted R-squared:  0.8808 
## F-statistic: 193.2 on 1 and 25 DF,  p-value: 2.899e-13</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="ch11.html#cb156-1" tabindex="-1"></a></span>
<span id="cb156-2"><a href="ch11.html#cb156-2" tabindex="-1"></a><span class="fu">lm</span>(GDP <span class="sc">~</span> trend <span class="sc">+</span> GDP_lag, <span class="at">data =</span> ex11<span class="fl">.1</span>_data_1) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = GDP ~ trend + GDP_lag, data = ex11.1_data_1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.81645 -1.37189  0.00691  1.73576  3.03942 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 518.1008   229.4803   2.258   0.0393 *
## trend         4.4632     2.0108   2.220   0.0423 *
## GDP_lag       0.5167     0.2177   2.373   0.0314 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.042 on 15 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.9985, Adjusted R-squared:  0.9983 
## F-statistic:  4950 on 2 and 15 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="ch11.html#cb158-1" tabindex="-1"></a><span class="fu">lm</span>(GDP <span class="sc">~</span> trend <span class="sc">+</span> GDP_lag, <span class="at">data =</span> ex11<span class="fl">.1</span>_data_2) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = GDP ~ trend + GDP_lag, data = ex11.1_data_2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9907 -1.2997  0.4490  0.9211  2.2835 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 543.3746   227.1009   2.393  0.03131 * 
## trend         1.9227     0.7235   2.658  0.01874 * 
## GDP_lag       0.5585     0.1852   3.015  0.00927 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.507 on 14 degrees of freedom
## Multiple R-squared:  0.9954, Adjusted R-squared:  0.9947 
## F-statistic:  1508 on 2 and 14 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="ch11.html#cb160-1" tabindex="-1"></a><span class="fu">lm</span>(GDP <span class="sc">~</span> trend <span class="sc">+</span> GDP_lag, <span class="at">data =</span> ex11<span class="fl">.1</span>_data_3) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = GDP ~ trend + GDP_lag, data = ex11.1_data_3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.4941 -0.5359  0.4347  1.1741  2.5211 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 773.6247   245.1207   3.156  0.00427 **
## trend         0.4118     0.1369   3.009  0.00607 **
## GDP_lag       0.4060     0.1884   2.155  0.04138 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.875 on 24 degrees of freedom
## Multiple R-squared:  0.904,  Adjusted R-squared:  0.896 
## F-statistic:   113 on 2 and 24 DF,  p-value: 6.131e-13</code></pre>
</div>
<div id="実証例11.2-為替レートの単位根検定" class="section level2 unnumbered hasAnchor">
<h2>実証例11.2 為替レートの単位根検定<a href="ch11.html#実証例11.2-為替レートの単位根検定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>データはエクセルファイルに収録されているようだが, ところどころNAとなっている箇所がある.
NAになっている日については, ここでは単純に前日の値を用いることにする.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="ch11.html#cb162-1" tabindex="-1"></a>JapanIntervention1991_2004 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/11_第11章/JapanIntervention1991-2004.xls&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;YenDollar&quot;</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...3`
## • `` -&gt; `...4`
## • `` -&gt; `...6`</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="ch11.html#cb164-1" tabindex="-1"></a>data_ex11<span class="fl">.2</span> <span class="ot">&lt;-</span> JapanIntervention1991_2004[<span class="dv">3</span><span class="sc">:</span><span class="dv">3047</span>, ]</span>
<span id="cb164-2"><a href="ch11.html#cb164-2" tabindex="-1"></a>data_ex11<span class="fl">.2</span> <span class="ot">&lt;-</span> data_ex11<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">mdy</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb164-3"><a href="ch11.html#cb164-3" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb164-4"><a href="ch11.html#cb164-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rate_NY =</span> <span class="fu">as.numeric</span>(Yen.Dollar.Rate)) <span class="sc">%&gt;%</span></span>
<span id="cb164-5"><a href="ch11.html#cb164-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(date, rate_NY, Interventions) <span class="sc">%&gt;%</span></span>
<span id="cb164-6"><a href="ch11.html#cb164-6" tabindex="-1"></a>    <span class="fu">fill</span>(rate_NY, <span class="at">.direction =</span> <span class="st">&quot;down&quot;</span>)</span>
<span id="cb164-7"><a href="ch11.html#cb164-7" tabindex="-1"></a>data_ex11<span class="fl">.2</span> <span class="ot">&lt;-</span> data_ex11<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">S =</span> <span class="fu">log</span>(rate_NY) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb164-8"><a href="ch11.html#cb164-8" tabindex="-1"></a>             <span class="at">trend =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data_ex11<span class="fl">.2</span>)[<span class="dv">1</span>])</span>
<span id="cb164-9"><a href="ch11.html#cb164-9" tabindex="-1"></a></span>
<span id="cb164-10"><a href="ch11.html#cb164-10" tabindex="-1"></a><span class="fu">lm</span>(S <span class="sc">-</span> <span class="fu">lag</span>(S) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">lag</span>(S), <span class="at">data =</span> data_ex11<span class="fl">.2</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = S - lag(S) ~ 0 + lag(S), data = data_ex11.2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.4107 -0.3690  0.0060  0.3957  4.1037 
## 
## Coefficients:
##          Estimate Std. Error t value Pr(&gt;|t|)
## lag(S) -1.241e-05  2.803e-05  -0.443    0.658
## 
## Residual standard error: 0.7345 on 3043 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  6.442e-05,  Adjusted R-squared:  -0.0002642 
## F-statistic: 0.196 on 1 and 3043 DF,  p-value: 0.658</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="ch11.html#cb166-1" tabindex="-1"></a><span class="fu">lm</span>(S <span class="sc">-</span> <span class="fu">lag</span>(S) <span class="sc">~</span> <span class="fu">lag</span>(S), <span class="at">data =</span> data_ex11<span class="fl">.2</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = S - lag(S) ~ lag(S), data = data_ex11.2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.3803 -0.3750  0.0153  0.4020  4.0701 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  1.228288   0.564321   2.177   0.0296 *
## lag(S)      -0.002598   0.001188  -2.186   0.0289 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7341 on 3042 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.001569,   Adjusted R-squared:  0.001241 
## F-statistic:  4.78 on 1 and 3042 DF,  p-value: 0.02886</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="ch11.html#cb168-1" tabindex="-1"></a><span class="fu">lm</span>(S <span class="sc">-</span> <span class="fu">lag</span>(S) <span class="sc">~</span> trend <span class="sc">+</span> <span class="fu">lag</span>(S), <span class="at">data =</span> data_ex11<span class="fl">.2</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = S - lag(S) ~ trend + lag(S), data = data_ex11.2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.3862 -0.3670  0.0086  0.4016  4.0836 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  1.244e+00  5.645e-01   2.204   0.0276 *
## trend        1.623e-05  1.517e-05   1.069   0.2850  
## lag(S)      -2.683e-03  1.191e-03  -2.253   0.0243 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7341 on 3041 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.001944,   Adjusted R-squared:  0.001288 
## F-statistic: 2.962 on 2 and 3041 DF,  p-value: 0.05186</code></pre>
</div>
<div id="図11-6-円ドルレート" class="section level2 unnumbered hasAnchor">
<h2>図11-6 円ドルレート<a href="ch11.html#図11-6-円ドルレート" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="ch11.html#cb170-1" tabindex="-1"></a>data_ex11<span class="fl">.2</span> <span class="sc">%&gt;%</span></span>
<span id="cb170-2"><a href="ch11.html#cb170-2" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> rate_NY)) <span class="sc">+</span></span>
<span id="cb170-3"><a href="ch11.html#cb170-3" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb170-4"><a href="ch11.html#cb170-4" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;年&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
</div>
<div id="実証例11.3-インフレ率の単位根検定" class="section level2 unnumbered hasAnchor">
<h2>実証例11.3 インフレ率の単位根検定<a href="ch11.html#実証例11.3-インフレ率の単位根検定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>データは<a href="ch10.html#figure10-9">図10-9</a>で用いたのと同じである (2016年7月までしかないようだ).
ADF検定は, Rでは<code>urca</code>パッケージの<code>ur.df()</code>という関数に実装されており, 引数の<code>type = c("none", "drift", "trend")</code>を選択することでそれぞれ定数項を含まない式, 定数項を含む式, 定数項とトレンドを含む式を推定できる.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="ch11.html#cb171-1" tabindex="-1"></a>Fig_9_CPEinflation_monthly <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;./data/10_第10章/Fig_9_CPEinflation_monthly.xlsx&quot;</span>)</span>
<span id="cb171-2"><a href="ch11.html#cb171-2" tabindex="-1"></a>data_ex11<span class="fl">.3</span> <span class="ot">&lt;-</span> Fig_9_CPEinflation_monthly <span class="sc">%&gt;%</span></span>
<span id="cb171-3"><a href="ch11.html#cb171-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">ym</span>(<span class="st">`</span><span class="at">類・品目</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb171-4"><a href="ch11.html#cb171-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">CPI =</span> <span class="fu">as.numeric</span>(生鮮食品を除く総合)) <span class="sc">%&gt;%</span></span>
<span id="cb171-5"><a href="ch11.html#cb171-5" tabindex="-1"></a>    <span class="fu">mutate</span>(対数季節階差 <span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">log</span>(CPI<span class="sc">/</span><span class="fu">lag</span>(CPI, <span class="at">n =</span> <span class="dv">12</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb171-6"><a href="ch11.html#cb171-6" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(対数季節階差, year) <span class="sc">%&gt;%</span></span>
<span id="cb171-7"><a href="ch11.html#cb171-7" tabindex="-1"></a>    <span class="fu">mutate</span>(対数季節階差<span class="at">_delta =</span> 対数季節階差 <span class="sc">-</span> <span class="fu">lag</span>(対数季節階差)) <span class="sc">%&gt;%</span></span>
<span id="cb171-8"><a href="ch11.html#cb171-8" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">ym</span>(<span class="dv">197101</span>) <span class="sc">&lt;=</span> year)</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `year = ym(`類・品目`)`.
## Caused by warning:
## !  5 failed to parse.</code></pre>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `CPI = as.numeric(生鮮食品を除く総合)`.
## Caused by warning:
## ! NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="ch11.html#cb174-1" tabindex="-1"></a><span class="fu">ur.df</span>(data_ex11<span class="fl">.3</span><span class="sc">$</span>対数季節階差, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression none 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 - 1 + z.diff.lag)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.57507 -0.13809  0.01211  0.13991  1.97211 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## z.lag.1      -0.004990   0.003206  -1.556 0.120218    
## z.diff.lag1   0.235206   0.036471   6.449 2.57e-10 ***
## z.diff.lag2   0.127218   0.037754   3.370 0.000808 ***
## z.diff.lag3   0.087580   0.037955   2.307 0.021419 *  
## z.diff.lag4   0.029009   0.037732   0.769 0.442346    
## z.diff.lag5   0.074163   0.037539   1.976 0.048728 *  
## z.diff.lag6   0.064343   0.037666   1.708 0.088188 .  
## z.diff.lag7  -0.016920   0.037550  -0.451 0.652471    
## z.diff.lag8   0.090587   0.037230   2.433 0.015302 *  
## z.diff.lag9   0.107932   0.037461   2.881 0.004125 ** 
## z.diff.lag10  0.096177   0.037554   2.561 0.010716 *  
## z.diff.lag11  0.056726   0.037355   1.519 0.129485    
## z.diff.lag12 -0.537739   0.036170 -14.867  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.338 on 521 degrees of freedom
## Multiple R-squared:  0.4434, Adjusted R-squared:  0.4295 
## F-statistic: 31.93 on 13 and 521 DF,  p-value: &lt; 2.2e-16
## 
## 
## Value of test-statistic is: -1.5564 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau1 -2.58 -1.95 -1.62</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="ch11.html#cb176-1" tabindex="-1"></a><span class="fu">ur.df</span>(data_ex11<span class="fl">.3</span><span class="sc">$</span>対数季節階差, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">&quot;drift&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression drift 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 + 1 + z.diff.lag)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.57058 -0.14236  0.00337  0.13442  1.97347 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.009221   0.017532   0.526 0.599146    
## z.lag.1      -0.006098   0.003837  -1.589 0.112677    
## z.diff.lag1   0.235058   0.036497   6.440 2.71e-10 ***
## z.diff.lag2   0.127304   0.037780   3.370 0.000809 ***
## z.diff.lag3   0.087842   0.037984   2.313 0.021136 *  
## z.diff.lag4   0.029479   0.037769   0.781 0.435439    
## z.diff.lag5   0.074728   0.037581   1.988 0.047285 *  
## z.diff.lag6   0.064924   0.037709   1.722 0.085715 .  
## z.diff.lag7  -0.016193   0.037602  -0.431 0.666896    
## z.diff.lag8   0.091351   0.037284   2.450 0.014609 *  
## z.diff.lag9   0.108797   0.037523   2.900 0.003896 ** 
## z.diff.lag10  0.097194   0.037629   2.583 0.010069 *  
## z.diff.lag11  0.057959   0.037455   1.547 0.122365    
## z.diff.lag12 -0.536201   0.036313 -14.766  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3383 on 520 degrees of freedom
## Multiple R-squared:  0.4434, Adjusted R-squared:  0.4294 
## F-statistic: 31.86 on 13 and 520 DF,  p-value: &lt; 2.2e-16
## 
## 
## Value of test-statistic is: -1.589 1.3478 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau2 -3.43 -2.86 -2.57
## phi1  6.43  4.59  3.78</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="ch11.html#cb178-1" tabindex="-1"></a><span class="fu">ur.df</span>(data_ex11<span class="fl">.3</span><span class="sc">$</span>対数季節階差, <span class="at">lags =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">&quot;trend&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression trend 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.54891 -0.13648 -0.00533  0.12540  1.97034 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.1086391  0.0535763   2.028 0.043097 *  
## z.lag.1      -0.0145446  0.0057585  -2.526 0.011841 *  
## tt           -0.0002798  0.0001425  -1.963 0.050167 .  
## z.diff.lag1   0.2324677  0.0364212   6.383 3.86e-10 ***
## z.diff.lag2   0.1271276  0.0376771   3.374 0.000796 ***
## z.diff.lag3   0.0890027  0.0378853   2.349 0.019184 *  
## z.diff.lag4   0.0325407  0.0376976   0.863 0.388423    
## z.diff.lag5   0.0786255  0.0375307   2.095 0.036658 *  
## z.diff.lag6   0.0690914  0.0376654   1.834 0.067175 .  
## z.diff.lag7  -0.0106739  0.0376041  -0.284 0.776640    
## z.diff.lag8   0.0966499  0.0372802   2.593 0.009796 ** 
## z.diff.lag9   0.1145864  0.0375361   3.053 0.002384 ** 
## z.diff.lag10  0.1043355  0.0377025   2.767 0.005853 ** 
## z.diff.lag11  0.0666170  0.0376120   1.771 0.077120 .  
## z.diff.lag12 -0.5257571  0.0366026 -14.364  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3373 on 519 degrees of freedom
## Multiple R-squared:  0.4475, Adjusted R-squared:  0.4326 
## F-statistic: 30.02 on 14 and 519 DF,  p-value: &lt; 2.2e-16
## 
## 
## Value of test-statistic is: -2.5258 2.1881 3.1962 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau3 -3.96 -3.41 -3.12
## phi2  6.09  4.68  4.03
## phi3  8.27  6.25  5.34</code></pre>
</div>
<div id="実証例11.3-インフレ率の単位根検定-1" class="section level2 unnumbered hasAnchor">
<h2>実証例11.3 インフレ率の単位根検定<a href="ch11.html#実証例11.3-インフレ率の単位根検定-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="ch11.html#cb180-1" tabindex="-1"></a>data_ex11<span class="fl">.3</span> <span class="sc">%&gt;%</span></span>
<span id="cb180-2"><a href="ch11.html#cb180-2" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="fu">ym</span>(<span class="dv">197101</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="ch11.html#cb180-3" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> 対数季節階差)) <span class="sc">+</span></span>
<span id="cb180-4"><a href="ch11.html#cb180-4" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb180-5"><a href="ch11.html#cb180-5" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;年&quot;</span>, <span class="at">y =</span> <span class="st">&quot;インフレ率 (%)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
</div>
<div id="実証例11.4-ランダムウォーク型のトレンドインフレ率の推定" class="section level2 unnumbered hasAnchor">
<h2>実証例11.4 ランダムウォーク型のトレンド・インフレ率の推定<a href="ch11.html#実証例11.4-ランダムウォーク型のトレンドインフレ率の推定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Beveridge Nelson分解は<a href="https://www.kevinkotze.org/">Kevin Kotzé</a>氏による<code>tsm</code>パッケージに実装されている.
このパッケージはCRANにはなく, 彼のGithubリポジトリに公開されているため, <code>devtools::install_github()</code>でインストールする.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="ch11.html#cb181-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;KevinKotze/tsm&quot;</span>)</span>
<span id="cb181-2"><a href="ch11.html#cb181-2" tabindex="-1"></a><span class="fu">library</span>(tsm)</span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="ch11.html#cb182-1" tabindex="-1"></a>data_ex11<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">bnd</span>(data_ex11<span class="fl">.3</span><span class="sc">$</span>対数季節階差, <span class="at">nlag =</span> <span class="dv">12</span>)</span></code></pre></div>
</div>
<div id="図11-8-bn分解とランダムウォーク型トレンドインフレ率" class="section level2 unnumbered hasAnchor">
<h2>図11-8 BN分解とランダムウォーク型トレンド・インフレ率<a href="ch11.html#図11-8-bn分解とランダムウォーク型トレンドインフレ率" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>続いて, もとのインフレ率データと合わせてグラフにプロットする.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="ch11.html#cb183-1" tabindex="-1"></a>data_fig11_8 <span class="ot">&lt;-</span> data_ex11<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb183-2"><a href="ch11.html#cb183-2" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb183-3"><a href="ch11.html#cb183-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(trend) <span class="sc">%&gt;%</span></span>
<span id="cb183-4"><a href="ch11.html#cb183-4" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">&quot;トレンド成分 (トレンド・インフレ率)&quot;</span> <span class="ot">=</span> trend) <span class="sc">%&gt;%</span></span>
<span id="cb183-5"><a href="ch11.html#cb183-5" tabindex="-1"></a>    <span class="fu">cbind</span>(data_ex11<span class="fl">.3</span>)</span>
<span id="cb183-6"><a href="ch11.html#cb183-6" tabindex="-1"></a>data_fig11_8 <span class="sc">%&gt;%</span></span>
<span id="cb183-7"><a href="ch11.html#cb183-7" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;トレンド成分 (トレンド・インフレ率)&quot;</span>, <span class="st">&quot;対数季節階差&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb183-8"><a href="ch11.html#cb183-8" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb183-9"><a href="ch11.html#cb183-9" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb183-10"><a href="ch11.html#cb183-10" tabindex="-1"></a>    <span class="fu">scale_color_hue</span>(<span class="at">name =</span> <span class="fu">element_blank</span>(), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;トレンド成分 (トレンド・インフレ率)&quot;</span>, <span class="st">&quot;インフレ率&quot;</span>)) <span class="sc">+</span></span>
<span id="cb183-11"><a href="ch11.html#cb183-11" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb183-12"><a href="ch11.html#cb183-12" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
<div id="実証例11.5-水準シフト型のトレンドインフレ率推定と構造変化検定" class="section level2 unnumbered hasAnchor">
<h2>実証例11.5 水準シフト型のトレンド・インフレ率推定と構造変化検定<a href="ch11.html#実証例11.5-水準シフト型のトレンドインフレ率推定と構造変化検定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>構造変化点<span class="math inline">\(T^*\)</span>が未知の場合に行う単位根検定であるZivot=Andrews検定はRでは<code>urca::ur.za()</code>に実装されているが, この関数は<span class="math inline">\(F\)</span>検定ではなく<span class="math inline">\(t\)</span>検定を行うようだ.
ここでは代わりに, <span class="math inline">\(\text{int}[\pi_0\times T] \geq T^* \geq \text{int}[(1 - \pi_0)\times T]\)</span>の範囲の各<span class="math inline">\(T^*\)</span>についてforループで<span class="math inline">\(F\)</span>統計量を計算することにする.
なお, <span class="math inline">\(q = 1\)</span>の場合, 上限<span class="math inline">\(F\)</span>統計量と上限ワルド統計量は一致するので, 後者は省略する.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="ch11.html#cb184-1" tabindex="-1"></a>data_ex11<span class="fl">.5</span> <span class="ot">&lt;-</span> data_ex11<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="ch11.html#cb184-2" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="ch11.html#cb184-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(trend) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="ch11.html#cb184-4" tabindex="-1"></a>    <span class="fu">cbind</span>(data_ex11<span class="fl">.3</span><span class="sc">$</span>year) <span class="sc">%&gt;%</span></span>
<span id="cb184-5"><a href="ch11.html#cb184-5" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">&quot;year&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">data_ex11.3$year</span><span class="st">`</span>)</span>
<span id="cb184-6"><a href="ch11.html#cb184-6" tabindex="-1"></a><span class="co"># それぞれのT^*についてRSS(T^*)とF(T^*)の値を保存するための列を作っておく.</span></span>
<span id="cb184-7"><a href="ch11.html#cb184-7" tabindex="-1"></a>data_ex11<span class="fl">.5</span> <span class="ot">&lt;-</span> data_ex11<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb184-8"><a href="ch11.html#cb184-8" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data_ex11<span class="fl">.5</span>)[<span class="dv">1</span>], <span class="co"># 行番号</span></span>
<span id="cb184-9"><a href="ch11.html#cb184-9" tabindex="-1"></a>           <span class="at">RSS_T_star =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">dim</span>(data_ex11<span class="fl">.5</span>)[<span class="dv">1</span>]),</span>
<span id="cb184-10"><a href="ch11.html#cb184-10" tabindex="-1"></a>           <span class="at">FT_star =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">dim</span>(data_ex11<span class="fl">.5</span>)[<span class="dv">1</span>]))</span>
<span id="cb184-11"><a href="ch11.html#cb184-11" tabindex="-1"></a></span>
<span id="cb184-12"><a href="ch11.html#cb184-12" tabindex="-1"></a><span class="co"># パラメータ</span></span>
<span id="cb184-13"><a href="ch11.html#cb184-13" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">dim</span>(data_ex11<span class="fl">.5</span>)[<span class="dv">1</span>]</span>
<span id="cb184-14"><a href="ch11.html#cb184-14" tabindex="-1"></a>pi_0 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb184-15"><a href="ch11.html#cb184-15" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb184-16"><a href="ch11.html#cb184-16" tabindex="-1"></a></span>
<span id="cb184-17"><a href="ch11.html#cb184-17" tabindex="-1"></a>RSS_R <span class="ot">&lt;-</span> <span class="fu">lm</span>(trend <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data_ex11<span class="fl">.5</span>)<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span> <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb184-18"><a href="ch11.html#cb184-18" tabindex="-1"></a><span class="cf">for</span> (T_star <span class="cf">in</span> <span class="fu">floor</span>(pi_0 <span class="sc">*</span> T)<span class="sc">:</span><span class="fu">floor</span>((<span class="dv">1</span> <span class="sc">-</span> pi_0) <span class="sc">*</span> T)) {</span>
<span id="cb184-19"><a href="ch11.html#cb184-19" tabindex="-1"></a>    <span class="co"># 構造変化前後を示すダミー変数を作成</span></span>
<span id="cb184-20"><a href="ch11.html#cb184-20" tabindex="-1"></a>    data_ex11<span class="fl">.5</span>_temp <span class="ot">&lt;-</span> data_ex11<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb184-21"><a href="ch11.html#cb184-21" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">dummy =</span> t <span class="sc">&lt;</span> T_star)</span>
<span id="cb184-22"><a href="ch11.html#cb184-22" tabindex="-1"></a>    data_ex11<span class="fl">.5</span><span class="sc">$</span>RSS_T_star[T_star] <span class="ot">&lt;-</span> <span class="fu">lm</span>(trend <span class="sc">~</span> dummy, <span class="at">data =</span> data_ex11<span class="fl">.5</span>_temp)<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span> <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb184-23"><a href="ch11.html#cb184-23" tabindex="-1"></a>    data_ex11<span class="fl">.5</span><span class="sc">$</span>FT_star[T_star] <span class="ot">&lt;-</span> ((RSS_R <span class="sc">-</span> data_ex11<span class="fl">.5</span><span class="sc">$</span>RSS_T_star[T_star]) <span class="sc">/</span> q) <span class="sc">/</span> (data_ex11<span class="fl">.5</span><span class="sc">$</span>RSS_T_star[T_star] <span class="sc">/</span> (T <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> q))</span>
<span id="cb184-24"><a href="ch11.html#cb184-24" tabindex="-1"></a>}</span>
<span id="cb184-25"><a href="ch11.html#cb184-25" tabindex="-1"></a></span>
<span id="cb184-26"><a href="ch11.html#cb184-26" tabindex="-1"></a><span class="co"># 構造変化点を表示</span></span>
<span id="cb184-27"><a href="ch11.html#cb184-27" tabindex="-1"></a>data_ex11<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb184-28"><a href="ch11.html#cb184-28" tabindex="-1"></a>    <span class="fu">filter</span>(FT_star <span class="sc">==</span> <span class="fu">max</span>(FT_star, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>##      trend       year   t RSS_T_star  FT_star
## 1 4.025797 1981-11-01 131   3612.687 860.5861</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="ch11.html#cb186-1" tabindex="-1"></a><span class="co"># 構造変化前後のトレンド・インフレ率の推定値を表示</span></span>
<span id="cb186-2"><a href="ch11.html#cb186-2" tabindex="-1"></a>data_ex11<span class="fl">.5</span> <span class="ot">&lt;-</span> data_ex11<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb186-3"><a href="ch11.html#cb186-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">after_structural_break =</span> t <span class="sc">&gt;=</span> <span class="dv">131</span>)</span>
<span id="cb186-4"><a href="ch11.html#cb186-4" tabindex="-1"></a>data_ex11<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb186-5"><a href="ch11.html#cb186-5" tabindex="-1"></a>    <span class="fu">group_by</span>(after_structural_break) <span class="sc">%&gt;%</span></span>
<span id="cb186-6"><a href="ch11.html#cb186-6" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(trend, <span class="sc">~</span> <span class="fu">mean</span>(. , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   after_structural_break trend
##   &lt;lgl&gt;                  &lt;dbl&gt;
## 1 FALSE                  8.32 
## 2 TRUE                   0.730</code></pre>
<p>分析の結果, 1981年11月に上限ワルド統計量<span class="math inline">\(F(T^*) = 860.5861\)</span>が得られたことがわかった.
また, 構造変化前のトレンド・インフレ率は8.32%, 構造変化後は0.730%だった.</p>
</div>
<div id="図11-9-トレンドインフレ率水準の構造変化-ワルド統計量" class="section level2 unnumbered hasAnchor">
<h2>図11-9 トレンド・インフレ率水準の構造変化 (ワルド統計量)<a href="ch11.html#図11-9-トレンドインフレ率水準の構造変化-ワルド統計量" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="ch11.html#cb188-1" tabindex="-1"></a>data_ex11<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb188-2"><a href="ch11.html#cb188-2" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> FT_star)) <span class="sc">+</span></span>
<span id="cb188-3"><a href="ch11.html#cb188-3" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 54 rows containing missing values or values outside the scale
## range (`geom_line()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
</div>
<div id="図11-10-水準シフト型トレンドインフレ率" class="section level2 unnumbered hasAnchor">
<h2>図11-10 水準シフト型トレンド・インフレ率<a href="ch11.html#図11-10-水準シフト型トレンドインフレ率" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="ch11.html#cb190-1" tabindex="-1"></a><span class="co"># 手動描画用に推定値を保存しておく.</span></span>
<span id="cb190-2"><a href="ch11.html#cb190-2" tabindex="-1"></a>y_max_min <span class="ot">&lt;-</span> data_ex11<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="ch11.html#cb190-3" tabindex="-1"></a>    <span class="fu">group_by</span>(after_structural_break) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="ch11.html#cb190-4" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(trend, <span class="sc">~</span> <span class="fu">mean</span>(. , <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="ch11.html#cb190-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(trend) <span class="sc">%&gt;%</span></span>
<span id="cb190-6"><a href="ch11.html#cb190-6" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb190-7"><a href="ch11.html#cb190-7" tabindex="-1"></a></span>
<span id="cb190-8"><a href="ch11.html#cb190-8" tabindex="-1"></a>data_ex11<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb190-9"><a href="ch11.html#cb190-9" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> trend, <span class="at">group =</span> after_structural_break)) <span class="sc">+</span></span>
<span id="cb190-10"><a href="ch11.html#cb190-10" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb190-11"><a href="ch11.html#cb190-11" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb190-12"><a href="ch11.html#cb190-12" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ym</span>(<span class="dv">198111</span>), <span class="at">ymax =</span> y_max_min[<span class="dv">1</span>], <span class="at">ymin =</span> y_max_min[<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<!-- ## 練習問題 11-1 [確認] {-}

## 練習問題 11-2 [確認] {-}

## 練習問題 11-3 [確認] {-}

## 練習問題 11-4 [確認] {-}

## 練習問題 11-5 [確認] {-}

## 練習問題 11-6 [発展] {-}

## 練習問題 11-7 [発展] {-} -->
</div>
<div id="練習問題-11-8-実証" class="section level2 unnumbered hasAnchor">
<h2>練習問題 11-8 [実証]<a href="ch11.html#練習問題-11-8-実証" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>データを読み込む.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="ch11.html#cb191-1" tabindex="-1"></a>USlogRealGDP <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/11_第11章/USlogRealGDP.xls&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;logRealGDP&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...1`
## • `` -&gt; `...2`</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="ch11.html#cb193-1" tabindex="-1"></a>data_practice11<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(USlogRealGDP) <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="ch11.html#cb193-2" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">&quot;year_quarter&quot;</span> <span class="ot">=</span> ...<span class="dv">1</span>, <span class="st">&quot;logRealGDP&quot;</span> <span class="ot">=</span> ...<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb193-3"><a href="ch11.html#cb193-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year_quarter =</span> <span class="fu">yq</span>(year_quarter),</span>
<span id="cb193-4"><a href="ch11.html#cb193-4" tabindex="-1"></a>           <span class="at">logRealGDP =</span> <span class="fu">as.numeric</span>(logRealGDP)) <span class="sc">%&gt;%</span></span>
<span id="cb193-5"><a href="ch11.html#cb193-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trend =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(USlogRealGDP)[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `year_quarter = yq(year_quarter)`.
## Caused by warning:
## !  1 failed to parse.</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="ch11.html#cb195-1" tabindex="-1"></a>data_practice11<span class="fl">.8</span>[<span class="dv">120</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">yq</span>(<span class="st">&quot;1976Q4&quot;</span>) <span class="co"># 誤植によりyq()でパースできなかった箇所を直す</span></span></code></pre></div>
<p>線形トレンドの推定.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="ch11.html#cb196-1" tabindex="-1"></a>data_practice11<span class="fl">.8</span>_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(logRealGDP <span class="sc">~</span> trend, <span class="at">data =</span> data_practice11<span class="fl">.8</span>)</span>
<span id="cb196-2"><a href="ch11.html#cb196-2" tabindex="-1"></a><span class="fu">summary</span>(data_practice11<span class="fl">.8</span>_linear)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logRealGDP ~ trend, data = data_practice11.8)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.731  -5.130   2.577   5.267   9.990 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 7.713e+02  7.968e-01   968.0   &lt;2e-16 ***
## trend       7.883e-01  4.763e-03   165.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.755 on 287 degrees of freedom
## Multiple R-squared:  0.9896, Adjusted R-squared:  0.9896 
## F-statistic: 2.739e+04 on 1 and 287 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>HPフィルターによる推定. ここで用いるデータは四半期データなので, <span class="math inline">\(\lambda = 1600\)</span>を用いる.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="ch11.html#cb198-1" tabindex="-1"></a>data_practice11<span class="fl">.8</span>_hp <span class="ot">&lt;-</span> data_practice11<span class="fl">.8</span> <span class="sc">%&gt;%</span></span>
<span id="cb198-2"><a href="ch11.html#cb198-2" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(logRealGDP) <span class="sc">%&gt;%</span></span>
<span id="cb198-3"><a href="ch11.html#cb198-3" tabindex="-1"></a>    <span class="fu">hp1</span>(<span class="at">lambda =</span> <span class="dv">1600</span>) <span class="sc">%&gt;%</span></span>
<span id="cb198-4"><a href="ch11.html#cb198-4" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">&quot;hp&quot;</span> <span class="ot">=</span> logRealGDP)</span></code></pre></div>
<p>推定結果をデータフレームに格納して, ggplotでグラフを描画する.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="ch11.html#cb199-1" tabindex="-1"></a>data_practice11<span class="fl">.8</span> <span class="ot">&lt;-</span> data_practice11<span class="fl">.8</span> <span class="sc">%&gt;%</span></span>
<span id="cb199-2"><a href="ch11.html#cb199-2" tabindex="-1"></a>                        <span class="fu">cbind</span>(data_practice11<span class="fl">.8</span>_hp) <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="ch11.html#cb199-3" tabindex="-1"></a>                        <span class="fu">cbind</span>(<span class="fu">data.frame</span>(<span class="at">linear_trend =</span> data_practice11<span class="fl">.8</span>_linear<span class="sc">$</span>fitted.values))</span>
<span id="cb199-4"><a href="ch11.html#cb199-4" tabindex="-1"></a></span>
<span id="cb199-5"><a href="ch11.html#cb199-5" tabindex="-1"></a>data_practice11<span class="fl">.8</span> <span class="sc">%&gt;%</span></span>
<span id="cb199-6"><a href="ch11.html#cb199-6" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;logRealGDP&quot;</span>, <span class="st">&quot;linear_trend&quot;</span>, <span class="st">&quot;hp&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb199-7"><a href="ch11.html#cb199-7" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year_quarter, <span class="at">y =</span> value, <span class="at">color =</span> name, <span class="at">linetype =</span> name)) <span class="sc">+</span></span>
<span id="cb199-8"><a href="ch11.html#cb199-8" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year_quarter, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb199-9"><a href="ch11.html#cb199-9" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb199-10"><a href="ch11.html#cb199-10" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;HPフィルター (λ = 1600)&quot;</span>, <span class="st">&quot;線形トレンド&quot;</span>, <span class="st">&quot;対数実質GDP&quot;</span>),</span>
<span id="cb199-11"><a href="ch11.html#cb199-11" tabindex="-1"></a>                       <span class="at">name =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb199-12"><a href="ch11.html#cb199-12" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;solid&quot;</span>),</span>
<span id="cb199-13"><a href="ch11.html#cb199-13" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;HPフィルター (λ = 1600)&quot;</span>, <span class="st">&quot;線形トレンド&quot;</span>, <span class="st">&quot;対数実質GDP&quot;</span>),</span>
<span id="cb199-14"><a href="ch11.html#cb199-14" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb199-15"><a href="ch11.html#cb199-15" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;年&quot;</span>, <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb199-16"><a href="ch11.html#cb199-16" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<p>GDPギャップ推定値の比較もグラフに描画する.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="ch11.html#cb200-1" tabindex="-1"></a>data_practice11<span class="fl">.8</span> <span class="sc">%&gt;%</span></span>
<span id="cb200-2"><a href="ch11.html#cb200-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gap_hp =</span> hp <span class="sc">-</span> logRealGDP,</span>
<span id="cb200-3"><a href="ch11.html#cb200-3" tabindex="-1"></a>           <span class="at">gap_linear_trend =</span> linear_trend <span class="sc">-</span> logRealGDP) <span class="sc">%&gt;%</span></span>
<span id="cb200-4"><a href="ch11.html#cb200-4" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;gap_linear_trend&quot;</span>, <span class="st">&quot;gap_hp&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb200-5"><a href="ch11.html#cb200-5" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year_quarter, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb200-6"><a href="ch11.html#cb200-6" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year_quarter, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb200-7"><a href="ch11.html#cb200-7" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb200-8"><a href="ch11.html#cb200-8" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;HPフィルター (λ = 1600)&quot;</span>, <span class="st">&quot;線形トレンド&quot;</span>),</span>
<span id="cb200-9"><a href="ch11.html#cb200-9" tabindex="-1"></a>                       <span class="at">name =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb200-10"><a href="ch11.html#cb200-10" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb200-11"><a href="ch11.html#cb200-11" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;年&quot;</span>, <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb200-12"><a href="ch11.html#cb200-12" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
</div>
<div id="練習問題-11-9-実証" class="section level2 unnumbered hasAnchor">
<h2>練習問題 11-9 [実証]<a href="ch11.html#練習問題-11-9-実証" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>データを読み込む.
ここでは, HadCRUT3データの全球平均値を分析することにする.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="ch11.html#cb201-1" tabindex="-1"></a>globaltemperature <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/11_第11章/globaltemparature.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;data&quot;</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...1`
## • `` -&gt; `...3`
## • `` -&gt; `...4`
## • `` -&gt; `...5`
## • `` -&gt; `...6`
## • `` -&gt; `...7`
## • `` -&gt; `...8`
## • `` -&gt; `...9`
## • `` -&gt; `...10`
## • `` -&gt; `...12`
## • `` -&gt; `...13`
## • `` -&gt; `...14`
## • `` -&gt; `...15`
## • `` -&gt; `...16`</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="ch11.html#cb203-1" tabindex="-1"></a>data_practice11<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(globaltemperature[<span class="dv">3</span><span class="sc">:</span><span class="dv">166</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]) <span class="sc">%&gt;%</span></span>
<span id="cb203-2"><a href="ch11.html#cb203-2" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">&quot;year&quot;</span> <span class="ot">=</span> ...<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-3"><a href="ch11.html#cb203-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Unfiltered =</span> <span class="fu">as.numeric</span>(Unfiltered),</span>
<span id="cb203-4"><a href="ch11.html#cb203-4" tabindex="-1"></a>           <span class="at">year =</span> <span class="fu">as.numeric</span>(year))</span>
<span id="cb203-5"><a href="ch11.html#cb203-5" tabindex="-1"></a>data_practice11<span class="fl">.9</span> <span class="ot">&lt;-</span> data_practice11<span class="fl">.9</span> <span class="sc">%&gt;%</span></span>
<span id="cb203-6"><a href="ch11.html#cb203-6" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trend =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data_practice11<span class="fl">.9</span>)[<span class="dv">1</span>])</span></code></pre></div>
<p>データをプロットする.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="ch11.html#cb204-1" tabindex="-1"></a>data_practice11<span class="fl">.9</span> <span class="sc">%&gt;%</span></span>
<span id="cb204-2"><a href="ch11.html#cb204-2" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb204-3"><a href="ch11.html#cb204-3" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> Unfiltered))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
<p>まずは<a href="#ex11.2">実証例11.2</a>で見たように, ディッキー=フラー検定を行う.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="ch11.html#cb205-1" tabindex="-1"></a>practice11<span class="fl">.9</span>_lm_none <span class="ot">&lt;-</span> <span class="fu">lm</span>(Unfiltered <span class="sc">-</span> <span class="fu">lag</span>(Unfiltered) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">lag</span>(Unfiltered), <span class="at">data =</span> data_practice11<span class="fl">.9</span>)</span>
<span id="cb205-2"><a href="ch11.html#cb205-2" tabindex="-1"></a>practice11<span class="fl">.9</span>_lm_drift <span class="ot">&lt;-</span> <span class="fu">lm</span>(Unfiltered <span class="sc">-</span> <span class="fu">lag</span>(Unfiltered) <span class="sc">~</span> <span class="fu">lag</span>(Unfiltered), <span class="at">data =</span> data_practice11<span class="fl">.9</span>)</span>
<span id="cb205-3"><a href="ch11.html#cb205-3" tabindex="-1"></a>practice11<span class="fl">.9</span>_lm_trend <span class="ot">&lt;-</span> <span class="fu">lm</span>(Unfiltered <span class="sc">-</span> <span class="fu">lag</span>(Unfiltered) <span class="sc">~</span> trend <span class="sc">+</span> <span class="fu">lag</span>(Unfiltered), <span class="at">data =</span> data_practice11<span class="fl">.9</span>)</span>
<span id="cb205-4"><a href="ch11.html#cb205-4" tabindex="-1"></a>models <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;None&quot;</span> <span class="ot">=</span> practice11<span class="fl">.9</span>_lm_none,</span>
<span id="cb205-5"><a href="ch11.html#cb205-5" tabindex="-1"></a>              <span class="st">&quot;Drift&quot;</span> <span class="ot">=</span> practice11<span class="fl">.9</span>_lm_drift,</span>
<span id="cb205-6"><a href="ch11.html#cb205-6" tabindex="-1"></a>              <span class="st">&quot;Trend&quot;</span> <span class="ot">=</span> practice11<span class="fl">.9</span>_lm_trend)</span>
<span id="cb205-7"><a href="ch11.html#cb205-7" tabindex="-1"></a><span class="fu">modelsummary</span>(models, <span class="at">statistic =</span> <span class="st">&quot;statistic&quot;</span>, <span class="at">notes =</span> <span class="st">&quot;括弧内はt統計量&quot;</span>)</span></code></pre></div>
<!-- preamble start -->

    <script>
      function styleCell_bthojreipx6hxyeam7ro(i, j, css_id) {
        var table = document.getElementById("tinytable_bthojreipx6hxyeam7ro");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_bthojreipx6hxyeam7ro');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_bthojreipx6hxyeam7ro(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_bthojreipx6hxyeam7ro");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(0, 0, 'tinytable_css_id7ka512d5x6f03rwzvoi9') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(0, 1, 'tinytable_css_id3i6aiilraoipa9z7h1z3') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(0, 2, 'tinytable_css_id3i6aiilraoipa9z7h1z3') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(0, 3, 'tinytable_css_id3i6aiilraoipa9z7h1z3') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(1, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(1, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(1, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(1, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(2, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(2, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(2, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(2, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(3, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(3, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(3, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(3, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(4, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(4, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(4, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(4, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(5, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(5, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(5, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(5, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(6, 0, 'tinytable_css_idpcyee62w6bcg2i9jwupn') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(6, 1, 'tinytable_css_iddhn3kpneaqqa8rj1gn12') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(6, 2, 'tinytable_css_iddhn3kpneaqqa8rj1gn12') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(6, 3, 'tinytable_css_iddhn3kpneaqqa8rj1gn12') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(7, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(7, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(7, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(7, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(8, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(8, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(8, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(8, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(9, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(9, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(9, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(9, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(10, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(10, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(10, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(10, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(11, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(11, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(11, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(11, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(12, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(12, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(12, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(12, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(13, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(13, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(13, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(13, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(14, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(14, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(14, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(14, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(15, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(15, 1, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(15, 2, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(15, 3, 'tinytable_css_id0lz3tkpmqz3yo4j5imtz') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(16, 0, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(16, 1, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(16, 2, 'tinytable_css_idlosgql9buga13ua2zwzh') })
window.addEventListener('load', function () { styleCell_bthojreipx6hxyeam7ro(16, 3, 'tinytable_css_idlosgql9buga13ua2zwzh') })
    </script>

    <style>
    .table td.tinytable_css_id7ka512d5x6f03rwzvoi9, .table th.tinytable_css_id7ka512d5x6f03rwzvoi9 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id3i6aiilraoipa9z7h1z3, .table th.tinytable_css_id3i6aiilraoipa9z7h1z3 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idlosgql9buga13ua2zwzh, .table th.tinytable_css_idlosgql9buga13ua2zwzh {  text-align: left; }
    .table td.tinytable_css_id0lz3tkpmqz3yo4j5imtz, .table th.tinytable_css_id0lz3tkpmqz3yo4j5imtz {  text-align: center; }
    .table td.tinytable_css_idpcyee62w6bcg2i9jwupn, .table th.tinytable_css_idpcyee62w6bcg2i9jwupn {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_iddhn3kpneaqqa8rj1gn12, .table th.tinytable_css_iddhn3kpneaqqa8rj1gn12 {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_bthojreipx6hxyeam7ro" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing='true'>
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">None</th>
                <th scope="col">Drift</th>
                <th scope="col">Trend</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan='4'>括弧内はt統計量</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>lag(Unfiltered)</td>
                  <td>-0.069  </td>
                  <td>-0.081  </td>
                  <td>-0.240  </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(-2.380)</td>
                  <td>(-2.398)</td>
                  <td>(-4.605)</td>
                </tr>
                <tr>
                  <td>(Intercept)    </td>
                  <td>        </td>
                  <td>-0.007  </td>
                  <td>-0.124  </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>        </td>
                  <td>(-0.681)</td>
                  <td>(-3.923)</td>
                </tr>
                <tr>
                  <td>trend          </td>
                  <td>        </td>
                  <td>        </td>
                  <td>0.001   </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>        </td>
                  <td>        </td>
                  <td>(3.893) </td>
                </tr>
                <tr>
                  <td>Num.Obs.       </td>
                  <td>163     </td>
                  <td>163     </td>
                  <td>163     </td>
                </tr>
                <tr>
                  <td>R2             </td>
                  <td>0.034   </td>
                  <td>0.034   </td>
                  <td>0.118   </td>
                </tr>
                <tr>
                  <td>R2 Adj.        </td>
                  <td>0.028   </td>
                  <td>0.028   </td>
                  <td>0.107   </td>
                </tr>
                <tr>
                  <td>AIC            </td>
                  <td>-250.1  </td>
                  <td>-248.6  </td>
                  <td>-261.3  </td>
                </tr>
                <tr>
                  <td>BIC            </td>
                  <td>-243.9  </td>
                  <td>-239.3  </td>
                  <td>-249.0  </td>
                </tr>
                <tr>
                  <td>Log.Lik.       </td>
                  <td>127.065 </td>
                  <td>127.300 </td>
                  <td>134.675 </td>
                </tr>
                <tr>
                  <td>F              </td>
                  <td>        </td>
                  <td>5.749   </td>
                  <td>10.704  </td>
                </tr>
                <tr>
                  <td>RMSE           </td>
                  <td>0.11    </td>
                  <td>0.11    </td>
                  <td>0.11    </td>
                </tr>
                <tr>
                  <td>nobs_zero      </td>
                  <td>0       </td>
                  <td>0       </td>
                  <td>0       </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
<p>定数項なしのモデルでは, 5%水準では単位根仮説を棄却できるが, 1%水準では棄却できない結果となった.
定数項ありのモデルでは, 10%水準でも単位根仮説を棄却できない結果となった.
一方で定数項・トレンドありのモデルでは, 1%水準で単位根仮説を棄却できる結果となった.</p>
<p>定数項・トレンドありのモデルの推定結果をみると, 定数項・トレンドともに係数が有意であることから, 両者を含めたこのモデルが推定に適当と考えられる.
この場合, 単位根仮説は棄却され, 確率トレンドが存在しないことが結論付けられる.</p>
<p>続いて<a href="#ex11.3">実証例11.3</a>に倣って, ADF検定を行う.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="ch11.html#cb206-1" tabindex="-1"></a><span class="fu">ur.df</span>(data_practice11<span class="fl">.9</span><span class="sc">$</span>Unfiltered, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression none 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 - 1 + z.diff.lag)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.27401 -0.07124 -0.00160  0.07050  0.32442 
## 
## Coefficients:
##            Estimate Std. Error t value Pr(&gt;|t|)  
## z.lag.1    -0.05634    0.02956  -1.906   0.0585 .
## z.diff.lag -0.15751    0.07815  -2.015   0.0455 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1105 on 160 degrees of freedom
## Multiple R-squared:  0.05595,    Adjusted R-squared:  0.04415 
## F-statistic: 4.741 on 2 and 160 DF,  p-value: 0.009991
## 
## 
## Value of test-statistic is: -1.9059 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau1 -2.58 -1.95 -1.62</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="ch11.html#cb208-1" tabindex="-1"></a><span class="fu">ur.df</span>(data_practice11<span class="fl">.9</span><span class="sc">$</span>Unfiltered, <span class="at">type =</span> <span class="st">&quot;drift&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression drift 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 + 1 + z.diff.lag)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.27036 -0.06817  0.00173  0.07190  0.32611 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -0.003894   0.010168  -0.383   0.7023  
## z.lag.1     -0.063163   0.034584  -1.826   0.0697 .
## z.diff.lag  -0.152609   0.079396  -1.922   0.0564 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1108 on 159 degrees of freedom
## Multiple R-squared:  0.05515,    Adjusted R-squared:  0.04326 
## F-statistic:  4.64 on 2 and 159 DF,  p-value: 0.011
## 
## 
## Value of test-statistic is: -1.8264 1.8798 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau2 -3.46 -2.88 -2.57
## phi1  6.52  4.63  3.81</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="ch11.html#cb210-1" tabindex="-1"></a><span class="fu">ur.df</span>(data_practice11<span class="fl">.9</span><span class="sc">$</span>Unfiltered, <span class="at">type =</span> <span class="st">&quot;trend&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression trend 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.28648 -0.07399  0.01117  0.07480  0.35812 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.1172257  0.0330531  -3.547 0.000514 ***
## z.lag.1     -0.2238721  0.0558234  -4.010 9.33e-05 ***
## tt           0.0010794  0.0003006   3.590 0.000440 ***
## z.diff.lag  -0.0756382  0.0795274  -0.951 0.343008    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1069 on 158 degrees of freedom
## Multiple R-squared:  0.1264, Adjusted R-squared:  0.1098 
## F-statistic: 7.622 on 3 and 158 DF,  p-value: 8.601e-05
## 
## 
## Value of test-statistic is: -4.0104 5.6442 8.2384 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau3 -3.99 -3.43 -3.13
## phi2  6.22  4.75  4.07
## phi3  8.43  6.49  5.47</code></pre>
<p>こちらも最後の線形トレンドモデルを除いて, 5%水準で単位根仮説を棄却できない結果となった.</p>
<p>構造変化の検定は, ここでは定数項・トレンドともに変化があったと想定して行う.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="ch11.html#cb212-1" tabindex="-1"></a><span class="co"># それぞれのT^*についてRSS(T^*)とF(T^*)の値を保存するための列を作っておく.</span></span>
<span id="cb212-2"><a href="ch11.html#cb212-2" tabindex="-1"></a>data_practice11<span class="fl">.9</span> <span class="ot">&lt;-</span> data_practice11<span class="fl">.9</span> <span class="sc">%&gt;%</span></span>
<span id="cb212-3"><a href="ch11.html#cb212-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data_practice11<span class="fl">.9</span>)[<span class="dv">1</span>], <span class="co"># 行番号</span></span>
<span id="cb212-4"><a href="ch11.html#cb212-4" tabindex="-1"></a>           <span class="at">RSS_T_star =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">dim</span>(data_practice11<span class="fl">.9</span>)[<span class="dv">1</span>]),</span>
<span id="cb212-5"><a href="ch11.html#cb212-5" tabindex="-1"></a>           <span class="at">FT_star =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">dim</span>(data_practice11<span class="fl">.9</span>)[<span class="dv">1</span>]),</span>
<span id="cb212-6"><a href="ch11.html#cb212-6" tabindex="-1"></a>           <span class="at">WT_star =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">dim</span>(data_practice11<span class="fl">.9</span>)[<span class="dv">1</span>]))</span>
<span id="cb212-7"><a href="ch11.html#cb212-7" tabindex="-1"></a></span>
<span id="cb212-8"><a href="ch11.html#cb212-8" tabindex="-1"></a><span class="co"># パラメータ</span></span>
<span id="cb212-9"><a href="ch11.html#cb212-9" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">dim</span>(data_practice11<span class="fl">.9</span>)[<span class="dv">1</span>]</span>
<span id="cb212-10"><a href="ch11.html#cb212-10" tabindex="-1"></a>pi_0 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb212-11"><a href="ch11.html#cb212-11" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb212-12"><a href="ch11.html#cb212-12" tabindex="-1"></a></span>
<span id="cb212-13"><a href="ch11.html#cb212-13" tabindex="-1"></a>RSS_R <span class="ot">&lt;-</span> <span class="fu">lm</span>(Unfiltered <span class="sc">~</span> trend, <span class="at">data =</span> data_practice11<span class="fl">.9</span>)<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span> <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb212-14"><a href="ch11.html#cb212-14" tabindex="-1"></a><span class="cf">for</span> (T_star <span class="cf">in</span> <span class="fu">floor</span>(pi_0 <span class="sc">*</span> T)<span class="sc">:</span><span class="fu">floor</span>((<span class="dv">1</span> <span class="sc">-</span> pi_0) <span class="sc">*</span> T)) {</span>
<span id="cb212-15"><a href="ch11.html#cb212-15" tabindex="-1"></a>    <span class="co"># 構造変化前後を示すダミー変数を作成</span></span>
<span id="cb212-16"><a href="ch11.html#cb212-16" tabindex="-1"></a>    data_practice11<span class="fl">.9</span>_temp <span class="ot">&lt;-</span> data_practice11<span class="fl">.9</span> <span class="sc">%&gt;%</span></span>
<span id="cb212-17"><a href="ch11.html#cb212-17" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">dummy =</span> t <span class="sc">&lt;</span> T_star)</span>
<span id="cb212-18"><a href="ch11.html#cb212-18" tabindex="-1"></a>    data_practice11<span class="fl">.9</span><span class="sc">$</span>RSS_T_star[T_star] <span class="ot">&lt;-</span> <span class="fu">lm</span>(Unfiltered <span class="sc">~</span> trend <span class="sc">*</span> dummy, <span class="at">data =</span> data_practice11<span class="fl">.9</span>_temp)<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span> <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb212-19"><a href="ch11.html#cb212-19" tabindex="-1"></a>    data_practice11<span class="fl">.9</span><span class="sc">$</span>FT_star[T_star] <span class="ot">&lt;-</span> ((RSS_R <span class="sc">-</span> data_practice11<span class="fl">.9</span><span class="sc">$</span>RSS_T_star[T_star]) <span class="sc">/</span> q) <span class="sc">/</span> (data_practice11<span class="fl">.9</span><span class="sc">$</span>RSS_T_star[T_star] <span class="sc">/</span> (T <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> q))</span>
<span id="cb212-20"><a href="ch11.html#cb212-20" tabindex="-1"></a>    data_practice11<span class="fl">.9</span><span class="sc">$</span>FT_star[T_star] <span class="ot">&lt;-</span> q <span class="sc">*</span> data_practice11<span class="fl">.9</span><span class="sc">$</span>FT_star[T_star]</span>
<span id="cb212-21"><a href="ch11.html#cb212-21" tabindex="-1"></a>}</span>
<span id="cb212-22"><a href="ch11.html#cb212-22" tabindex="-1"></a></span>
<span id="cb212-23"><a href="ch11.html#cb212-23" tabindex="-1"></a><span class="co"># 構造変化点を表示</span></span>
<span id="cb212-24"><a href="ch11.html#cb212-24" tabindex="-1"></a>data_practice11<span class="fl">.9</span> <span class="sc">%&gt;%</span></span>
<span id="cb212-25"><a href="ch11.html#cb212-25" tabindex="-1"></a>    <span class="fu">filter</span>(FT_star <span class="sc">==</span> <span class="fu">max</span>(FT_star, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>##   year Unfiltered trend  t RSS_T_star  FT_star WT_star
## 1 1902     -0.386    53 53   2.474737 113.1647      NA</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="ch11.html#cb214-1" tabindex="-1"></a><span class="co"># 構造変化前後のトレンド・インフレ率の推定値を表示</span></span>
<span id="cb214-2"><a href="ch11.html#cb214-2" tabindex="-1"></a>data_practice11<span class="fl">.9</span> <span class="ot">&lt;-</span> data_practice11<span class="fl">.9</span> <span class="sc">%&gt;%</span></span>
<span id="cb214-3"><a href="ch11.html#cb214-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">after_structural_break =</span> t <span class="sc">&gt;=</span> <span class="dv">53</span>)</span>
<span id="cb214-4"><a href="ch11.html#cb214-4" tabindex="-1"></a>data_practice11<span class="fl">.9</span> <span class="sc">%&gt;%</span></span>
<span id="cb214-5"><a href="ch11.html#cb214-5" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> Unfiltered, <span class="at">group =</span> after_structural_break)) <span class="sc">+</span></span>
<span id="cb214-6"><a href="ch11.html#cb214-6" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb214-7"><a href="ch11.html#cb214-7" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<p>構造変化点は1902年となった.
この結果は産業革命が平均的に世界に波及した時期を示唆しているのかもしれない.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch10.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch12.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/11.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
